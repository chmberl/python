<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>测试工具 — Django 1.8.2 中文文档</title>
<link href="../../_static/default.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.8.2.dev20150513143415',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
<script src="../../_static/jquery.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<link href="../../index.html" rel="top" title="Django 1.8.2.dev20150513143415 documentation"/>
<link href="index.html" rel="up" title="Testing in Django"/>
<link href="advanced.html" rel="next" title="Advanced testing topics"/>
<link href="overview.html" rel="prev" title="Writing and running tests"/>
<script src="http://python.usyiyi.cn/django/templatebuiltins.js" type="text/javascript"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='http://python.usyiyi.cn/django/topics/testing/&quot;&#32;+&#32;base&#32;+&#32;&quot;#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='http://python.usyiyi.cn/django/topics/testing/&quot;&#32;+&#32;base&#32;+&#32;&quot;#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);
</script>
</head>
<body>
<div class="document">
<div class="yui-t6" id="custom-doc">
<div id="hd">
<h1><font id="439">Django 1.8.2.dev20150513143415 documentation</font></h1>
<div id="global-nav">
<a href="../../index.html" title="Home page">Home</a>  |
        <a href="../../contents.html" title="Table of contents">Table of contents</a>  |
        <a href="../../genindex.html" title="Global index">Index</a>  |
        <a href="../../py-modindex.html" title="Module index">Modules</a>
</div>
<div class="nav">
    « <a href="overview.html" title="Writing and running tests">previous</a>
     |
    <a accesskey="U" href="../index.html" title="Using Django">up</a>
   |
    <a href="advanced.html" title="Advanced testing topics">next</a> »</div>
</div>
<div id="bd">
<div id="yui-main">
<div class="yui-b">
<div class="yui-g" id="topics-testing-tools">
<div class="section" id="s-testing-tools">
<span id="testing-tools"></span><h1><font id="440">Testing tools</font><a class="headerlink" href="tools.html#testing-tools" title="Permalink to this headline">¶</a></h1>
<p><font id="1">Django provides a small set of tools that come in handy when writing tests.</font></p>
<div class="section" id="s-the-test-client">
<span id="s-test-client"></span><span id="the-test-client"></span><span id="test-client"></span><h2><font id="441">The test client</font><a class="headerlink" href="tools.html#the-test-client" title="Permalink to this headline">¶</a></h2>
<p><font id="2">The test client is a Python class that acts as a dummy Web browser, allowing you to test your views and interact with your Django-powered application programmatically.</font></p>
<p><font id="3">Some of the things you can do with the test client are:</font></p>
<ul class="simple">
<li><font id="471">Simulate GET and POST requests on a URL and observe the response – everything from low-level HTTP (result headers and status codes) to page content.</font></li>
<li><font id="472">See the chain of redirects (if any) and check the URL and status code at each step.</font></li>
<li><font id="473">Test that a given request is rendered by a given Django template, with a template context that contains certain values.</font></li>
</ul>
<p><font id="4">Note that the test client is not intended to be a replacement for <a class="reference external" href="http://seleniumhq.org/">Selenium</a> or other “in-browser” frameworks. </font><font id="5">Django’s test client has a different focus. </font><font id="6">In short:</font></p>
<ul class="simple">
<li><font id="474">Use Django’s test client to establish that the correct template is being rendered and that the template is passed the correct context data.</font></li>
<li><font id="475">Use in-browser frameworks like <a class="reference external" href="http://seleniumhq.org/">Selenium</a> to test <em>rendered</em> HTML and the <em>behavior</em> of Web pages, namely JavaScript functionality. </font><font id="476">Django also provides special support for those frameworks; </font><font id="477">see the section on <a class="reference internal" href="tools.html#django.test.LiveServerTestCase" title="django.test.LiveServerTestCase"><tt class="xref py py-class docutils literal"><span class="pre">LiveServerTestCase</span></tt></a> for more details.</font></li>
</ul>
<p><font id="7">A comprehensive test suite should use a combination of both test types.</font></p>
<div class="section" id="s-overview-and-a-quick-example">
<span id="overview-and-a-quick-example"></span><h3><font id="447">Overview and a quick example</font><a class="headerlink" href="tools.html#overview-and-a-quick-example" title="Permalink to this headline">¶</a></h3>
<p><font id="8">To use the test client, instantiate <tt class="docutils literal"><span class="pre">django.test.Client</span></tt> and retrieve Web pages:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/login/'</span><span class="p">,</span> <span class="p">{</span><span class="s">'username'</span><span class="p">:</span> <span class="s">'john'</span><span class="p">,</span> <span class="s">'password'</span><span class="p">:</span> <span class="s">'smith'</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
<span class="go">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customer/details/'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">content</span>
<span class="go">'&lt;!DOCTYPE html...'</span>
</pre></div>
</div>
<p><font id="9">As this example suggests, you can instantiate <tt class="docutils literal"><span class="pre">Client</span></tt> from within a session of the Python interactive interpreter.</font></p>
<p><font id="10">Note a few important things about how the test client works:</font></p>
<ul>
<li><p class="first"><font id="11">The test client does <em>not</em> require the Web server to be running. </font><font id="12">In fact, it will run just fine with no Web server running at all! </font><font id="13">That’s because it avoids the overhead of HTTP and deals directly with the Django framework. </font><font id="14">This helps make the unit tests run quickly.</font></p>
</li>
<li><p class="first"><font id="15">When retrieving pages, remember to specify the <em>path</em> of the URL, not the whole domain. </font><font id="16">For example, this is correct:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/login/'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="17">This is incorrect:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'http://www.example.com/login/'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="18">The test client is not capable of retrieving Web pages that are not powered by your Django project. </font><font id="19">If you need to retrieve other Web pages, use a Python standard library module such as <a class="reference external" href="https://docs.python.org/3/library/urllib.html#module-urllib" title="(in Python v3.4)"><tt class="xref py py-mod docutils literal"><span class="pre">urllib</span></tt></a>.</font></p>
</li>
<li><p class="first"><font id="20">To resolve URLs, the test client uses whatever URLconf is pointed-to by your <a class="reference internal" href="../../ref/settings.html#std:setting-ROOT_URLCONF"><tt class="xref std std-setting docutils literal"><span class="pre">ROOT_URLCONF</span></tt></a> setting.</font></p>
</li>
<li><p class="first"><font id="21">Although the above example would work in the Python interactive interpreter, some of the test client’s functionality, notably the template-related functionality, is only available <em>while tests are running</em>.</font></p>
<p><font id="22">The reason for this is that Django’s test runner performs a bit of black magic in order to determine which template was loaded by a given view. </font><font id="23">This black magic (essentially a patching of Django’s template system in memory) only happens during test running.</font></p>
</li>
<li><p class="first"><font id="24">By default, the test client will disable any CSRF checks performed by your site.</font></p>
<p><font id="25">If, for some reason, you <em>want</em> the test client to perform CSRF checks, you can create an instance of the test client that enforces CSRF checks. </font><font id="26">To do this, pass in the <tt class="docutils literal"><span class="pre">enforce_csrf_checks</span></tt> argument when you construct your client:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">Client</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">csrf_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">enforce_csrf_checks</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="s-making-requests">
<span id="making-requests"></span><h3><font id="448">Making requests</font><a class="headerlink" href="tools.html#making-requests" title="Permalink to this headline">¶</a></h3>
<p><font id="27">Use the <tt class="docutils literal"><span class="pre">django.test.Client</span></tt> class to make requests.</font></p>
<dl class="class">
<dt id="django.test.Client">
<em class="property">class </em><tt class="descname">Client</tt>(<em>enforce_csrf_checks=False</em>, <em>**defaults</em>)<a class="headerlink" href="tools.html#django.test.Client" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="28">It requires no arguments at time of construction. </font><font id="29">However, you can use keywords arguments to specify some default headers. </font><font id="30">For example, this will send a <tt class="docutils literal"><span class="pre">User-Agent</span></tt> HTTP header in each request:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">HTTP_USER_AGENT</span><span class="o">=</span><span class="s">'Mozilla/5.0'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="31">The values from the <tt class="docutils literal"><span class="pre">extra</span></tt> keywords arguments passed to <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">get()</span></tt></a>, <a class="reference internal" href="tools.html#django.test.Client.post" title="django.test.Client.post"><tt class="xref py py-meth docutils literal"><span class="pre">post()</span></tt></a>, etc. have precedence over the defaults passed to the class constructor.</font></p>
<p><font id="32">The <tt class="docutils literal"><span class="pre">enforce_csrf_checks</span></tt> argument can be used to test CSRF protection (see above).</font></p>
<p><font id="33">Once you have a <tt class="docutils literal"><span class="pre">Client</span></tt> instance, you can call any of the following methods:</font></p>
<dl class="method">
<dt id="django.test.Client.get">
<tt class="descname">get</tt>(<em>path</em>, <em>data=None</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.get" title="Permalink to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 1.7:</span> <p><font id="34">The <tt class="docutils literal"><span class="pre">secure</span></tt> argument was added.</font></p>
</div>
<p><font id="35">Makes a GET request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object, which is documented below.</font></p>
<p><font id="36">The key-value pairs in the <tt class="docutils literal"><span class="pre">data</span></tt> dictionary are used to create a GET data payload. </font><font id="37">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customers/details/'</span><span class="p">,</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'fred'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
</pre></div>
</div>
<p><font id="38">...will result in the evaluation of a GET request equivalent to:</font></p>
<div class="highlight-python"><div class="highlight"><pre>/customers/details/?name=fred&amp;age=7
</pre></div>
</div>
<p><font id="39">The <tt class="docutils literal"><span class="pre">extra</span></tt> keyword arguments parameter can be used to specify headers to be sent in the request. </font><font id="40">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customers/details/'</span><span class="p">,</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'fred'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
<span class="gp">... </span>      <span class="n">HTTP_X_REQUESTED_WITH</span><span class="o">=</span><span class="s">'XMLHttpRequest'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="41">...will send the HTTP header <tt class="docutils literal"><span class="pre">HTTP_X_REQUESTED_WITH</span></tt> to the details view, which is a good way to test code paths that use the <a class="reference internal" href="../../ref/request-response.html#django.http.HttpRequest.is_ajax" title="django.http.HttpRequest.is_ajax"><tt class="xref py py-meth docutils literal"><span class="pre">django.http.HttpRequest.is_ajax()</span></tt></a> method.</font></p>
<div class="admonition-cgi-specification admonition">
<p class="first admonition-title"><font id="42">CGI specification</font></p>
<p class="last"><font id="43">The headers sent via <tt class="docutils literal"><span class="pre">**extra</span></tt> should follow <a class="reference external" href="http://www.w3.org/CGI/">CGI</a> specification. </font><font id="44">For example, emulating a different “Host” header as sent in the HTTP request from the browser to the server should be passed as <tt class="docutils literal"><span class="pre">HTTP_HOST</span></tt>.</font></p>
</div>
<p><font id="45">If you already have the GET arguments in URL-encoded form, you can use that encoding instead of using the data argument. </font><font id="46">For example, the previous GET request could also be posed as:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customers/details/?name=fred&amp;age=7'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="47">If you provide a URL with both an encoded GET data and a data argument, the data argument will take precedence.</font></p>
<p><font id="48">If you set <tt class="docutils literal"><span class="pre">follow</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> the client will follow any redirects and a <tt class="docutils literal"><span class="pre">redirect_chain</span></tt> attribute will be set in the response object containing tuples of the intermediate urls and status codes.</font></p>
<p><font id="49">If you had a URL <tt class="docutils literal"><span class="pre">/redirect_me/</span></tt> that redirected to <tt class="docutils literal"><span class="pre">/next/</span></tt>, that redirected to <tt class="docutils literal"><span class="pre">/final/</span></tt>, this is what you’d see:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/redirect_me/'</span><span class="p">,</span> <span class="n">follow</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">redirect_chain</span>
<span class="go">[('http://testserver/next/', 302), ('http://testserver/final/', 302)]</span>
</pre></div>
</div>
<p><font id="50">If you set <tt class="docutils literal"><span class="pre">secure</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> the client will emulate an HTTPS request.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.post">
<tt class="descname">post</tt>(<em>path</em>, <em>data=None</em>, <em>content_type=MULTIPART_CONTENT</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.post" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="51">Makes a POST request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object, which is documented below.</font></p>
<p><font id="52">The key-value pairs in the <tt class="docutils literal"><span class="pre">data</span></tt> dictionary are used to submit POST data. </font><font id="53">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/login/'</span><span class="p">,</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'fred'</span><span class="p">,</span> <span class="s">'passwd'</span><span class="p">:</span> <span class="s">'secret'</span><span class="p">})</span>
</pre></div>
</div>
<p><font id="54">...will result in the evaluation of a POST request to this URL:</font></p>
<div class="highlight-python"><div class="highlight"><pre>/login/
</pre></div>
</div>
<p><font id="55">...with this POST data:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">name</span><span class="o">=</span><span class="n">fred</span><span class="o">&amp;</span><span class="n">passwd</span><span class="o">=</span><span class="n">secret</span>
</pre></div>
</div>
<p><font id="56">If you provide <tt class="docutils literal"><span class="pre">content_type</span></tt> (e.g. <em class="mimetype">text/xml</em> for an XML payload), the contents of <tt class="docutils literal"><span class="pre">data</span></tt> will be sent as-is in the POST request, using <tt class="docutils literal"><span class="pre">content_type</span></tt> in the HTTP <tt class="docutils literal"><span class="pre">Content-Type</span></tt> header.</font></p>
<p><font id="57">If you don’t provide a value for <tt class="docutils literal"><span class="pre">content_type</span></tt>, the values in <tt class="docutils literal"><span class="pre">data</span></tt> will be transmitted with a content type of <em class="mimetype">multipart/form-data</em>. </font><font id="58">In this case, the key-value pairs in <tt class="docutils literal"><span class="pre">data</span></tt> will be encoded as a multipart message and used to create the POST data payload.</font></p>
<p><font id="59">To submit multiple values for a given key – for example, to specify the selections for a <tt class="docutils literal"><span class="pre">&lt;select</span> <span class="pre">multiple&gt;</span></tt> – provide the values as a list or tuple for the required key. </font><font id="60">For example, this value of <tt class="docutils literal"><span class="pre">data</span></tt> would submit three selected values for the field named <tt class="docutils literal"><span class="pre">choices</span></tt>:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">'choices'</span><span class="p">:</span> <span class="p">(</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">)}</span>
</pre></div>
</div>
<p><font id="61">Submitting files is a special case. </font><font id="62">To POST a file, you need only provide the file field name as a key, and a file handle to the file you wish to upload as a value. </font><font id="63">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'wishlist.doc'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">c</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/customers/wishes/'</span><span class="p">,</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'fred'</span><span class="p">,</span> <span class="s">'attachment'</span><span class="p">:</span> <span class="n">fp</span><span class="p">})</span>
</pre></div>
</div>
<p><font id="64">(The name <tt class="docutils literal"><span class="pre">attachment</span></tt> here is not relevant; use whatever name your file-processing code expects.)</font></p>
<p><font id="65">You may also provide any file-like object (e.g., <a class="reference external" href="https://docs.python.org/3/library/io.html#io.StringIO" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">StringIO</span></tt></a> or <a class="reference external" href="https://docs.python.org/3/library/io.html#io.BytesIO" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">BytesIO</span></tt></a>) as a file handle.</font></p>
<div class="versionadded">
<span class="title">New in Django 1.8:</span> <p><font id="66">The ability to use a file-like object was added.</font></p>
</div>
<p><font id="67">Note that if you wish to use the same file handle for multiple <tt class="docutils literal"><span class="pre">post()</span></tt> calls then you will need to manually reset the file pointer between posts. </font><font id="68">The easiest way to do this is to manually close the file after it has been provided to <tt class="docutils literal"><span class="pre">post()</span></tt>, as demonstrated above.</font></p>
<p><font id="69">You should also ensure that the file is opened in a way that allows the data to be read. </font><font id="70">If your file contains binary data such as an image, this means you will need to open the file in <tt class="docutils literal"><span class="pre">rb</span></tt> (read binary) mode.</font></p>
<p><font id="71">The <tt class="docutils literal"><span class="pre">extra</span></tt> argument acts the same as for <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>.</font></p>
<p><font id="72">If the URL you request with a POST contains encoded parameters, these parameters will be made available in the request.</font><font id="73">GET data. </font><font id="74">For example, if you were to make the request:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s">'/login/?visitor=true'</span><span class="p">,</span> <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'fred'</span><span class="p">,</span> <span class="s">'passwd'</span><span class="p">:</span> <span class="s">'secret'</span><span class="p">})</span>
</pre></div>
</div>
<p><font id="75">... the view handling this request could interrogate request.</font><font id="76">POST to retrieve the username and password, and could interrogate request.</font><font id="77">GET to determine if the user was a visitor.</font></p>
<p><font id="78">If you set <tt class="docutils literal"><span class="pre">follow</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> the client will follow any redirects and a <tt class="docutils literal"><span class="pre">redirect_chain</span></tt> attribute will be set in the response object containing tuples of the intermediate urls and status codes.</font></p>
<p><font id="79">If you set <tt class="docutils literal"><span class="pre">secure</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> the client will emulate an HTTPS request.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.head">
<tt class="descname">head</tt>(<em>path</em>, <em>data=None</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.head" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="80">Makes a HEAD request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="81">This method works just like <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>, including the <tt class="docutils literal"><span class="pre">follow</span></tt>, <tt class="docutils literal"><span class="pre">secure</span></tt> and <tt class="docutils literal"><span class="pre">extra</span></tt> arguments, except it does not return a message body.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.options">
<tt class="descname">options</tt>(<em>path</em>, <em>data=''</em>, <em>content_type='application/octet-stream'</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.options" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="82">Makes an OPTIONS request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="83">Useful for testing RESTful interfaces.</font></p>
<p><font id="84">When <tt class="docutils literal"><span class="pre">data</span></tt> is provided, it is used as the request body, and a <tt class="docutils literal"><span class="pre">Content-Type</span></tt> header is set to <tt class="docutils literal"><span class="pre">content_type</span></tt>.</font></p>
<p><font id="85">The <tt class="docutils literal"><span class="pre">follow</span></tt>, <tt class="docutils literal"><span class="pre">secure</span></tt> and <tt class="docutils literal"><span class="pre">extra</span></tt> arguments act the same as for <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.put">
<tt class="descname">put</tt>(<em>path</em>, <em>data=''</em>, <em>content_type='application/octet-stream'</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.put" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="86">Makes a PUT request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="87">Useful for testing RESTful interfaces.</font></p>
<p><font id="88">When <tt class="docutils literal"><span class="pre">data</span></tt> is provided, it is used as the request body, and a <tt class="docutils literal"><span class="pre">Content-Type</span></tt> header is set to <tt class="docutils literal"><span class="pre">content_type</span></tt>.</font></p>
<p><font id="89">The <tt class="docutils literal"><span class="pre">follow</span></tt>, <tt class="docutils literal"><span class="pre">secure</span></tt> and <tt class="docutils literal"><span class="pre">extra</span></tt> arguments act the same as for <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.patch">
<tt class="descname">patch</tt>(<em>path</em>, <em>data=''</em>, <em>content_type='application/octet-stream'</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.patch" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="90">Makes a PATCH request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="91">Useful for testing RESTful interfaces.</font></p>
<p><font id="92">The <tt class="docutils literal"><span class="pre">follow</span></tt>, <tt class="docutils literal"><span class="pre">secure</span></tt> and <tt class="docutils literal"><span class="pre">extra</span></tt> arguments act the same as for <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.delete">
<tt class="descname">delete</tt>(<em>path</em>, <em>data=''</em>, <em>content_type='application/octet-stream'</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.delete" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="93">Makes an DELETE request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="94">Useful for testing RESTful interfaces.</font></p>
<p><font id="95">When <tt class="docutils literal"><span class="pre">data</span></tt> is provided, it is used as the request body, and a <tt class="docutils literal"><span class="pre">Content-Type</span></tt> header is set to <tt class="docutils literal"><span class="pre">content_type</span></tt>.</font></p>
<p><font id="96">The <tt class="docutils literal"><span class="pre">follow</span></tt>, <tt class="docutils literal"><span class="pre">secure</span></tt> and <tt class="docutils literal"><span class="pre">extra</span></tt> arguments act the same as for <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.trace">
<tt class="descname">trace</tt>(<em>path</em>, <em>follow=False</em>, <em>secure=False</em>, <em>**extra</em>)<a class="headerlink" href="tools.html#django.test.Client.trace" title="Permalink to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 1.8.</span> </div>
<p><font id="97">Makes a TRACE request on the provided <tt class="docutils literal"><span class="pre">path</span></tt> and returns a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="98">Useful for simulating diagnostic probes.</font></p>
<p><font id="99">Unlike the other request methods, <tt class="docutils literal"><span class="pre">data</span></tt> is not provided as a keyword parameter in order to comply with <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2616.html"><strong>RFC 2616</strong></a>, which mandates that TRACE requests should not have an entity-body.</font></p>
<p><font id="100">The <tt class="docutils literal"><span class="pre">follow</span></tt>, <tt class="docutils literal"><span class="pre">secure</span></tt>, and <tt class="docutils literal"><span class="pre">extra</span></tt> arguments act the same as for <a class="reference internal" href="tools.html#django.test.Client.get" title="django.test.Client.get"><tt class="xref py py-meth docutils literal"><span class="pre">Client.get()</span></tt></a>.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.login">
<tt class="descname">login</tt>(<em>**credentials</em>)<a class="headerlink" href="tools.html#django.test.Client.login" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="101">If your site uses Django’s <a class="reference internal" href="../auth/index.html"><em>authentication system</em></a> and you deal with logging in users, you can use the test client’s <tt class="docutils literal"><span class="pre">login()</span></tt> method to simulate the effect of a user logging into the site.</font></p>
<p><font id="102">After you call this method, the test client will have all the cookies and session data required to pass any login-based tests that may form part of a view.</font></p>
<p><font id="103">The format of the <tt class="docutils literal"><span class="pre">credentials</span></tt> argument depends on which <a class="reference internal" href="../auth/customizing.html#authentication-backends"><em>authentication backend</em></a> you’re using (which is configured by your <a class="reference internal" href="../../ref/settings.html#std:setting-AUTHENTICATION_BACKENDS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTHENTICATION_BACKENDS</span></tt></a> setting). </font><font id="104">If you’re using the standard authentication backend provided by Django (<tt class="docutils literal"><span class="pre">ModelBackend</span></tt>), <tt class="docutils literal"><span class="pre">credentials</span></tt> should be the user’s username and password, provided as keyword arguments:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">'fred'</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s">'secret'</span><span class="p">)</span>

<span class="go"># Now you can access a view that's only available to logged-in users.</span>
</pre></div>
</div>
<p><font id="105">If you’re using a different authentication backend, this method may require different credentials. </font><font id="106">It requires whichever credentials are required by your backend’s <tt class="docutils literal"><span class="pre">authenticate()</span></tt> method.</font></p>
<p><font id="107"><tt class="docutils literal"><span class="pre">login()</span></tt> returns <tt class="docutils literal"><span class="pre">True</span></tt> if it the credentials were accepted and login was successful.</font></p>
<p><font id="108">Finally, you’ll need to remember to create user accounts before you can use this method. </font><font id="109">As we explained above, the test runner is executed using a test database, which contains no users by default. </font><font id="110">As a result, user accounts that are valid on your production site will not work under test conditions. </font><font id="111">You’ll need to create users as part of the test suite – either manually (using the Django model API) or with a test fixture. </font><font id="112">Remember that if you want your test user to have a password, you can’t set the user’s password by setting the password attribute directly – you must use the <a class="reference internal" href="../../ref/contrib/auth.html#django.contrib.auth.models.User.set_password" title="django.contrib.auth.models.User.set_password"><tt class="xref py py-meth docutils literal"><span class="pre">set_password()</span></tt></a> function to store a correctly hashed password. </font><font id="113">Alternatively, you can use the <a class="reference internal" href="../../ref/contrib/auth.html#django.contrib.auth.models.UserManager.create_user" title="django.contrib.auth.models.UserManager.create_user"><tt class="xref py py-meth docutils literal"><span class="pre">create_user()</span></tt></a> helper method to create a new user with a correctly hashed password.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.Client.logout">
<tt class="descname">logout</tt>()<a class="headerlink" href="tools.html#django.test.Client.logout" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="114">If your site uses Django’s <a class="reference internal" href="../auth/index.html"><em>authentication system</em></a>, the <tt class="docutils literal"><span class="pre">logout()</span></tt> method can be used to simulate the effect of a user logging out of your site.</font></p>
<p><font id="115">After you call this method, the test client will have all the cookies and session data cleared to defaults. </font><font id="116">Subsequent requests will appear to come from an <a class="reference internal" href="../../ref/contrib/auth.html#django.contrib.auth.models.AnonymousUser" title="django.contrib.auth.models.AnonymousUser"><tt class="xref py py-class docutils literal"><span class="pre">AnonymousUser</span></tt></a>.</font></p>
</dd></dl>
</dd></dl>
</div>
<div class="section" id="s-testing-responses">
<span id="testing-responses"></span><h3><font id="449">Testing responses</font><a class="headerlink" href="tools.html#testing-responses" title="Permalink to this headline">¶</a></h3>
<p><font id="117">The <tt class="docutils literal"><span class="pre">get()</span></tt> and <tt class="docutils literal"><span class="pre">post()</span></tt> methods both return a <tt class="docutils literal"><span class="pre">Response</span></tt> object. </font><font id="118">This <tt class="docutils literal"><span class="pre">Response</span></tt> object is <em>not</em> the same as the <tt class="docutils literal"><span class="pre">HttpResponse</span></tt> object returned by Django views; </font><font id="119">the test response object has some additional data useful for test code to verify.</font></p>
<p><font id="120">Specifically, a <tt class="docutils literal"><span class="pre">Response</span></tt> object has the following attributes:</font></p>
<dl class="class">
<dt id="django.test.Response">
<em class="property">class </em><tt class="descname">Response</tt><a class="headerlink" href="tools.html#django.test.Response" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="django.test.Response.client">
<tt class="descname">client</tt><a class="headerlink" href="tools.html#django.test.Response.client" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="121">The test client that was used to make the request that resulted in the response.</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.content">
<tt class="descname">content</tt><a class="headerlink" href="tools.html#django.test.Response.content" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="122">The body of the response, as a string. </font><font id="123">This is the final page content as rendered by the view, or any error message.</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.context">
<tt class="descname">context</tt><a class="headerlink" href="tools.html#django.test.Response.context" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="124">The template <tt class="docutils literal"><span class="pre">Context</span></tt> instance that was used to render the template that produced the response content.</font></p>
<p><font id="125">If the rendered page used multiple templates, then <tt class="docutils literal"><span class="pre">context</span></tt> will be a list of <tt class="docutils literal"><span class="pre">Context</span></tt> objects, in the order in which they were rendered.</font></p>
<p><font id="126">Regardless of the number of templates used during rendering, you can retrieve context values using the <tt class="docutils literal"><span class="pre">[]</span></tt> operator. </font><font id="127">For example, the context variable <tt class="docutils literal"><span class="pre">name</span></tt> could be retrieved using:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/foo/'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span>
<span class="go">'Arthur'</span>
</pre></div>
</div>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.request">
<tt class="descname">request</tt><a class="headerlink" href="tools.html#django.test.Response.request" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="128">The request data that stimulated the response.</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.wsgi_request">
<tt class="descname">wsgi_request</tt><a class="headerlink" href="tools.html#django.test.Response.wsgi_request" title="Permalink to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 1.7.</span> </div>
<p><font id="129">The <tt class="docutils literal"><span class="pre">WSGIRequest</span></tt> instance generated by the test handler that generated the response.</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.status_code">
<tt class="descname">status_code</tt><a class="headerlink" href="tools.html#django.test.Response.status_code" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="130">The HTTP status of the response, as an integer. </font><font id="131">See <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2616.html#section-10"><strong>RFC 2616</strong></a> for a full list of HTTP status codes.</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.templates">
<tt class="descname">templates</tt><a class="headerlink" href="tools.html#django.test.Response.templates" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="132">A list of <tt class="docutils literal"><span class="pre">Template</span></tt> instances used to render the final content, in the order they were rendered. </font><font id="133">For each template in the list, use <tt class="docutils literal"><span class="pre">template.name</span></tt> to get the template’s file name, if the template was loaded from a file. </font><font id="134">(The name is a string such as <tt class="docutils literal"><span class="pre">'admin/index.html'</span></tt>.)</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Response.resolver_match">
<tt class="descname">resolver_match</tt><a class="headerlink" href="tools.html#django.test.Response.resolver_match" title="Permalink to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 1.8:</span> <p><font id="135">An instance of <a class="reference internal" href="../../ref/urlresolvers.html#django.core.urlresolvers.ResolverMatch" title="django.core.urlresolvers.ResolverMatch"><tt class="xref py py-class docutils literal"><span class="pre">ResolverMatch</span></tt></a> for the response. </font><font id="136">You can use the <a class="reference internal" href="../../ref/urlresolvers.html#django.core.urlresolvers.ResolverMatch.func" title="django.core.urlresolvers.ResolverMatch.func"><tt class="xref py py-attr docutils literal"><span class="pre">func</span></tt></a> attribute, for example, to verify the view that served the response:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># my_view here is a function based view</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">resolver_match</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">my_view</span><span class="p">)</span>

<span class="c"># class based views need to be compared by name, as the functions</span>
<span class="c"># generated by as_view() won't be equal</span>
<span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">resolver_match</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">MyView</span><span class="o">.</span><span class="n">as_view</span><span class="p">()</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="137">If the given URL is not found, accessing this attribute will raise a <a class="reference internal" href="../../ref/exceptions.html#django.core.urlresolvers.Resolver404" title="django.core.urlresolvers.Resolver404"><tt class="xref py py-exc docutils literal"><span class="pre">Resolver404</span></tt></a> exception.</font></p>
</div>
</dd></dl>
</dd></dl>
<p><font id="138">You can also use dictionary syntax on the response object to query the value of any settings in the HTTP headers. </font><font id="139">For example, you could determine the content type of a response using <tt class="docutils literal"><span class="pre">response['Content-Type']</span></tt>.</font></p>
</div>
<div class="section" id="s-exceptions">
<span id="exceptions"></span><h3><font id="450">Exceptions</font><a class="headerlink" href="tools.html#exceptions" title="Permalink to this headline">¶</a></h3>
<p><font id="140">If you point the test client at a view that raises an exception, that exception will be visible in the test case. </font><font id="141">You can then use a standard <tt class="docutils literal"><span class="pre">try</span> <span class="pre">...</span> </tt></font><font id="142"><span class="pre">except</span> </font><font id="143">block or <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertRaises" title="(in Python v3.4)"><tt class="xref py py-meth docutils literal"><span class="pre">assertRaises()</span></tt></a> to test for exceptions.</font></p>
<p><font id="144">The only exceptions that are not visible to the test client are <a class="reference internal" href="../http/views.html#django.http.Http404" title="django.http.Http404"><tt class="xref py py-class docutils literal"><span class="pre">Http404</span></tt></a>, <a class="reference internal" href="../../ref/exceptions.html#django.core.exceptions.PermissionDenied" title="django.core.exceptions.PermissionDenied"><tt class="xref py py-class docutils literal"><span class="pre">PermissionDenied</span></tt></a>, <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#SystemExit" title="(in Python v3.4)"><tt class="xref py py-exc docutils literal"><span class="pre">SystemExit</span></tt></a>, and <a class="reference internal" href="../../ref/exceptions.html#django.core.exceptions.SuspiciousOperation" title="django.core.exceptions.SuspiciousOperation"><tt class="xref py py-class docutils literal"><span class="pre">SuspiciousOperation</span></tt></a>. </font><font id="145">Django catches these exceptions internally and converts them into the appropriate HTTP response codes. </font><font id="146">In these cases, you can check <tt class="docutils literal"><span class="pre">response.status_code</span></tt> in your test.</font></p>
</div>
<div class="section" id="s-persistent-state">
<span id="persistent-state"></span><h3><font id="451">Persistent state</font><a class="headerlink" href="tools.html#persistent-state" title="Permalink to this headline">¶</a></h3>
<p><font id="147">The test client is stateful. </font><font id="148">If a response returns a cookie, then that cookie will be stored in the test client and sent with all subsequent <tt class="docutils literal"><span class="pre">get()</span></tt> and <tt class="docutils literal"><span class="pre">post()</span></tt> requests.</font></p>
<p><font id="149">Expiration policies for these cookies are not followed. </font><font id="150">If you want a cookie to expire, either delete it manually or create a new <tt class="docutils literal"><span class="pre">Client</span></tt> instance (which will effectively delete all cookies).</font></p>
<p><font id="151">A test client has two attributes that store persistent state information. </font><font id="152">You can access these properties as part of a test condition.</font></p>
<dl class="attribute">
<dt id="django.test.Client.cookies">
<tt class="descclassname">Client.</tt><tt class="descname">cookies</tt><a class="headerlink" href="tools.html#django.test.Client.cookies" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="153">A Python <a class="reference external" href="https://docs.python.org/3/library/http.cookies.html#http.cookies.SimpleCookie" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">SimpleCookie</span></tt></a> object, containing the current values of all the client cookies. </font><font id="154">See the documentation of the <a class="reference external" href="https://docs.python.org/3/library/http.cookies.html#module-http.cookies" title="(in Python v3.4)"><tt class="xref py py-mod docutils literal"><span class="pre">http.cookies</span></tt></a> module for more.</font></p>
</dd></dl>
<dl class="attribute">
<dt id="django.test.Client.session">
<tt class="descclassname">Client.</tt><tt class="descname">session</tt><a class="headerlink" href="tools.html#django.test.Client.session" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="155">A dictionary-like object containing session information. </font><font id="156">See the <a class="reference internal" href="../http/sessions.html"><em>session documentation</em></a> for full details.</font></p>
<p><font id="157">To modify the session and then save it, it must be stored in a variable first (because a new <tt class="docutils literal"><span class="pre">SessionStore</span></tt> is created every time this property is accessed):</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span>
    <span class="n">session</span><span class="p">[</span><span class="s">'somekey'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'test'</span>
    <span class="n">session</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>
</div>
<div class="section" id="s-example">
<span id="example"></span><h3><font id="452">Example</font><a class="headerlink" href="tools.html#example" title="Permalink to this headline">¶</a></h3>
<p><font id="158">The following is a simple unit test using the test client:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="k">class</span> <span class="nc">SimpleTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Every test needs a client.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Issue a GET request.</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customer/details/'</span><span class="p">)</span>

        <span class="c"># Check that the response is 200 OK.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

        <span class="c"># Check that the rendered context contains 5 customers.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s">'customers'</span><span class="p">]),</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title"><font id="159">See also</font></p>
<p class="last"><font id="160"><a class="reference internal" href="advanced.html#django.test.RequestFactory" title="django.test.RequestFactory"><tt class="xref py py-class docutils literal"><span class="pre">django.test.RequestFactory</span></tt></a></font></p>
</div>
</div>
</div>
<div class="section" id="s-provided-test-case-classes">
<span id="s-django-testcase-subclasses"></span><span id="provided-test-case-classes"></span><span id="django-testcase-subclasses"></span><h2><font id="442">Provided test case classes</font><a class="headerlink" href="tools.html#provided-test-case-classes" title="Permalink to this headline">¶</a></h2>
<p><font id="161">Normal Python unit test classes extend a base class of <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">unittest.</span></tt></a></font><font id="162">TestCase. </font><font id="163">Django provides a few extensions of this base class:</font></p>
<div class="figure" id="testcase-hierarchy-diagram">
<a class="reference internal image-reference" href="../../_images/django_unittest_classes_hierarchy.svg"><img alt="Hierarchy of Django unit testing classes (TestCase subclasses)" height="328" src="../../_images/django_unittest_classes_hierarchy.svg" width="508"/></a>
<p class="caption"><font id="164">Hierarchy of Django unit testing classes</font></p>
</div>
<div class="section" id="s-simpletestcase">
<span id="simpletestcase"></span><h3><font id="453">SimpleTestCase</font><a class="headerlink" href="tools.html#simpletestcase" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="django.test.SimpleTestCase">
<em class="property">class </em><tt class="descname">SimpleTestCase</tt><a class="headerlink" href="tools.html#django.test.SimpleTestCase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="165">A thin subclass of <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">unittest.</span></tt></a></font><font id="166">TestCase, it extends it with some basic functionality like:</font></p>
<ul class="simple">
<li><font id="478">Saving and restoring the Python warning machinery state.</font></li>
<li>Some useful assertions like:<ul>
<li><font id="480">Checking that a callable <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertRaisesMessage" title="django.test.SimpleTestCase.assertRaisesMessage"><font id="479">{{s.479}}</font></a>.</font></li>
<li><font id="481">Testing form field <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertFieldOutput" title="django.test.SimpleTestCase.assertFieldOutput"><tt class="xref py py-meth docutils literal"><span class="pre">rendering</span> <span class="pre">and</span> <span class="pre">error</span> <span class="pre">treatment</span></tt></a>.</font></li>
<li><font id="482">Testing <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertContains" title="django.test.SimpleTestCase.assertContains"><tt class="xref py py-meth docutils literal"><span class="pre">HTML</span> <span class="pre">responses</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">presence/lack</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">given</span> <span class="pre">fragment</span></tt></a>.</font></li>
<li><font id="483">Verifying that a template <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertTemplateUsed" title="django.test.SimpleTestCase.assertTemplateUsed"><tt class="xref py py-meth docutils literal"><span class="pre">has/hasn't</span> <span class="pre">been</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">generate</span> <span class="pre">a</span> <span class="pre">given</span> <span class="pre">response</span> <span class="pre">content</span></tt></a>.</font></li>
<li><font id="484">Verifying a HTTP <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertRedirects" title="django.test.SimpleTestCase.assertRedirects"><tt class="xref py py-meth docutils literal"><span class="pre">redirect</span></tt></a> is performed by the app.</font></li>
<li><font id="485">Robustly testing two <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="django.test.SimpleTestCase.assertHTMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">HTML</span> <span class="pre">fragments</span></tt></a> for equality/inequality or <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertInHTML" title="django.test.SimpleTestCase.assertInHTML"><tt class="xref py py-meth docutils literal"><span class="pre">containment</span></tt></a>.</font></li>
<li><font id="486">Robustly testing two <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertXMLEqual" title="django.test.SimpleTestCase.assertXMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">XML</span> <span class="pre">fragments</span></tt></a> for equality/inequality.</font></li>
<li><font id="487">Robustly testing two <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertJSONEqual" title="django.test.SimpleTestCase.assertJSONEqual"><tt class="xref py py-meth docutils literal"><span class="pre">JSON</span> <span class="pre">fragments</span></tt></a> for equality.</font></li>
</ul>
</li>
<li><font id="488">The ability to run tests with <a class="reference internal" href="tools.html#overriding-settings"><em>modified settings</em></a>.</font></li>
<li><font id="489">Using the <a class="reference internal" href="tools.html#django.test.SimpleTestCase.client" title="django.test.SimpleTestCase.client"><tt class="xref py py-attr docutils literal"><span class="pre">client</span></tt></a> <a class="reference internal" href="tools.html#django.test.Client" title="django.test.Client"><tt class="xref py py-class docutils literal"><span class="pre">Client</span></tt></a>.</font></li>
<li><font id="490">Custom test-time <a class="reference internal" href="tools.html#django.test.SimpleTestCase.urls" title="django.test.SimpleTestCase.urls"><tt class="xref py py-attr docutils literal"><span class="pre">URL</span> <span class="pre">maps</span></tt></a>.</font></li>
</ul>
<p><font id="167">If you need any of the other more complex and heavyweight Django-specific features like:</font></p>
<ul class="simple">
<li><font id="491">Testing or using the ORM.</font></li>
<li><font id="492">Database <a class="reference internal" href="tools.html#django.test.TransactionTestCase.fixtures" title="django.test.TransactionTestCase.fixtures"><tt class="xref py py-attr docutils literal"><span class="pre">fixtures</span></tt></a>.</font></li>
<li><font id="493">Test <a class="reference internal" href="tools.html#skipping-tests"><em>skipping based on database backend features</em></a>.</font></li>
<li><font id="494">The remaining specialized <a class="reference internal" href="tools.html#django.test.TransactionTestCase.assertQuerysetEqual" title="django.test.TransactionTestCase.assertQuerysetEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assert*</span></tt></a> methods.</font></li>
</ul>
<p><font id="168">then you should use <a class="reference internal" href="tools.html#django.test.TransactionTestCase" title="django.test.TransactionTestCase"><tt class="xref py py-class docutils literal"><span class="pre">TransactionTestCase</span></tt></a> or <a class="reference internal" href="tools.html#django.test.TestCase" title="django.test.TestCase"><tt class="xref py py-class docutils literal"><span class="pre">TestCase</span></tt></a> instead.</font></p>
<p><font id="169"><tt class="docutils literal"><span class="pre">SimpleTestCase</span></tt> inherits from <tt class="docutils literal"><span class="pre">unittest.</span></tt></font><font id="170">TestCase.</font></p>
<div class="admonition warning">
<p class="first admonition-title"><font id="171">Warning</font></p>
<p><font id="172"><tt class="docutils literal"><span class="pre">SimpleTestCase</span></tt> and its subclasses (e.g. <tt class="docutils literal"><span class="pre">TestCase</span></tt>, ...) rely on <tt class="docutils literal"><span class="pre">setUpClass()</span></tt> and <tt class="docutils literal"><span class="pre">tearDownClass()</span></tt> to perform some class-wide initialization (e.g. overriding settings). </font><font id="173">If you need to override those methods, don’t forget to call the <tt class="docutils literal"><span class="pre">super</span></tt> implementation:</font></p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyTestCase</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">setUpClass</span><span class="p">()</span>     <span class="c"># Call parent first</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tearDownClass</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="o">...</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyTestCase</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">tearDownClass</span><span class="p">()</span>  <span class="c"># Call parent last</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-transactiontestcase">
<span id="transactiontestcase"></span><h3><font id="454">TransactionTestCase</font><a class="headerlink" href="tools.html#transactiontestcase" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="django.test.TransactionTestCase">
<em class="property">class </em><tt class="descname">TransactionTestCase</tt><a class="headerlink" href="tools.html#django.test.TransactionTestCase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="174">Django’s <tt class="docutils literal"><span class="pre">TestCase</span></tt> class (described below) makes use of database transaction facilities to speed up the process of resetting the database to a known state at the beginning of each test. </font><font id="175">A consequence of this, however, is that some database behaviors cannot be tested within a Django <tt class="docutils literal"><span class="pre">TestCase</span></tt> class. </font><font id="176">For instance, you cannot test that a block of code is executing within a transaction, as is required when using <a class="reference internal" href="../../ref/models/querysets.html#django.db.models.query.QuerySet.select_for_update" title="django.db.models.query.QuerySet.select_for_update"><tt class="xref py py-meth docutils literal"><span class="pre">select_for_update()</span></tt></a>. </font><font id="177">In those cases, you should use <tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt>.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.8:</span> <p><font id="178">In older versions of Django, the effects of transaction commit and rollback could not be tested within a <tt class="docutils literal"><span class="pre">TestCase</span></tt>. </font><font id="179">With the completion of the deprecation cycle of the old-style transaction management in Django 1.8, transaction management commands (e.g. <tt class="docutils literal"><span class="pre">transaction.commit()</span></tt>) are no longer disabled within <tt class="docutils literal"><span class="pre">TestCase</span></tt>.</font></p>
</div>
<p><font id="180"><tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt> and <tt class="docutils literal"><span class="pre">TestCase</span></tt> are identical except for the manner in which the database is reset to a known state and the ability for test code to test the effects of commit and rollback:</font></p>
<ul class="simple">
<li><font id="495">A <tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt> resets the database after the test runs by truncating all tables. </font><font id="496">A <tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt> may call commit and rollback and observe the effects of these calls on the database.</font></li>
<li><font id="497">A <tt class="docutils literal"><span class="pre">TestCase</span></tt>, on the other hand, does not truncate tables after a test. </font><font id="498">Instead, it encloses the test code in a database transaction that is rolled back at the end of the test. </font><font id="499">This guarantees that the rollback at the end of the test restores the database to its initial state.</font></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title"><font id="181">Warning</font></p>
<p><font id="182"><tt class="docutils literal"><span class="pre">TestCase</span></tt> running on a database that does not support rollback (e.g. MySQL with the MyISAM storage engine), and all instances of <tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt>, will roll back at the end of the test by deleting all data from the test database and reloading initial data for apps without migrations.</font></p>
<p class="last"><font id="183">Apps with migrations <a class="reference internal" href="overview.html#test-case-serialized-rollback"><em>will not see their data reloaded</em></a>; </font><font id="184">if you need this functionality (for example, third-party apps should enable this) you can set <tt class="docutils literal"><span class="pre">serialized_rollback</span> <span class="pre">=</span> <span class="pre">True</span></tt> inside the <tt class="docutils literal"><span class="pre">TestCase</span></tt> body.</font></p>
</div>
<p><font id="185"><tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt> inherits from <a class="reference internal" href="tools.html#django.test.SimpleTestCase" title="django.test.SimpleTestCase"><tt class="xref py py-class docutils literal"><span class="pre">SimpleTestCase</span></tt></a>.</font></p>
</div>
<div class="section" id="s-testcase">
<span id="testcase"></span><h3><font id="455">TestCase</font><a class="headerlink" href="tools.html#testcase" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="django.test.TestCase">
<em class="property">class </em><tt class="descname">TestCase</tt><a class="headerlink" href="tools.html#django.test.TestCase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="186">This class provides some additional capabilities that can be useful for testing Web sites.</font></p>
<p><font id="187">Converting a normal <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">unittest.</span></tt></a></font><font id="188">TestCase to a Django <a class="reference internal" href="tools.html#django.test.TestCase" title="django.test.TestCase"><tt class="xref py py-class docutils literal"><span class="pre">TestCase</span></tt></a> is easy: Just change the base class of your test from <tt class="docutils literal"><span class="pre">'unittest.</span></tt></font><font id="189">TestCase' to <tt class="docutils literal"><span class="pre">'django.test.TestCase'</span></tt>. </font><font id="190">All of the standard Python unit test functionality will continue to be available, but it will be augmented with some useful additions, including:</font></p>
<ul class="simple">
<li><font id="500">Automatic loading of fixtures.</font></li>
<li><font id="501">Wraps the tests within two nested <tt class="docutils literal"><span class="pre">atomic</span></tt> blocks: one for the whole class and one for each test.</font></li>
<li><font id="502">Creates a TestClient instance.</font></li>
<li><font id="503">Django-specific assertions for testing for things like redirection and form errors.</font></li>
</ul>
<dl class="classmethod">
<dt id="django.test.TestCase.setUpTestData">
<em class="property">classmethod </em><tt class="descclassname">TestCase.</tt><tt class="descname">setUpTestData</tt>()<a class="headerlink" href="tools.html#django.test.TestCase.setUpTestData" title="Permalink to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 1.8.</span> </div>
<p><font id="191">The class-level <tt class="docutils literal"><span class="pre">atomic</span></tt> block described above allows the creation of initial data at the class level, once for the whole <tt class="docutils literal"><span class="pre">TestCase</span></tt>. </font><font id="192">This technique allows for faster tests as compared to using <tt class="docutils literal"><span class="pre">setUp()</span></tt>.</font></p>
<p><font id="193">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">MyTests</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpTestData</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="c"># Set up data for the whole TestCase</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">bar</span><span class="o">=</span><span class="s">"Test"</span><span class="p">)</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">test1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Some test using self.foo</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">test2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Some other test using self.foo</span>
        <span class="o">...</span>
</pre></div>
</div>
<p><font id="194">Note that if the tests are run on a database with no transaction support (for instance, MySQL with the MyISAM engine), <tt class="docutils literal"><span class="pre">setUpTestData()</span></tt> will be called before each test, negating the speed benefits.</font></p>
</dd></dl>
<div class="admonition warning">
<p class="first admonition-title"><font id="195">Warning</font></p>
<p class="last"><font id="196">If you want to test some specific database transaction behavior, you should use <tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt>, as <tt class="docutils literal"><span class="pre">TestCase</span></tt> wraps test execution within an <a class="reference internal" href="../db/transactions.html#django.db.transaction.atomic" title="django.db.transaction.atomic"><tt class="xref py py-func docutils literal"><span class="pre">atomic()</span></tt></a> block.</font></p>
</div>
<p><font id="197"><tt class="docutils literal"><span class="pre">TestCase</span></tt> inherits from <a class="reference internal" href="tools.html#django.test.TransactionTestCase" title="django.test.TransactionTestCase"><tt class="xref py py-class docutils literal"><span class="pre">TransactionTestCase</span></tt></a>.</font></p>
</div>
<div class="section" id="s-liveservertestcase">
<span id="s-live-test-server"></span><span id="liveservertestcase"></span><span id="live-test-server"></span><h3><font id="456">LiveServerTestCase</font><a class="headerlink" href="tools.html#liveservertestcase" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="django.test.LiveServerTestCase">
<em class="property">class </em><tt class="descname">LiveServerTestCase</tt><a class="headerlink" href="tools.html#django.test.LiveServerTestCase" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="198"><tt class="docutils literal"><span class="pre">LiveServerTestCase</span></tt> does basically the same as <a class="reference internal" href="tools.html#django.test.TransactionTestCase" title="django.test.TransactionTestCase"><tt class="xref py py-class docutils literal"><span class="pre">TransactionTestCase</span></tt></a> with one extra feature: it launches a live Django server in the background on setup, and shuts it down on teardown. </font><font id="199">This allows the use of automated test clients other than the <a class="reference internal" href="tools.html#test-client"><em>Django dummy client</em></a> such as, for example, the <a class="reference external" href="http://seleniumhq.org/">Selenium</a> client, to execute a series of functional tests inside a browser and simulate a real user’s actions.</font></p>
<p><font id="200">By default the live server’s address is <tt class="docutils literal"><span class="pre">'localhost:8081'</span></tt> and the full URL can be accessed during the tests with <tt class="docutils literal"><span class="pre">self.live_server_url</span></tt>. </font><font id="201">If you’d like to change the default address (in the case, for example, where the 8081 port is already taken) then you may pass a different one to the <a class="reference internal" href="../../ref/django-admin.html#django-admin-test"><tt class="xref std std-djadmin docutils literal"><span class="pre">test</span></tt></a> command via the <a class="reference internal" href="../../ref/django-admin.html#django-admin-option---liveserver"><tt class="xref std std-djadminopt docutils literal"><span class="pre">--liveserver</span></tt></a> option, for example:</font></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./manage.py <span class="nb">test</span> --liveserver<span class="o">=</span>localhost:8082
</pre></div>
</div>
<p><font id="202">Another way of changing the default server address is by setting the <cite>DJANGO_LIVE_TEST_SERVER_ADDRESS</cite> environment variable somewhere in your code (for example, in a <a class="reference internal" href="advanced.html#topics-testing-test-runner"><em>custom test runner</em></a>):</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s">'DJANGO_LIVE_TEST_SERVER_ADDRESS'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'localhost:8082'</span>
</pre></div>
</div>
<p><font id="203">In the case where the tests are run by multiple processes in parallel (for example, in the context of several simultaneous <a class="reference external" href="http://en.wikipedia.org/wiki/Continuous_integration">continuous integration</a> builds), the processes will compete for the same address, and therefore your tests might randomly fail with an “Address already in use” error. </font><font id="204">To avoid this problem, you can pass a comma-separated list of ports or ranges of ports (at least as many as the number of potential parallel processes). </font><font id="205">For example:</font></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./manage.py <span class="nb">test</span> --liveserver<span class="o">=</span>localhost:8082,8090-8100,9000-9200,7041
</pre></div>
</div>
<p><font id="206">Then, during test execution, each new live test server will try every specified port until it finds one that is free and takes it.</font></p>
<p><font id="207">To demonstrate how to use <tt class="docutils literal"><span class="pre">LiveServerTestCase</span></tt>, let’s write a simple Selenium test. </font><font id="208">First of all, you need to install the <a class="reference external" href="https://pypi.python.org/pypi/selenium">selenium package</a> into your Python path:</font></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> pip install selenium
</pre></div>
</div>
<p><font id="209">Then, add a <tt class="docutils literal"><span class="pre">LiveServerTestCase</span></tt>-based test to your app’s tests module (for example: <tt class="docutils literal"><span class="pre">myapp/tests.py</span></tt>). </font><font id="210">The code for this test may look as follows:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">LiveServerTestCase</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.firefox.webdriver</span> <span class="kn">import</span> <span class="n">WebDriver</span>

<span class="k">class</span> <span class="nc">MySeleniumTests</span><span class="p">(</span><span class="n">LiveServerTestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s">'user-data.json'</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">setUpClass</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MySeleniumTests</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">setUpClass</span><span class="p">()</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">selenium</span> <span class="o">=</span> <span class="n">WebDriver</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">tearDownClass</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="n">cls</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MySeleniumTests</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span><span class="o">.</span><span class="n">tearDownClass</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'</span><span class="si">%s%s</span><span class="s">'</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">live_server_url</span><span class="p">,</span> <span class="s">'/login/'</span><span class="p">))</span>
        <span class="n">username_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"username"</span><span class="p">)</span>
        <span class="n">username_input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">'myuser'</span><span class="p">)</span>
        <span class="n">password_input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"password"</span><span class="p">)</span>
        <span class="n">password_input</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">'secret'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//input[@value="Log in"]'</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>
</div>
<p><font id="211">Finally, you may run the test as follows:</font></p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ./manage.py <span class="nb">test </span>myapp.tests.MySeleniumTests.test_login
</pre></div>
</div>
<p><font id="212">This example will automatically open Firefox then go to the login page, enter the credentials and press the “Log in” button. </font><font id="213">Selenium offers other drivers in case you do not have Firefox installed or wish to use another browser. </font><font id="214">The example above is just a tiny fraction of what the Selenium client can do; </font><font id="215">check out the <a class="reference external" href="http://selenium-python.readthedocs.org/en/latest/api.html">full reference</a> for more details.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="216">In older versions, <tt class="docutils literal"><span class="pre">LiveServerTestCase</span></tt> relied on the <a class="reference internal" href="../../howto/static-files/index.html"><em>staticfiles contrib app</em></a> to transparently serve static files during the execution of tests. </font><font id="217">This functionality has been moved to the <a class="reference internal" href="../../ref/contrib/staticfiles.html#django.contrib.staticfiles.testing.StaticLiveServerTestCase" title="django.contrib.staticfiles.testing.StaticLiveServerTestCase"><tt class="xref py py-class docutils literal"><span class="pre">StaticLiveServerTestCase</span></tt></a> subclass, so use that subclass if you need <a class="reference internal" href="../../howto/static-files/index.html#staticfiles-testing-support"><em>the original behavior</em></a>.</font></p>
<p><font id="218"><tt class="docutils literal"><span class="pre">LiveServerTestCase</span></tt> now simply publishes the contents of the file system under <a class="reference internal" href="../../ref/settings.html#std:setting-STATIC_ROOT"><tt class="xref std std-setting docutils literal"><span class="pre">STATIC_ROOT</span></tt></a> at the <a class="reference internal" href="../../ref/settings.html#std:setting-STATIC_URL"><tt class="xref std std-setting docutils literal"><span class="pre">STATIC_URL</span></tt></a>.</font></p>
</div>
<div class="admonition note">
<p class="first admonition-title"><font id="219">Note</font></p>
<p><font id="220">When using an in-memory SQLite database to run the tests, the same database connection will be shared by two threads in parallel: the thread in which the live server is run and the thread in which the test case is run. </font><font id="221">It’s important to prevent simultaneous database queries via this shared connection by the two threads, as that may sometimes randomly cause the tests to fail. </font><font id="222">So you need to ensure that the two threads don’t access the database at the same time. </font><font id="223">In particular, this means that in some cases (for example, just after clicking a link or submitting a form), you might need to check that a response is received by Selenium and that the next page is loaded before proceeding with further test execution. </font><font id="224">Do this, for example, by making Selenium wait until the <tt class="docutils literal"><span class="pre">&lt;body&gt;</span></tt> HTML tag is found in the response (requires Selenium &gt; 2.13):</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">selenium.webdriver.support.wait</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
    <span class="n">timeout</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="o">...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//input[@value="Log in"]'</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="c"># Wait until the response is received</span>
    <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selenium</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">driver</span><span class="p">:</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_tag_name</span><span class="p">(</span><span class="s">'body'</span><span class="p">))</span>
</pre></div>
</div>
<p class="last"><font id="225">The tricky thing here is that there’s really no such thing as a “page load,” especially in modern Web apps that generate HTML dynamically after the server generates the initial document. </font><font id="226">So, simply checking for the presence of <tt class="docutils literal"><span class="pre">&lt;body&gt;</span></tt> in the response might not necessarily be appropriate for all use cases. </font><font id="227">Please refer to the <a class="reference external" href="http://code.google.com/p/selenium/wiki/FrequentlyAskedQuestions#Q:_WebDriver_fails_to_find_elements_/_Does_not_block_on_page_loa">Selenium FAQ</a> and <a class="reference external" href="http://seleniumhq.org/docs/04_webdriver_advanced.html#explicit-waits">Selenium documentation</a> for more information.</font></p>
</div>
</div>
</div>
<div class="section" id="s-test-cases-features">
<span id="test-cases-features"></span><h2><font id="443">Test cases features</font><a class="headerlink" href="tools.html#test-cases-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="s-default-test-client">
<span id="default-test-client"></span><h3><font id="457">Default test client</font><a class="headerlink" href="tools.html#default-test-client" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="django.test.SimpleTestCase.client">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">client</tt><a class="headerlink" href="tools.html#django.test.SimpleTestCase.client" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="228">Every test case in a <tt class="docutils literal"><span class="pre">django.test.*TestCase</span></tt> instance has access to an instance of a Django test client. </font><font id="229">This client can be accessed as <tt class="docutils literal"><span class="pre">self.client</span></tt>. </font><font id="230">This client is recreated for each test, so you don’t have to worry about state (such as cookies) carrying over from one test to another.</font></p>
<p><font id="231">This means, instead of instantiating a <tt class="docutils literal"><span class="pre">Client</span></tt> in each test:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="k">class</span> <span class="nc">SimpleTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customer/details/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customer/index/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="232">...you can just refer to <tt class="docutils literal"><span class="pre">self.client</span></tt>, like so:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">SimpleTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customer/details/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/customer/index/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-customizing-the-test-client">
<span id="customizing-the-test-client"></span><h3><font id="458">Customizing the test client</font><a class="headerlink" href="tools.html#customizing-the-test-client" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="django.test.SimpleTestCase.client_class">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">client_class</tt><a class="headerlink" href="tools.html#django.test.SimpleTestCase.client_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="233">If you want to use a different <tt class="docutils literal"><span class="pre">Client</span></tt> class (for example, a subclass with customized behavior), use the <a class="reference internal" href="tools.html#django.test.SimpleTestCase.client_class" title="django.test.SimpleTestCase.client_class"><tt class="xref py py-attr docutils literal"><span class="pre">client_class</span></tt></a> class attribute:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">Client</span>

<span class="k">class</span> <span class="nc">MyTestClient</span><span class="p">(</span><span class="n">Client</span><span class="p">):</span>
    <span class="c"># Specialized methods for your environment</span>
    <span class="o">...</span>

<span class="k">class</span> <span class="nc">MyTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">client_class</span> <span class="o">=</span> <span class="n">MyTestClient</span>

    <span class="k">def</span> <span class="nf">test_my_stuff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Here self.client is an instance of MyTestClient...</span>
        <span class="n">call_some_test_code</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="s-fixture-loading">
<span id="s-topics-testing-fixtures"></span><span id="fixture-loading"></span><span id="topics-testing-fixtures"></span><h3><font id="459">Fixture loading</font><a class="headerlink" href="tools.html#fixture-loading" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="django.test.TransactionTestCase.fixtures">
<tt class="descclassname">TransactionTestCase.</tt><tt class="descname">fixtures</tt><a class="headerlink" href="tools.html#django.test.TransactionTestCase.fixtures" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="234">A test case for a database-backed Web site isn’t much use if there isn’t any data in the database. </font><font id="235">To make it easy to put test data into the database, Django’s custom <tt class="docutils literal"><span class="pre">TransactionTestCase</span></tt> class provides a way of loading <strong>fixtures</strong>.</font></p>
<p><font id="236">A fixture is a collection of data that Django knows how to import into a database. </font><font id="237">For example, if your site has user accounts, you might set up a fixture of fake user accounts in order to populate your database during tests.</font></p>
<p><font id="238">The most straightforward way of creating a fixture is to use the <a class="reference internal" href="../../ref/django-admin.html#django-admin-dumpdata"><tt class="xref std std-djadmin docutils literal"><span class="pre">manage.py</span> <span class="pre">dumpdata</span></tt></a> command. </font><font id="239">This assumes you already have some data in your database. </font><font id="240">See the <a class="reference internal" href="../../ref/django-admin.html#django-admin-dumpdata"><tt class="xref std std-djadmin docutils literal"><span class="pre">dumpdata</span> <span class="pre">documentation</span></tt></a> for more details.</font></p>
<div class="admonition note">
<p class="first admonition-title"><font id="241">Note</font></p>
<p><font id="242">If you’ve ever run <a class="reference internal" href="../../ref/django-admin.html#django-admin-migrate"><tt class="xref std std-djadmin docutils literal"><span class="pre">manage.py</span> <span class="pre">migrate</span></tt></a>, you’ve already used a fixture without even knowing it! </font><font id="243">When you call <a class="reference internal" href="../../ref/django-admin.html#django-admin-migrate"><tt class="xref std std-djadmin docutils literal"><span class="pre">migrate</span></tt></a> in the database for the first time, Django installs a fixture called <tt class="docutils literal"><span class="pre">initial_data</span></tt>. </font><font id="244">This gives you a way of populating a new database with any initial data, such as a default set of categories.</font></p>
<p class="last"><font id="245">Fixtures with other names can always be installed manually using the <a class="reference internal" href="../../ref/django-admin.html#django-admin-loaddata"><tt class="xref std std-djadmin docutils literal"><span class="pre">manage.py</span> <span class="pre">loaddata</span></tt></a> command.</font></p>
</div>
<div class="admonition-initial-sql-data-and-testing admonition">
<p class="first admonition-title"><font id="246">Initial SQL data and testing</font></p>
<p class="last"><font id="247">Django provides a second way to insert initial data into models – the <a class="reference internal" href="../../howto/initial-data.html#initial-sql"><em>custom SQL hook</em></a>. </font><font id="248">However, this technique <em>cannot</em> be used to provide initial data for testing purposes. </font><font id="249">Django’s test framework flushes the contents of the test database after each test; </font><font id="250">as a result, any data added using the custom SQL hook will be lost.</font></p>
</div>
<p><font id="251">Once you’ve created a fixture and placed it in a <tt class="docutils literal"><span class="pre">fixtures</span></tt> directory in one of your <a class="reference internal" href="../../ref/settings.html#std:setting-INSTALLED_APPS"><tt class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></tt></a>, you can use it in your unit tests by specifying a <tt class="docutils literal"><span class="pre">fixtures</span></tt> class attribute on your <a class="reference internal" href="tools.html#django.test.TestCase" title="django.test.TestCase"><tt class="xref py py-class docutils literal"><span class="pre">django.test.TestCase</span></tt></a> subclass:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">Animal</span>

<span class="k">class</span> <span class="nc">AnimalTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s">'mammals.json'</span><span class="p">,</span> <span class="s">'birds'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Test definitions as before.</span>
        <span class="n">call_setup_methods</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">testFluffyAnimals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># A test that uses the fixtures.</span>
        <span class="n">call_some_test_code</span><span class="p">()</span>
</pre></div>
</div>
<p><font id="252">Here’s specifically what will happen:</font></p>
<ul class="simple">
<li><font id="504">At the start of each test case, before <tt class="docutils literal"><span class="pre">setUp()</span></tt> is run, Django will flush the database, returning the database to the state it was in directly after <a class="reference internal" href="../../ref/django-admin.html#django-admin-migrate"><tt class="xref std std-djadmin docutils literal"><span class="pre">migrate</span></tt></a> was called.</font></li>
<li><font id="505">Then, all the named fixtures are installed. </font><font id="506">In this example, Django will install any JSON fixture named <tt class="docutils literal"><span class="pre">mammals</span></tt>, followed by any fixture named <tt class="docutils literal"><span class="pre">birds</span></tt>. </font><font id="507">See the <a class="reference internal" href="../../ref/django-admin.html#django-admin-loaddata"><tt class="xref std std-djadmin docutils literal"><span class="pre">loaddata</span></tt></a> documentation for more details on defining and installing fixtures.</font></li>
</ul>
<p><font id="253">This flush/load procedure is repeated for each test in the test case, so you can be certain that the outcome of a test will not be affected by another test, or by the order of test execution.</font></p>
<p><font id="254">By default, fixtures are only loaded into the <tt class="docutils literal"><span class="pre">default</span></tt> database. </font><font id="255">If you are using multiple databases and set <a class="reference internal" href="tools.html#django.test.TransactionTestCase.multi_db" title="django.test.TransactionTestCase.multi_db"><tt class="xref py py-attr docutils literal"><span class="pre">multi_db=True</span></tt></a>, fixtures will be loaded into all databases.</font></p>
</div>
<div class="section" id="s-urlconf-configuration">
<span id="urlconf-configuration"></span><h3><font id="460">URLconf configuration</font><a class="headerlink" href="tools.html#urlconf-configuration" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="django.test.SimpleTestCase.urls">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">urls</tt><a class="headerlink" href="tools.html#django.test.SimpleTestCase.urls" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<div class="deprecated">
<p><font id="256"><span class="versionmodified">Deprecated since version 1.8: </span></font><font id="257">Use <tt class="docutils literal"><span class="pre">@override_settings(ROOT_URLCONF=...)</span></tt> instead for URLconf configuration.</font></p>
</div>
<p><font id="258">If your application provides views, you may want to include tests that use the test client to exercise those views. </font><font id="259">However, an end user is free to deploy the views in your application at any URL of their choosing. </font><font id="260">This means that your tests can’t rely upon the fact that your views will be available at a particular URL.</font></p>
<p><font id="261">In order to provide a reliable URL space for your test, <tt class="docutils literal"><span class="pre">django.test.*TestCase</span></tt> classes provide the ability to customize the URLconf configuration for the duration of the execution of a test suite. </font><font id="262">If your <tt class="docutils literal"><span class="pre">*TestCase</span></tt> instance defines an <tt class="docutils literal"><span class="pre">urls</span></tt> attribute, the <tt class="docutils literal"><span class="pre">*TestCase</span></tt> will use the value of that attribute as the <a class="reference internal" href="../../ref/settings.html#std:setting-ROOT_URLCONF"><tt class="xref std std-setting docutils literal"><span class="pre">ROOT_URLCONF</span></tt></a> for the duration of that test.</font></p>
<p><font id="263">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">TestMyViews</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="s">'myapp.test_urls'</span>

    <span class="k">def</span> <span class="nf">testIndexPageView</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Here you'd test your view using ``Client``.</span>
        <span class="n">call_some_test_code</span><span class="p">()</span>
</pre></div>
</div>
<p><font id="264">This test case will use the contents of <tt class="docutils literal"><span class="pre">myapp.test_urls</span></tt> as the URLconf for the duration of the test case.</font></p>
</div>
<div class="section" id="s-multi-database-support">
<span id="s-emptying-test-outbox"></span><span id="multi-database-support"></span><span id="emptying-test-outbox"></span><h3><font id="461">Multi-database support</font><a class="headerlink" href="tools.html#multi-database-support" title="Permalink to this headline">¶</a></h3>
<dl class="attribute">
<dt id="django.test.TransactionTestCase.multi_db">
<tt class="descclassname">TransactionTestCase.</tt><tt class="descname">multi_db</tt><a class="headerlink" href="tools.html#django.test.TransactionTestCase.multi_db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="265">Django sets up a test database corresponding to every database that is defined in the <a class="reference internal" href="../../ref/settings.html#std:setting-DATABASES"><tt class="xref std std-setting docutils literal"><span class="pre">DATABASES</span></tt></a> definition in your settings file. </font><font id="266">However, a big part of the time taken to run a Django TestCase is consumed by the call to <tt class="docutils literal"><span class="pre">flush</span></tt> that ensures that you have a clean database at the start of each test run. </font><font id="267">If you have multiple databases, multiple flushes are required (one for each database), which can be a time consuming activity – especially if your tests don’t need to test multi-database activity.</font></p>
<p><font id="268">As an optimization, Django only flushes the <tt class="docutils literal"><span class="pre">default</span></tt> database at the start of each test run. </font><font id="269">If your setup contains multiple databases, and you have a test that requires every database to be clean, you can use the <tt class="docutils literal"><span class="pre">multi_db</span></tt> attribute on the test suite to request a full flush.</font></p>
<p><font id="270">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TestMyViews</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">multi_db</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">testIndexPageView</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">call_some_test_code</span><span class="p">()</span>
</pre></div>
</div>
<p><font id="271">This test case will flush <em>all</em> the test databases before running <tt class="docutils literal"><span class="pre">testIndexPageView</span></tt>.</font></p>
<p><font id="272">The <tt class="docutils literal"><span class="pre">multi_db</span></tt> flag also affects into which databases the attr:<cite>TransactionTestCase.fixtures</cite> are loaded. </font><font id="273">By default (when <tt class="docutils literal"><span class="pre">multi_db=False</span></tt>), fixtures are only loaded into the <tt class="docutils literal"><span class="pre">default</span></tt> database. </font><font id="274">If <tt class="docutils literal"><span class="pre">multi_db=True</span></tt>, fixtures are loaded into all databases.</font></p>
</div>
<div class="section" id="s-overriding-settings">
<span id="s-id1"></span><span id="overriding-settings"></span><span id="id1"></span><h3><font id="462">Overriding settings</font><a class="headerlink" href="tools.html#overriding-settings" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title"><font id="275">Warning</font></p>
<p class="last"><font id="276">Use the functions below to temporarily alter the value of settings in tests. </font><font id="277">Don’t manipulate <tt class="docutils literal"><span class="pre">django.conf.settings</span></tt> directly as Django won’t restore the original values after such manipulations.</font></p>
</div>
<dl class="method">
<dt id="django.test.SimpleTestCase.settings">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">settings</tt>()<a class="headerlink" href="tools.html#django.test.SimpleTestCase.settings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="278">For testing purposes it’s often useful to change a setting temporarily and revert to the original value after running the testing code. </font><font id="279">For this use case Django provides a standard Python context manager (see <span class="target" id="index-2"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0343"><strong>PEP 343</strong></a>) called <a class="reference internal" href="tools.html#django.test.SimpleTestCase.settings" title="django.test.SimpleTestCase.settings"><tt class="xref py py-meth docutils literal"><span class="pre">settings()</span></tt></a>, which can be used like this:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">LoginTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># First check for the default behavior</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/sekrit/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'/accounts/login/?next=/sekrit/'</span><span class="p">)</span>

        <span class="c"># Then override the LOGIN_URL setting</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">(</span><span class="n">LOGIN_URL</span><span class="o">=</span><span class="s">'/other/login/'</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/sekrit/'</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'/other/login/?next=/sekrit/'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="280">This example will override the <a class="reference internal" href="../../ref/settings.html#std:setting-LOGIN_URL"><tt class="xref std std-setting docutils literal"><span class="pre">LOGIN_URL</span></tt></a> setting for the code in the <tt class="docutils literal"><span class="pre">with</span></tt> block and reset its value to the previous state afterwards.</font></p>
<dl class="method">
<dt id="django.test.SimpleTestCase.modify_settings">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">modify_settings</tt>()<a class="headerlink" href="tools.html#django.test.SimpleTestCase.modify_settings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<div class="versionadded">
<span class="title">New in Django 1.7.</span> </div>
<p><font id="281">It can prove unwieldy to redefine settings that contain a list of values. </font><font id="282">In practice, adding or removing values is often sufficient. </font><font id="283">The <a class="reference internal" href="tools.html#django.test.SimpleTestCase.modify_settings" title="django.test.SimpleTestCase.modify_settings"><tt class="xref py py-meth docutils literal"><span class="pre">modify_settings()</span></tt></a> context manager makes it easy:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">MiddlewareTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_cache_middleware</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">modify_settings</span><span class="p">(</span><span class="n">MIDDLEWARE_CLASSES</span><span class="o">=</span><span class="p">{</span>
            <span class="s">'append'</span><span class="p">:</span> <span class="s">'django.middleware.cache.FetchFromCacheMiddleware'</span><span class="p">,</span>
            <span class="s">'prepend'</span><span class="p">:</span> <span class="s">'django.middleware.cache.UpdateCacheMiddleware'</span><span class="p">,</span>
            <span class="s">'remove'</span><span class="p">:</span> <span class="p">[</span>
                <span class="s">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="p">,</span>
                <span class="s">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class="p">,</span>
                <span class="s">'django.contrib.messages.middleware.MessageMiddleware'</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">}):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
            <span class="c"># ...</span>
</pre></div>
</div>
<p><font id="284">For each action, you can supply either a list of values or a string. </font><font id="285">When the value already exists in the list, <tt class="docutils literal"><span class="pre">append</span></tt> and <tt class="docutils literal"><span class="pre">prepend</span></tt> have no effect; </font><font id="286">neither does <tt class="docutils literal"><span class="pre">remove</span></tt> when the value doesn’t exist.</font></p>
<dl class="function">
<dt id="django.test.override_settings">
<tt class="descname">override_settings</tt>()<a class="headerlink" href="tools.html#django.test.override_settings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="287">In case you want to override a setting for a test method, Django provides the <a class="reference internal" href="tools.html#django.test.override_settings" title="django.test.override_settings"><tt class="xref py py-func docutils literal"><span class="pre">override_settings()</span></tt></a> decorator (see <span class="target" id="index-3"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0318"><strong>PEP 318</strong></a>). </font><font id="288">It’s used like this:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">override_settings</span>

<span class="k">class</span> <span class="nc">LoginTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@override_settings</span><span class="p">(</span><span class="n">LOGIN_URL</span><span class="o">=</span><span class="s">'/other/login/'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/sekrit/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'/other/login/?next=/sekrit/'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="289">The decorator can also be applied to <a class="reference internal" href="tools.html#django.test.TestCase" title="django.test.TestCase"><tt class="xref py py-class docutils literal"><span class="pre">TestCase</span></tt></a> classes:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">override_settings</span>

<span class="nd">@override_settings</span><span class="p">(</span><span class="n">LOGIN_URL</span><span class="o">=</span><span class="s">'/other/login/'</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">LoginTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/sekrit/'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s">'/other/login/?next=/sekrit/'</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="290">Previously, <tt class="docutils literal"><span class="pre">override_settings</span></tt> was imported from <tt class="docutils literal"><span class="pre">django.test.utils</span></tt>.</font></p>
</div>
<dl class="function">
<dt id="django.test.modify_settings">
<tt class="descname">modify_settings</tt>()<a class="headerlink" href="tools.html#django.test.modify_settings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<div class="versionadded">
<span class="title">New in Django 1.7.</span> </div>
<p><font id="291">Likewise, Django provides the <a class="reference internal" href="tools.html#django.test.modify_settings" title="django.test.modify_settings"><tt class="xref py py-func docutils literal"><span class="pre">modify_settings()</span></tt></a> decorator:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">modify_settings</span>

<span class="k">class</span> <span class="nc">MiddlewareTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="nd">@modify_settings</span><span class="p">(</span><span class="n">MIDDLEWARE_CLASSES</span><span class="o">=</span><span class="p">{</span>
        <span class="s">'append'</span><span class="p">:</span> <span class="s">'django.middleware.cache.FetchFromCacheMiddleware'</span><span class="p">,</span>
        <span class="s">'prepend'</span><span class="p">:</span> <span class="s">'django.middleware.cache.UpdateCacheMiddleware'</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="k">def</span> <span class="nf">test_cache_middleware</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
        <span class="c"># ...</span>
</pre></div>
</div>
<p><font id="292">The decorator can also be applied to test case classes:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">modify_settings</span>

<span class="nd">@modify_settings</span><span class="p">(</span><span class="n">MIDDLEWARE_CLASSES</span><span class="o">=</span><span class="p">{</span>
    <span class="s">'append'</span><span class="p">:</span> <span class="s">'django.middleware.cache.FetchFromCacheMiddleware'</span><span class="p">,</span>
    <span class="s">'prepend'</span><span class="p">:</span> <span class="s">'django.middleware.cache.UpdateCacheMiddleware'</span><span class="p">,</span>
<span class="p">})</span>
<span class="k">class</span> <span class="nc">MiddlewareTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_cache_middleware</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
        <span class="c"># ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font id="293">Note</font></p>
<p class="last"><font id="294">When given a class, these decorators modify the class directly and return it; </font><font id="295">they don’t create and return a modified copy of it. </font><font id="296">So if you try to tweak the above examples to assign the return value to a different name than <tt class="docutils literal"><span class="pre">LoginTestCase</span></tt> or <tt class="docutils literal"><span class="pre">MiddlewareTestCase</span></tt>, you may be surprised to find that the original test case classes are still equally affected by the decorator. </font><font id="297">For a given class, <a class="reference internal" href="tools.html#django.test.modify_settings" title="django.test.modify_settings"><tt class="xref py py-func docutils literal"><span class="pre">modify_settings()</span></tt></a> is always applied after <a class="reference internal" href="tools.html#django.test.override_settings" title="django.test.override_settings"><tt class="xref py py-func docutils literal"><span class="pre">override_settings()</span></tt></a>.</font></p>
</div>
<div class="admonition warning">
<p class="first admonition-title"><font id="298">Warning</font></p>
<p><font id="299">The settings file contains some settings that are only consulted during initialization of Django internals. </font><font id="300">If you change them with <tt class="docutils literal"><span class="pre">override_settings</span></tt>, the setting is changed if you access it via the <tt class="docutils literal"><span class="pre">django.conf.settings</span></tt> module, however, Django’s internals access it differently. </font><font id="301">Effectively, using <a class="reference internal" href="tools.html#django.test.override_settings" title="django.test.override_settings"><tt class="xref py py-func docutils literal"><span class="pre">override_settings()</span></tt></a> or <a class="reference internal" href="tools.html#django.test.modify_settings" title="django.test.modify_settings"><tt class="xref py py-func docutils literal"><span class="pre">modify_settings()</span></tt></a> with these settings is probably not going to do what you expect it to do.</font></p>
<p><font id="302">We do not recommend altering the <a class="reference internal" href="../../ref/settings.html#std:setting-DATABASES"><tt class="xref std std-setting docutils literal"><span class="pre">DATABASES</span></tt></a> setting. </font><font id="303">Altering the <a class="reference internal" href="../../ref/settings.html#std:setting-CACHES"><tt class="xref std std-setting docutils literal"><span class="pre">CACHES</span></tt></a> setting is possible, but a bit tricky if you are using internals that make using of caching, like <a class="reference internal" href="../http/sessions.html#module-django.contrib.sessions" title="django.contrib.sessions: Provides session management for Django projects."><tt class="xref py py-mod docutils literal"><span class="pre">django.contrib.sessions</span></tt></a>. </font><font id="304">For example, you will have to reinitialize the session backend in a test that uses cached sessions and overrides <a class="reference internal" href="../../ref/settings.html#std:setting-CACHES"><tt class="xref std std-setting docutils literal"><span class="pre">CACHES</span></tt></a>.</font></p>
<p class="last"><font id="305">Finally, avoid aliasing your settings as module-level constants as <tt class="docutils literal"><span class="pre">override_settings()</span></tt> won’t work on such values since they are only evaluated the first time the module is imported.</font></p>
</div>
<p><font id="306">You can also simulate the absence of a setting by deleting it after settings have been overridden, like this:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@override_settings</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">del</span> <span class="n">settings</span><span class="o">.</span><span class="n">LOGIN_URL</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="307">Previously, you could only simulate the deletion of a setting which was explicitly overridden.</font></p>
</div>
<p><font id="308">When overriding settings, make sure to handle the cases in which your app’s code uses a cache or similar feature that retains state even if the setting is changed. </font><font id="309">Django provides the <a class="reference internal" href="../../ref/signals.html#django.test.signals.setting_changed" title="django.test.signals.setting_changed"><tt class="xref py py-data docutils literal"><span class="pre">django.test.signals.setting_changed</span></tt></a> signal that lets you register callbacks to clean up and otherwise reset state when settings are changed.</font></p>
<p><font id="310">Django itself uses this signal to reset various data:</font></p>
<table class="docutils">
<colgroup>
<col width="43%"></col>
<col width="57%"></col>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Overridden settings</th>
<th class="head">Data reset</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>USE_TZ, TIME_ZONE</td>
<td>Databases timezone</td>
</tr>
<tr class="row-odd"><td>TEMPLATES</td>
<td>Template engines</td>
</tr>
<tr class="row-even"><td>SERIALIZATION_MODULES</td>
<td>Serializers cache</td>
</tr>
<tr class="row-odd"><td>LOCALE_PATHS, LANGUAGE_CODE</td>
<td>Default translation and loaded translations</td>
</tr>
<tr class="row-even"><td>MEDIA_ROOT, DEFAULT_FILE_STORAGE</td>
<td>Default file storage</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="s-emptying-the-test-outbox">
<span id="emptying-the-test-outbox"></span><h3><font id="463">Emptying the test outbox</font><a class="headerlink" href="tools.html#emptying-the-test-outbox" title="Permalink to this headline">¶</a></h3>
<p><font id="311">If you use any of Django’s custom <tt class="docutils literal"><span class="pre">TestCase</span></tt> classes, the test runner will clear the contents of the test email outbox at the start of each test case.</font></p>
<p><font id="312">For more detail on email services during tests, see <a class="reference internal" href="tools.html#email-services">Email services</a> below.</font></p>
</div>
<div class="section" id="s-assertions">
<span id="s-id2"></span><span id="assertions"></span><span id="id2"></span><h3><font id="464">Assertions</font><a class="headerlink" href="tools.html#assertions" title="Permalink to this headline">¶</a></h3>
<p><font id="313">As Python’s normal <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">unittest.</span></tt></a></font><font id="314">TestCase class implements assertion methods such as <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertTrue" title="(in Python v3.4)"><tt class="xref py py-meth docutils literal"><span class="pre">assertTrue()</span></tt></a> and <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertEqual" title="(in Python v3.4)"><tt class="xref py py-meth docutils literal"><span class="pre">assertEqual()</span></tt></a>, Django’s custom <a class="reference internal" href="tools.html#django.test.TestCase" title="django.test.TestCase"><tt class="xref py py-class docutils literal"><span class="pre">TestCase</span></tt></a> class provides a number of custom assertion methods that are useful for testing Web applications:</font></p>
<p><font id="315">The failure messages given by most of these assertion methods can be customized with the <tt class="docutils literal"><span class="pre">msg_prefix</span></tt> argument. </font><font id="316">This string will be prefixed to any failure message generated by the assertion. </font><font id="317">This allows you to provide additional details that may help you to identify the location and cause of an failure in your test suite.</font></p>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertRaisesMessage">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertRaisesMessage</tt>(<em>expected_exception</em>, <em>expected_message</em>, <em>callable_obj=None</em>, <em>*args</em>, <em>**kwargs</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertRaisesMessage" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="318">Asserts that execution of callable <tt class="docutils literal"><span class="pre">callable_obj</span></tt> raised the <tt class="docutils literal"><span class="pre">expected_exception</span></tt> exception and that such exception has an <tt class="docutils literal"><span class="pre">expected_message</span></tt> representation. </font><font id="319">Any other outcome is reported as a failure. </font><font id="320">Similar to unittest’s <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertRaisesRegex" title="(in Python v3.4)"><tt class="xref py py-meth docutils literal"><span class="pre">assertRaisesRegex()</span></tt></a> with the difference that <tt class="docutils literal"><span class="pre">expected_message</span></tt> isn’t a regular expression.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertFieldOutput">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertFieldOutput</tt>(<em>fieldclass</em>, <em>valid</em>, <em>invalid</em>, <em>field_args=None</em>, <em>field_kwargs=None</em>, <em>empty_value=''</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertFieldOutput" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="321">Asserts that a form field behaves correctly with various inputs.</font></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><font id="508"><strong>fieldclass</strong> – the class of the field to be tested.</font></li>
<li><font id="509"><strong>valid</strong> – a dictionary mapping valid inputs to their expected cleaned values.</font></li>
<li><font id="510"><strong>invalid</strong> – a dictionary mapping invalid inputs to one or more raised error messages.</font></li>
<li><font id="511"><strong>field_args</strong> – the args passed to instantiate the field.</font></li>
<li><font id="512"><strong>field_kwargs</strong> – the kwargs passed to instantiate the field.</font></li>
<li><font id="513"><strong>empty_value</strong> – the expected clean output for inputs in <tt class="docutils literal"><span class="pre">empty_values</span></tt>.</font></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><font id="322">For example, the following code tests that an <tt class="docutils literal"><span class="pre">EmailField</span></tt> accepts <tt class="docutils literal"><span class="pre">a@a.com</span></tt> as a valid email address, but rejects <tt class="docutils literal"><span class="pre">aaa</span></tt> with a reasonable error message:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">assertFieldOutput</span><span class="p">(</span><span class="n">EmailField</span><span class="p">,</span> <span class="p">{</span><span class="s">'a@a.com'</span><span class="p">:</span> <span class="s">'a@a.com'</span><span class="p">},</span> <span class="p">{</span><span class="s">'aaa'</span><span class="p">:</span> <span class="p">[</span><span class="s">'Enter a valid email address.'</span><span class="p">]})</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertFormError">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertFormError</tt>(<em>response</em>, <em>form</em>, <em>field</em>, <em>errors</em>, <em>msg_prefix=''</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertFormError" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="323">Asserts that a field on a form raises the provided list of errors when rendered on the form.</font></p>
<p><font id="324"><tt class="docutils literal"><span class="pre">form</span></tt> is the name the <tt class="docutils literal"><span class="pre">Form</span></tt> instance was given in the template context.</font></p>
<p><font id="325"><tt class="docutils literal"><span class="pre">field</span></tt> is the name of the field on the form to check. </font><font id="326">If <tt class="docutils literal"><span class="pre">field</span></tt> has a value of <tt class="docutils literal"><span class="pre">None</span></tt>, non-field errors (errors you can access via <a class="reference internal" href="../../ref/forms/api.html#django.forms.Form.non_field_errors" title="django.forms.Form.non_field_errors"><tt class="xref py py-meth docutils literal"><span class="pre">form.non_field_errors()</span></tt></a>) will be checked.</font></p>
<p><font id="327"><tt class="docutils literal"><span class="pre">errors</span></tt> is an error string, or a list of error strings, that are expected as a result of form validation.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertFormsetError">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertFormsetError</tt>(<em>response</em>, <em>formset</em>, <em>form_index</em>, <em>field</em>, <em>errors</em>, <em>msg_prefix=''</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertFormsetError" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="328">Asserts that the <tt class="docutils literal"><span class="pre">formset</span></tt> raises the provided list of errors when rendered.</font></p>
<p><font id="329"><tt class="docutils literal"><span class="pre">formset</span></tt> is the name the <tt class="docutils literal"><span class="pre">Formset</span></tt> instance was given in the template context.</font></p>
<p><font id="330"><tt class="docutils literal"><span class="pre">form_index</span></tt> is the number of the form within the <tt class="docutils literal"><span class="pre">Formset</span></tt>. </font><font id="331">If <tt class="docutils literal"><span class="pre">form_index</span></tt> has a value of <tt class="docutils literal"><span class="pre">None</span></tt>, non-form errors (errors you can access via <tt class="docutils literal"><span class="pre">formset.non_form_errors()</span></tt>) will be checked.</font></p>
<p><font id="332"><tt class="docutils literal"><span class="pre">field</span></tt> is the name of the field on the form to check. </font><font id="333">If <tt class="docutils literal"><span class="pre">field</span></tt> has a value of <tt class="docutils literal"><span class="pre">None</span></tt>, non-field errors (errors you can access via <a class="reference internal" href="../../ref/forms/api.html#django.forms.Form.non_field_errors" title="django.forms.Form.non_field_errors"><tt class="xref py py-meth docutils literal"><span class="pre">form.non_field_errors()</span></tt></a>) will be checked.</font></p>
<p><font id="334"><tt class="docutils literal"><span class="pre">errors</span></tt> is an error string, or a list of error strings, that are expected as a result of form validation.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertContains">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertContains</tt>(<em>response</em>, <em>text</em>, <em>count=None</em>, <em>status_code=200</em>, <em>msg_prefix=''</em>, <em>html=False</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertContains" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="335">Asserts that a <tt class="docutils literal"><span class="pre">Response</span></tt> instance produced the given <tt class="docutils literal"><span class="pre">status_code</span></tt> and that <tt class="docutils literal"><span class="pre">text</span></tt> appears in the content of the response. </font><font id="336">If <tt class="docutils literal"><span class="pre">count</span></tt> is provided, <tt class="docutils literal"><span class="pre">text</span></tt> must occur exactly <tt class="docutils literal"><span class="pre">count</span></tt> times in the response.</font></p>
<p><font id="337">Set <tt class="docutils literal"><span class="pre">html</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> to handle <tt class="docutils literal"><span class="pre">text</span></tt> as HTML. </font><font id="338">The comparison with the response content will be based on HTML semantics instead of character-by-character equality. </font><font id="339">Whitespace is ignored in most cases, attribute ordering is not significant. </font><font id="340">See <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="django.test.SimpleTestCase.assertHTMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assertHTMLEqual()</span></tt></a> for more details.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertNotContains">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertNotContains</tt>(<em>response</em>, <em>text</em>, <em>status_code=200</em>, <em>msg_prefix=''</em>, <em>html=False</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertNotContains" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="341">Asserts that a <tt class="docutils literal"><span class="pre">Response</span></tt> instance produced the given <tt class="docutils literal"><span class="pre">status_code</span></tt> and that <tt class="docutils literal"><span class="pre">text</span></tt> does <em>not</em> appear in the content of the response.</font></p>
<p><font id="342">Set <tt class="docutils literal"><span class="pre">html</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt> to handle <tt class="docutils literal"><span class="pre">text</span></tt> as HTML. </font><font id="343">The comparison with the response content will be based on HTML semantics instead of character-by-character equality. </font><font id="344">Whitespace is ignored in most cases, attribute ordering is not significant. </font><font id="345">See <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="django.test.SimpleTestCase.assertHTMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assertHTMLEqual()</span></tt></a> for more details.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertTemplateUsed">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertTemplateUsed</tt>(<em>response</em>, <em>template_name</em>, <em>msg_prefix=''</em>, <em>count=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertTemplateUsed" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="346">Asserts that the template with the given name was used in rendering the response.</font></p>
<p><font id="347">The name is a string such as <tt class="docutils literal"><span class="pre">'admin/index.html'</span></tt>.</font></p>
<div class="versionadded">
<span class="title">New in Django 1.8:</span> <p><font id="348">The count argument is an integer indicating the number of times the template should be rendered. </font><font id="349">Default is <tt class="docutils literal"><span class="pre">None</span></tt>, meaning that the template should be rendered one or more times.</font></p>
</div>
<p><font id="350">You can use this as a context manager, like this:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertTemplateUsed</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">):</span>
    <span class="n">render_to_string</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>
<span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertTemplateUsed</span><span class="p">(</span><span class="n">template_name</span><span class="o">=</span><span class="s">'index.html'</span><span class="p">):</span>
    <span class="n">render_to_string</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertTemplateNotUsed">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertTemplateNotUsed</tt>(<em>response</em>, <em>template_name</em>, <em>msg_prefix=''</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertTemplateNotUsed" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="351">Asserts that the template with the given name was <em>not</em> used in rendering the response.</font></p>
<p><font id="352">You can use this as a context manager in the same way as <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertTemplateUsed" title="django.test.SimpleTestCase.assertTemplateUsed"><tt class="xref py py-meth docutils literal"><span class="pre">assertTemplateUsed()</span></tt></a>.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertRedirects">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertRedirects</tt>(<em>response</em>, <em>expected_url</em>, <em>status_code=302</em>, <em>target_status_code=200</em>, <em>host=None</em>, <em>msg_prefix=''</em>, <em>fetch_redirect_response=True</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertRedirects" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="353">Asserts that the response returned a <tt class="docutils literal"><span class="pre">status_code</span></tt> redirect status, redirected to <tt class="docutils literal"><span class="pre">expected_url</span></tt> (including any <tt class="docutils literal"><span class="pre">GET</span></tt> data), and that the final page was received with <tt class="docutils literal"><span class="pre">target_status_code</span></tt>.</font></p>
<p><font id="354">If your request used the <tt class="docutils literal"><span class="pre">follow</span></tt> argument, the <tt class="docutils literal"><span class="pre">expected_url</span></tt> and <tt class="docutils literal"><span class="pre">target_status_code</span></tt> will be the url and status code for the final point of the redirect chain.</font></p>
<p><font id="355">The <tt class="docutils literal"><span class="pre">host</span></tt> argument sets a default host if <tt class="docutils literal"><span class="pre">expected_url</span></tt> doesn’t include one (e.g. <tt class="docutils literal"><span class="pre">"/bar/"</span></tt>). </font><font id="552">If <tt class="docutils literal"><span class="pre">expected_url</span></tt> is an absolute URL that includes a host (e.g. <tt class="docutils literal"><span class="pre">"http://testhost/bar/"</span></tt>), the <tt class="docutils literal"><span class="pre">host</span></tt> parameter will be ignored. </font><font id="553">Note that the test client doesn’t support fetching external URLs, but the parameter may be useful if you are testing with a custom HTTP host (for example, initializing the test client with <tt class="docutils literal"><span class="pre">Client(HTTP_HOST="testhost")</span></tt>.</font></p>
<div class="versionadded">
<span class="title">New in Django 1.7.</span> </div>
<p><font id="356">If <tt class="docutils literal"><span class="pre">fetch_redirect_response</span></tt> is <tt class="docutils literal"><span class="pre">False</span></tt>, the final page won’t be loaded. </font><font id="357">Since the test client can’t fetch externals URLs, this is particularly useful if <tt class="docutils literal"><span class="pre">expected_url</span></tt> isn’t part of your Django app.</font></p>
<div class="versionadded">
<span class="title">New in Django 1.7.</span> </div>
<p><font id="358">Scheme is handled correctly when making comparisons between two URLs. </font><font id="359">If there isn’t any scheme specified in the location where we are redirected to, the original request’s scheme is used. </font><font id="360">If present, the scheme in <tt class="docutils literal"><span class="pre">expected_url</span></tt> is the one used to make the comparisons to.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertHTMLEqual">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertHTMLEqual</tt>(<em>html1</em>, <em>html2</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="361">Asserts that the strings <tt class="docutils literal"><span class="pre">html1</span></tt> and <tt class="docutils literal"><span class="pre">html2</span></tt> are equal. </font><font id="362">The comparison is based on HTML semantics. </font><font id="363">The comparison takes following things into account:</font></p>
<ul class="simple">
<li><font id="514">Whitespace before and after HTML tags is ignored.</font></li>
<li><font id="515">All types of whitespace are considered equivalent.</font></li>
<li><font id="516">All open tags are closed implicitly, e.g. when a surrounding tag is closed or the HTML document ends.</font></li>
<li><font id="517">Empty tags are equivalent to their self-closing version.</font></li>
<li><font id="518">The ordering of attributes of an HTML element is not significant.</font></li>
<li><font id="519">Attributes without an argument are equal to attributes that equal in name and value (see the examples).</font></li>
</ul>
<p><font id="364">The following examples are valid tests and don’t raise any <tt class="docutils literal"><span class="pre">AssertionError</span></tt>:</font></p>
<div class="highlight-python"><div class="highlight"><pre>self.assertHTMLEqual('&lt;p&gt;Hello &lt;b&gt;world!&lt;/p&gt;',
    '''&lt;p&gt;
        Hello   &lt;b&gt;world! &lt;b/&gt;
    &lt;/p&gt;''')
self.assertHTMLEqual(
    '&lt;input type="checkbox" checked="checked" id="id_accept_terms" /&gt;',
    '&lt;input id="id_accept_terms" type='checkbox' checked&gt;')
</pre></div>
</div>
<p><font id="365"><tt class="docutils literal"><span class="pre">html1</span></tt> and <tt class="docutils literal"><span class="pre">html2</span></tt> must be valid HTML. </font><font id="366">An <tt class="docutils literal"><span class="pre">AssertionError</span></tt> will be raised if one of them cannot be parsed.</font></p>
<p><font id="367">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertHTMLNotEqual">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertHTMLNotEqual</tt>(<em>html1</em>, <em>html2</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertHTMLNotEqual" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="368">Asserts that the strings <tt class="docutils literal"><span class="pre">html1</span></tt> and <tt class="docutils literal"><span class="pre">html2</span></tt> are <em>not</em> equal. </font><font id="369">The comparison is based on HTML semantics. </font><font id="370">See <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="django.test.SimpleTestCase.assertHTMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assertHTMLEqual()</span></tt></a> for details.</font></p>
<p><font id="371"><tt class="docutils literal"><span class="pre">html1</span></tt> and <tt class="docutils literal"><span class="pre">html2</span></tt> must be valid HTML. </font><font id="372">An <tt class="docutils literal"><span class="pre">AssertionError</span></tt> will be raised if one of them cannot be parsed.</font></p>
<p><font id="373">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertXMLEqual">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertXMLEqual</tt>(<em>xml1</em>, <em>xml2</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertXMLEqual" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="374">Asserts that the strings <tt class="docutils literal"><span class="pre">xml1</span></tt> and <tt class="docutils literal"><span class="pre">xml2</span></tt> are equal. </font><font id="375">The comparison is based on XML semantics. </font><font id="376">Similarly to <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertHTMLEqual" title="django.test.SimpleTestCase.assertHTMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assertHTMLEqual()</span></tt></a>, the comparison is made on parsed content, hence only semantic differences are considered, not syntax differences. </font><font id="377">When invalid XML is passed in any parameter, an <tt class="docutils literal"><span class="pre">AssertionError</span></tt> is always raised, even if both string are identical.</font></p>
<p><font id="378">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertXMLNotEqual">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertXMLNotEqual</tt>(<em>xml1</em>, <em>xml2</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertXMLNotEqual" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="379">Asserts that the strings <tt class="docutils literal"><span class="pre">xml1</span></tt> and <tt class="docutils literal"><span class="pre">xml2</span></tt> are <em>not</em> equal. </font><font id="380">The comparison is based on XML semantics. </font><font id="381">See <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertXMLEqual" title="django.test.SimpleTestCase.assertXMLEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assertXMLEqual()</span></tt></a> for details.</font></p>
<p><font id="382">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertInHTML">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertInHTML</tt>(<em>needle</em>, <em>haystack</em>, <em>count=None</em>, <em>msg_prefix=''</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertInHTML" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="383">Asserts that the HTML fragment <tt class="docutils literal"><span class="pre">needle</span></tt> is contained in the <tt class="docutils literal"><span class="pre">haystack</span></tt> one.</font></p>
<p><font id="384">If the <tt class="docutils literal"><span class="pre">count</span></tt> integer argument is specified, then additionally the number of <tt class="docutils literal"><span class="pre">needle</span></tt> occurrences will be strictly verified.</font></p>
<p><font id="385">Whitespace in most cases is ignored, and attribute ordering is not significant. </font><font id="386">The passed-in arguments must be valid HTML.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertJSONEqual">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertJSONEqual</tt>(<em>raw</em>, <em>expected_data</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertJSONEqual" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="387">Asserts that the JSON fragments <tt class="docutils literal"><span class="pre">raw</span></tt> and <tt class="docutils literal"><span class="pre">expected_data</span></tt> are equal. </font><font id="388">Usual JSON non-significant whitespace rules apply as the heavyweight is delegated to the <a class="reference external" href="https://docs.python.org/3/library/json.html#module-json" title="(in Python v3.4)"><tt class="xref py py-mod docutils literal"><span class="pre">json</span></tt></a> library.</font></p>
<p><font id="389">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.SimpleTestCase.assertJSONNotEqual">
<tt class="descclassname">SimpleTestCase.</tt><tt class="descname">assertJSONNotEqual</tt>(<em>raw</em>, <em>expected_data</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.SimpleTestCase.assertJSONNotEqual" title="Permalink to this definition">¶</a></dt>
<dd><div class="versionadded">
<span class="title">New in Django 1.8.</span> </div>
<p><font id="390">Asserts that the JSON fragments <tt class="docutils literal"><span class="pre">raw</span></tt> and <tt class="docutils literal"><span class="pre">expected_data</span></tt> are <em>not</em> equal. </font><font id="391">See <a class="reference internal" href="tools.html#django.test.SimpleTestCase.assertJSONEqual" title="django.test.SimpleTestCase.assertJSONEqual"><tt class="xref py py-meth docutils literal"><span class="pre">assertJSONEqual()</span></tt></a> for further details.</font></p>
<p><font id="392">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
</dd></dl>
<dl class="method">
<dt id="django.test.TransactionTestCase.assertQuerysetEqual">
<tt class="descclassname">TransactionTestCase.</tt><tt class="descname">assertQuerysetEqual</tt>(<em>qs</em>, <em>values</em>, <em>transform=repr</em>, <em>ordered=True</em>, <em>msg=None</em>)<a class="headerlink" href="tools.html#django.test.TransactionTestCase.assertQuerysetEqual" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="393">Asserts that a queryset <tt class="docutils literal"><span class="pre">qs</span></tt> returns a particular list of values <tt class="docutils literal"><span class="pre">values</span></tt>.</font></p>
<p><font id="394">The comparison of the contents of <tt class="docutils literal"><span class="pre">qs</span></tt> and <tt class="docutils literal"><span class="pre">values</span></tt> is performed using the function <tt class="docutils literal"><span class="pre">transform</span></tt>; </font><font id="395">by default, this means that the <tt class="docutils literal"><span class="pre">repr()</span></tt> of each value is compared. </font><font id="396">Any other callable can be used if <tt class="docutils literal"><span class="pre">repr()</span></tt> doesn’t provide a unique or helpful comparison.</font></p>
<p><font id="397">By default, the comparison is also ordering dependent. </font><font id="398">If <tt class="docutils literal"><span class="pre">qs</span></tt> doesn’t provide an implicit ordering, you can set the <tt class="docutils literal"><span class="pre">ordered</span></tt> parameter to <tt class="docutils literal"><span class="pre">False</span></tt>, which turns the comparison into a <tt class="docutils literal"><span class="pre">collections.</span></tt></font><font id="399">Counter comparison. </font><font id="400">If the order is undefined (if the given <tt class="docutils literal"><span class="pre">qs</span></tt> isn’t ordered and the comparison is against more than one ordered values), a <tt class="docutils literal"><span class="pre">ValueError</span></tt> is raised.</font></p>
<p><font id="401">Output in case of error can be customized with the <tt class="docutils literal"><span class="pre">msg</span></tt> argument.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="402">The method now accepts a <tt class="docutils literal"><span class="pre">msg</span></tt> parameter to allow customization of error message</font></p>
</div>
</dd></dl>
<dl class="method">
<dt id="django.test.TransactionTestCase.assertNumQueries">
<tt class="descclassname">TransactionTestCase.</tt><tt class="descname">assertNumQueries</tt>(<em>num</em>, <em>func</em>, <em>*args</em>, <em>**kwargs</em>)<a class="headerlink" href="tools.html#django.test.TransactionTestCase.assertNumQueries" title="Permalink to this definition">¶</a></dt>
<dd><p><font id="403">Asserts that when <tt class="docutils literal"><span class="pre">func</span></tt> is called with <tt class="docutils literal"><span class="pre">*args</span></tt> and <tt class="docutils literal"><span class="pre">**kwargs</span></tt> that <tt class="docutils literal"><span class="pre">num</span></tt> database queries are executed.</font></p>
<p><font id="404">If a <tt class="docutils literal"><span class="pre">"using"</span></tt> key is present in <tt class="docutils literal"><span class="pre">kwargs</span></tt> it is used as the database alias for which to check the number of queries. </font><font id="554">If you wish to call a function with a <tt class="docutils literal"><span class="pre">using</span></tt> parameter you can do it by wrapping the call with a <tt class="docutils literal"><span class="pre">lambda</span></tt> to add an extra parameter:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">assertNumQueries</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">my_function</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
<p><font id="405">You can also use this as a context manager:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertNumQueries</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">Person</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Aaron"</span><span class="p">)</span>
    <span class="n">Person</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Daniel"</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>
</div>
</div>
<div class="section" id="s-email-services">
<span id="s-topics-testing-email"></span><span id="email-services"></span><span id="topics-testing-email"></span><h2><font id="444">Email services</font><a class="headerlink" href="tools.html#email-services" title="Permalink to this headline">¶</a></h2>
<p><font id="406">If any of your Django views send email using <a class="reference internal" href="../email.html"><em>Django’s email functionality</em></a>, you probably don’t want to send email each time you run a test using that view. </font><font id="407">For this reason, Django’s test runner automatically redirects all Django-sent email to a dummy outbox. </font><font id="408">This lets you test every aspect of sending email – from the number of messages sent to the contents of each message – without actually sending the messages.</font></p>
<p><font id="409">The test runner accomplishes this by transparently replacing the normal email backend with a testing backend. </font><font id="410">(Don’t worry – this has no effect on any other email senders outside of Django, such as your machine’s mail server, if you’re running one.)</font></p>
<dl class="data">
<dt id="django.core.mail.django.core.mail.outbox">
<tt class="descclassname">django.core.mail.</tt><tt class="descname">outbox</tt><a class="headerlink" href="tools.html#django.core.mail.django.core.mail.outbox" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="411">During test running, each outgoing email is saved in <tt class="docutils literal"><span class="pre">django.core.mail.outbox</span></tt>. </font><font id="412">This is a simple list of all <a class="reference internal" href="../email.html#django.core.mail.EmailMessage" title="django.core.mail.EmailMessage"><tt class="xref py py-class docutils literal"><span class="pre">EmailMessage</span></tt></a> instances that have been sent. </font><font id="413">The <tt class="docutils literal"><span class="pre">outbox</span></tt> attribute is a special attribute that is created <em>only</em> when the <tt class="docutils literal"><span class="pre">locmem</span></tt> email backend is used. </font><font id="414">It doesn’t normally exist as part of the <a class="reference internal" href="../email.html#module-django.core.mail" title="django.core.mail: Helpers to easily send email."><tt class="xref py py-mod docutils literal"><span class="pre">django.core.mail</span></tt></a> module and you can’t import it directly. </font><font id="415">The code below shows how to access this attribute correctly.</font></p>
<p><font id="416">Here’s an example test that examines <tt class="docutils literal"><span class="pre">django.core.mail.outbox</span></tt> for length and contents:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core</span> <span class="kn">import</span> <span class="n">mail</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">EmailTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_send_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># Send message.</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">send_mail</span><span class="p">(</span><span class="s">'Subject here'</span><span class="p">,</span> <span class="s">'Here is the message.'</span><span class="p">,</span>
            <span class="s">'from@example.com'</span><span class="p">,</span> <span class="p">[</span><span class="s">'to@example.com'</span><span class="p">],</span>
            <span class="n">fail_silently</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="c"># Test that one message has been sent.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mail</span><span class="o">.</span><span class="n">outbox</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c"># Verify that the subject of the first message is correct.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">mail</span><span class="o">.</span><span class="n">outbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subject</span><span class="p">,</span> <span class="s">'Subject here'</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="417">As noted <a class="reference internal" href="tools.html#emptying-test-outbox"><em>previously</em></a>, the test outbox is emptied at the start of every test in a Django <tt class="docutils literal"><span class="pre">*TestCase</span></tt>. </font><font id="418">To empty the outbox manually, assign the empty list to <tt class="docutils literal"><span class="pre">mail.outbox</span></tt>:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core</span> <span class="kn">import</span> <span class="n">mail</span>

<span class="c"># Empty the test outbox</span>
<span class="n">mail</span><span class="o">.</span><span class="n">outbox</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="s-management-commands">
<span id="s-topics-testing-management-commands"></span><span id="management-commands"></span><span id="topics-testing-management-commands"></span><h2><font id="445">Management Commands</font><a class="headerlink" href="tools.html#management-commands" title="Permalink to this headline">¶</a></h2>
<p><font id="419">Management commands can be tested with the <a class="reference internal" href="../../ref/django-admin.html#django.core.management.call_command" title="django.core.management.call_command"><tt class="xref py py-func docutils literal"><span class="pre">call_command()</span></tt></a> function. </font><font id="420">The output can be redirected into a <tt class="docutils literal"><span class="pre">StringIO</span></tt> instance:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core.management</span> <span class="kn">import</span> <span class="n">call_command</span>
<span class="kn">from</span> <span class="nn">django.test</span> <span class="kn">import</span> <span class="n">TestCase</span>
<span class="kn">from</span> <span class="nn">django.utils.six</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="k">class</span> <span class="nc">ClosepollTest</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_command_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="n">call_command</span><span class="p">(</span><span class="s">'closepoll'</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">out</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">'Expected output'</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">getvalue</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="s-skipping-tests">
<span id="s-id3"></span><span id="skipping-tests"></span><span id="id3"></span><h2><font id="446">Skipping tests</font><a class="headerlink" href="tools.html#skipping-tests" title="Permalink to this headline">¶</a></h2>
<p><font id="421">The unittest library provides the <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.skipIf" title="(in Python v3.4)"><tt class="xref py py-func docutils literal"><span class="pre">@skipIf</span></tt></a> and <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.skipUnless" title="(in Python v3.4)"><tt class="xref py py-func docutils literal"><span class="pre">@skipUnless</span></tt></a> decorators to allow you to skip tests if you know ahead of time that those tests are going to fail under certain conditions.</font></p>
<p><font id="422">For example, if your test requires a particular optional library in order to succeed, you could decorate the test case with <a class="reference external" href="https://docs.python.org/3/library/unittest.html#unittest.skipIf" title="(in Python v3.4)"><tt class="xref py py-func docutils literal"><span class="pre">@skipIf</span></tt></a>. </font><font id="423">Then, the test runner will report that the test wasn’t executed and why, instead of failing the test or omitting the test altogether.</font></p>
<p><font id="424">To supplement these test skipping behaviors, Django provides two additional skip decorators. </font><font id="425">Instead of testing a generic boolean, these decorators check the capabilities of the database, and skip the test if the database doesn’t support a specific named feature.</font></p>
<p><font id="426">The decorators use a string identifier to describe database features. </font><font id="427">This string corresponds to attributes of the database connection features class. </font><font id="428">See <tt class="docutils literal"><span class="pre">django.db.backends.BaseDatabaseFeatures</span></tt> class for a full list of database features that can be used as a basis for skipping tests.</font></p>
<dl class="function">
<dt id="django.test.skipIfDBFeature">
<tt class="descname">skipIfDBFeature</tt>(<em>*feature_name_strings</em>)<a class="headerlink" href="tools.html#django.test.skipIfDBFeature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="429">Skip the decorated test or <tt class="docutils literal"><span class="pre">TestCase</span></tt> if all of the named database features are supported.</font></p>
<p><font id="430">For example, the following test will not be executed if the database supports transactions (e.g., it would <em>not</em> run under PostgreSQL, but it would under MySQL with MyISAM tables):</font></p>
<div class="highlight-python"><div class="highlight"><pre>class MyTests(TestCase):
    @skipIfDBFeature('supports_transactions')
    def test_transaction_behavior(self):
        # ... conditional test code
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="431"><tt class="docutils literal"><span class="pre">skipIfDBFeature</span></tt> can now be used to decorate a <tt class="docutils literal"><span class="pre">TestCase</span></tt> class.</font></p>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.8:</span> <p><font id="432"><tt class="docutils literal"><span class="pre">skipIfDBFeature</span></tt> can accept multiple feature strings.</font></p>
</div>
<dl class="function">
<dt id="django.test.skipUnlessDBFeature">
<tt class="descname">skipUnlessDBFeature</tt>(<em>*feature_name_strings</em>)<a class="headerlink" href="tools.html#django.test.skipUnlessDBFeature" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="433">Skip the decorated test or <tt class="docutils literal"><span class="pre">TestCase</span></tt> if any of the named database features are <em>not</em> supported.</font></p>
<p><font id="434">For example, the following test will only be executed if the database supports transactions (e.g., it would run under PostgreSQL, but <em>not</em> under MySQL with MyISAM tables):</font></p>
<div class="highlight-python"><div class="highlight"><pre>class MyTests(TestCase):
    @skipUnlessDBFeature('supports_transactions')
    def test_transaction_behavior(self):
        # ... conditional test code
</pre></div>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="435"><tt class="docutils literal"><span class="pre">skipUnlessDBFeature</span></tt> can now be used to decorate a <tt class="docutils literal"><span class="pre">TestCase</span></tt> class.</font></p>
</div>
<div class="versionchanged">
<span class="title">Changed in Django 1.8:</span> <p><font id="436"><tt class="docutils literal"><span class="pre">skipUnlessDBFeature</span></tt> can accept multiple feature strings.</font></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="yui-b" id="sidebar">
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h3><font id="465">Table Of Contents</font></h3>
<ul>
<li><a class="reference internal" href="tools.html#"><font id="520">Testing tools</font></a><ul>
<li><a class="reference internal" href="tools.html#the-test-client"><font id="521">The test client</font></a><ul>
<li><a class="reference internal" href="tools.html#overview-and-a-quick-example"><font id="522">Overview and a quick example</font></a></li>
<li><a class="reference internal" href="tools.html#making-requests"><font id="523">Making requests</font></a></li>
<li><a class="reference internal" href="tools.html#testing-responses"><font id="524">Testing responses</font></a></li>
<li><a class="reference internal" href="tools.html#exceptions"><font id="525">Exceptions</font></a></li>
<li><a class="reference internal" href="tools.html#persistent-state"><font id="526">Persistent state</font></a></li>
<li><a class="reference internal" href="tools.html#example"><font id="527">Example</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="tools.html#provided-test-case-classes"><font id="528">Provided test case classes</font></a><ul>
<li><a class="reference internal" href="tools.html#simpletestcase"><font id="529">SimpleTestCase</font></a></li>
<li><a class="reference internal" href="tools.html#transactiontestcase"><font id="530">TransactionTestCase</font></a></li>
<li><a class="reference internal" href="tools.html#testcase"><font id="531">TestCase</font></a></li>
<li><a class="reference internal" href="tools.html#liveservertestcase"><font id="532">LiveServerTestCase</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="tools.html#test-cases-features"><font id="533">Test cases features</font></a><ul>
<li><a class="reference internal" href="tools.html#default-test-client"><font id="534">Default test client</font></a></li>
<li><a class="reference internal" href="tools.html#customizing-the-test-client"><font id="535">Customizing the test client</font></a></li>
<li><a class="reference internal" href="tools.html#fixture-loading"><font id="536">Fixture loading</font></a></li>
<li><a class="reference internal" href="tools.html#urlconf-configuration"><font id="537">URLconf configuration</font></a></li>
<li><a class="reference internal" href="tools.html#multi-database-support"><font id="538">Multi-database support</font></a></li>
<li><a class="reference internal" href="tools.html#overriding-settings"><font id="539">Overriding settings</font></a></li>
<li><a class="reference internal" href="tools.html#emptying-the-test-outbox"><font id="540">Emptying the test outbox</font></a></li>
<li><a class="reference internal" href="tools.html#assertions"><font id="541">Assertions</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="tools.html#email-services"><font id="542">Email services</font></a></li>
<li><a class="reference internal" href="tools.html#management-commands"><font id="543">Management Commands</font></a></li>
<li><a class="reference internal" href="tools.html#skipping-tests"><font id="544">Skipping tests</font></a></li>
</ul>
</li>
</ul>
<h3><font id="466">Browse</font></h3>
<ul>
<li><font id="545">Prev: <a href="overview.html">Writing and running tests</a></font></li>
<li><font id="546">Next: <a href="advanced.html">Advanced testing topics</a></font></li>
</ul>
<h3><font id="467">You are here:</font></h3>
<ul>
<li>
<a href="../../index.html"><font id="547">Django 1.8.2.dev20150513143415 documentation</font></a>
<ul><li><a href="../index.html"><font id="548">Using Django</font></a>
<ul><li><a href="index.html"><font id="549">Testing in Django</font></a>
<ul><li><font id="550">Testing tools</font></li></ul>
</li></ul></li></ul>
</li>
</ul>
<h3><font id="468">This Page</font></h3>
<ul class="this-page-menu">
<li><a href="http://python.usyiyi.cn/django/_sources/topics/testing/tools.txt" rel="nofollow"><font id="551">Show Source</font></a></li>
</ul>
<div id="searchbox" style="display: none">
<h3><font id="469">Quick search</font></h3>
<form action="http://python.usyiyi.cn/django/search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%"><font id="437"> Enter search terms or a module, class or function name. </font></p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<h3><font id="470">Last update:</font></h3>
<p class="topless"><font id="438">May 13, 2015</font></p>
</div>
</div>
<div id="ft">
<div class="nav">
    « <a href="overview.html" title="Writing and running tests">previous</a>
     |
    <a accesskey="U" href="../index.html" title="Using Django">up</a>
   |
    <a href="advanced.html" title="Advanced testing topics">next</a> »</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div id="disqus_thread"></div><br>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'djangocn'; // required: replace example with your forum shortname
    var disqus_identifier = '/django/topics/testing/tools.html';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="http://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<link href="http://python.usyiyi.cn/django/_static/ms_translator.css" rel="stylesheet" type="text/css"/>
<script src="http://python.usyiyi.cn/django/_static/ms_translator.js" type="text/javascript"></script>
<script src="http://python.usyiyi.cn/django/_static/jquery-ui-1.9.2.custom.min.js" type="text/javascript"></script>
<div id="MicrosoftTranslator" style="display:none; position: absolute; z-index: 2147483647; margin: 0px; border: 2px solid rgb(210, 210, 210); padding: 0px; color: rgb(0, 0, 0); background-color: rgb(230, 230, 230); font-family: Arial,Helvetica,Sans-Serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 12px; line-height: normal; direction: ltr; text-align: left; left: 274px; top: 2048.03px; min-width: 400px;">
    <div id="MSTCClose" style="float: right;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/tooltip_close.gif">
      </a>
    </div>
    
    <div id="MSTCPopDown" style="float: right;" style="display: none;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/popdown.gif">
      </a>
    </div>
    <div id="MSTCPopUP" style="float: right;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/popup.gif">
      </a>
    </div>
    
    <div id="MSTCTitle" style="margin: 4px 4px 8px; font-weight: bold;">原文
    </div>
    
    <div style="direction: ltr; text-align: left;">
      <span id="MSTCOrigion" style="display: inline-block; margin: 0px 4px 4px;"> </span>
    </div>
    
    <div id="MicrosoftTranslatorCommunity" class="MSTCltr">
      <div id="MSTCContent">
        <a id="MSTCExpandLink">
          <span id="MSTCImprove">改进翻译</span>
          <span id="MSTCSuggest">最小化</span>
          <img src="http://python.usyiyi.cn/django/_static/ctftoggledown.gif" id="MSTCToggleDown">
          <img src="http://python.usyiyi.cn/django/_static/ctftoggleup.gif" id="MSTCToggleUp">
        </a>
        <div id="MSTCRootPanel">
          <span id="MSTCLoading" style="display: none;">正在加载...</span>
          <div style="display: none;" id="MSTCTransPanelError">
            <div class="MSTCTableRow">
              <div class="MSTCTransPanelExc MSTCTableCell">
                <img style="border-width:0px;" src="http://python.usyiyi.cn/django/_static/error_exclamation.gif" id="ExclamationImage">
              </div>
              <div class="MSTCTableCell">
                <span id="MSTCTransPanelErrorMsg"></span>
              </div>
            </div>
            <div class="MSTCTableRow">
              <div class="MSTCTableCell"></div>
              <div class="MSTCTableCell MSTCFlipHoriz">
                <input type="image" style="border-width:0px;" src="http://python.usyiyi.cn/django/_static/error_OK.gif" class="MSTCErrorButtons" id="MSTCOKImgBtn" name="MSTCOKImgBtn">
              </div>
            </div>
          </div>
          
          <div id="MSTCTransPanel">
          </div>
          
          <div id="MSTCPrevNextPanel">
            <a id="MSTCPrevLink" style='border-right-width: 1px;border-right-style: solid;padding-right: 5px;'>
              <span>上一页</span>
            </a>
            <a style='color: black; border-right-width: 1px;border-right-style: solid;padding-right: 5px;'>
              <span>第</span>
              <span id="MSTCPage"></span>
              <span>页</span>
            </a>
            <a id="MSTCNextLink" style='padding-left: 5px;'>
              <span>下一页</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>