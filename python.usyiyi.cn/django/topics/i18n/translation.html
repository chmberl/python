<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>翻译 — Django 1.8.2 中文文档</title>
<link href="../../_static/default.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.8.2.dev20150513143415',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
<script src="../../_static/jquery.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<link href="../../index.html" rel="top" title="Django 1.8.2.dev20150513143415 documentation"/>
<link href="index.html" rel="up" title="Internationalization and localization"/>
<link href="formatting.html" rel="next" title="Format localization"/>
<link href="index.html" rel="prev" title="Internationalization and localization"/>
<script src="http://python.usyiyi.cn/django/templatebuiltins.js" type="text/javascript"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='http://python.usyiyi.cn/django/topics/i18n/&quot;&#32;+&#32;base&#32;+&#32;&quot;#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='http://python.usyiyi.cn/django/topics/i18n/&quot;&#32;+&#32;base&#32;+&#32;&quot;#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);
</script>
</head>
<body>
<div class="document">
<div class="yui-t6" id="custom-doc">
<div id="hd">
<h1><font id="422">Django 1.8.2.dev20150513143415 documentation</font></h1>
<div id="global-nav">
<a href="../../index.html" title="Home page">Home</a>  |
        <a href="../../contents.html" title="Table of contents">Table of contents</a>  |
        <a href="../../genindex.html" title="Global index">Index</a>  |
        <a href="../../py-modindex.html" title="Module index">Modules</a>
</div>
<div class="nav">
    « <a href="index.html" title="Internationalization and localization">previous</a>
     |
    <a accesskey="U" href="../index.html" title="Using Django">up</a>
   |
    <a href="formatting.html" title="Format localization">next</a> »</div>
</div>
<div id="bd">
<div id="yui-main">
<div class="yui-b">
<div class="yui-g" id="topics-i18n-translation">
<div class="section" id="s-module-django.utils.translation">
<span id="s-translation"></span><span id="module-django.utils.translation"></span><span id="translation"></span><h1><font id="423">Translation</font><a class="headerlink" href="translation.html#module-django.utils.translation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="s-overview">
<span id="overview"></span><h2><font id="424">概述</font><a class="headerlink" href="translation.html#overview" title="Permalink to this headline">¶</a></h2>
<p><font id="1">为了让Django项目可翻译,你必须最小数量的钩子添加到您的Python代码和模板中。
</font><font id="2">These hooks are called <a class="reference internal" href="index.html#term-translation-string"><em class="xref std std-term">translation strings</em></a>. </font><font id="3">They tell Django: “This text should be translated into the end user’s language, if a translation for this text is available in that language.” </font><font id="4">It’s your responsibility to mark translatable strings; </font><font id="5">the system can only translate strings it knows about.</font></p>
<p><font id="6">Django then provides utilities to extract the translation strings into a <a class="reference internal" href="index.html#term-message-file"><em class="xref std std-term">message file</em></a>. </font><font id="7">This file is a convenient way for translators to provide the equivalent of the translation strings in the target language. </font><font id="8">Once the translators have filled in the message file, it must be compiled. </font><font id="9">This process relies on the GNU gettext toolset.</font></p>
<p><font id="10">Once this is done, Django takes care of translating Web apps on the fly in each available language, according to users’ language preferences.</font></p>
<p><font id="11">Django’s internationalization hooks are on by default, and that means there’s a bit of i18n-related overhead in certain places of the framework. </font><font id="12">If you don’t use internationalization, you should take the two seconds to set <a class="reference internal" href="../../ref/settings.html#std:setting-USE_I18N"><tt class="xref std std-setting docutils literal"><span class="pre">USE_I18N</span> <span class="pre">=</span> <span class="pre">False</span></tt></a> in your settings file. </font><font id="13">Then Django will make some optimizations so as not to load the internationalization machinery.</font></p>
<div class="admonition note">
<p class="first admonition-title"><font id="14">Note</font></p>
<p class="last"><font id="15">There is also an independent but related <a class="reference internal" href="../../ref/settings.html#std:setting-USE_L10N"><tt class="xref std std-setting docutils literal"><span class="pre">USE_L10N</span></tt></a> setting that controls if Django should implement format localization. </font><font id="16">See <a class="reference internal" href="formatting.html"><em>Format localization</em></a> for more details.</font></p>
</div>
<div class="admonition note">
<p class="first admonition-title"><font id="17">Note</font></p>
<p class="last"><font id="18">Make sure you’ve activated translation for your project (the fastest way is to check if <a class="reference internal" href="../../ref/settings.html#std:setting-MIDDLEWARE_CLASSES"><tt class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></tt></a> includes <a class="reference internal" href="../../ref/middleware.html#django.middleware.locale.LocaleMiddleware" title="django.middleware.locale.LocaleMiddleware"><tt class="xref py py-mod docutils literal"><span class="pre">django.middleware.locale.LocaleMiddleware</span></tt></a>). </font><font id="19">If you haven’t yet, see <a class="reference internal" href="translation.html#how-django-discovers-language-preference"><em>How Django discovers language preference</em></a>.</font></p>
</div>
</div>
<div class="section" id="s-internationalization-in-python-code">
<span id="internationalization-in-python-code"></span><h2><font id="425">Internationalization: in Python code</font><a class="headerlink" href="translation.html#internationalization-in-python-code" title="Permalink to this headline">¶</a></h2>
<div class="section" id="s-standard-translation">
<span id="standard-translation"></span><h3><font id="432">Standard translation</font><a class="headerlink" href="translation.html#standard-translation" title="Permalink to this headline">¶</a></h3>
<p><font id="20">Specify a translation string by using the function <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext" title="django.utils.translation.ugettext"><tt class="xref py py-func docutils literal"><span class="pre">ugettext()</span></tt></a>. </font><font id="21">It’s convention to import this as a shorter alias, <tt class="docutils literal"><span class="pre">_</span></tt>, to save typing.</font></p>
<div class="admonition note">
<p class="first admonition-title"><font id="22">Note</font></p>
<p><font id="23">Python’s standard library <tt class="docutils literal"><span class="pre">gettext</span></tt> module installs <tt class="docutils literal"><span class="pre">_()</span></tt> into the global namespace, as an alias for <tt class="docutils literal"><span class="pre">gettext()</span></tt>. </font><font id="24">In Django, we have chosen not to follow this practice, for a couple of reasons:</font></p>
<ol class="last arabic simple">
<li><font id="484">For international character set (Unicode) support, <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext" title="django.utils.translation.ugettext"><tt class="xref py py-func docutils literal"><span class="pre">ugettext()</span></tt></a> is more useful than <tt class="docutils literal"><span class="pre">gettext()</span></tt>. </font><font id="485">Sometimes, you should be using <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext_lazy" title="django.utils.translation.ugettext_lazy"><tt class="xref py py-func docutils literal"><span class="pre">ugettext_lazy()</span></tt></a> as the default translation method for a particular file. </font><font id="486">Without <tt class="docutils literal"><span class="pre">_()</span></tt> in the global namespace, the developer has to think about which is the most appropriate translation function.</font></li>
<li><font id="487">The underscore character (<tt class="docutils literal"><span class="pre">_</span></tt>) is used to represent “the previous result” in Python’s interactive shell and doctest tests. </font><font id="488">Installing a global <tt class="docutils literal"><span class="pre">_()</span></tt> function causes interference. </font><font id="489">Explicitly importing <tt class="docutils literal"><span class="pre">ugettext()</span></tt> as <tt class="docutils literal"><span class="pre">_()</span></tt> avoids this problem.</font></li>
</ol>
</div>
<p><font id="25">In this example, the text <tt class="docutils literal"><span class="pre">"Welcome</span> <span class="pre">to</span> <span class="pre">my</span> <span class="pre">site."</span></tt> is marked as a translation string:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">"Welcome to my site."</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="26">Obviously, you could code this without using the alias. </font><font id="27">This example is identical to the previous one:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">ugettext</span><span class="p">(</span><span class="s">"Welcome to my site."</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="28">Translation works on computed values. </font><font id="29">This example is identical to the previous two:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Welcome'</span><span class="p">,</span> <span class="s">'to'</span><span class="p">,</span> <span class="s">'my'</span><span class="p">,</span> <span class="s">'site.'</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="30">Translation works on variables. </font><font id="31">Again, here’s an identical example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">sentence</span> <span class="o">=</span> <span class="s">'Welcome to my site.'</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="32">(The caveat with using variables or computed values, as in the previous two examples, is that Django’s translation-string-detecting utility, <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a>, won’t be able to find these strings. </font><font id="33">More on <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a> later.)</font></p>
<p><font id="34">The strings you pass to <tt class="docutils literal"><span class="pre">_()</span></tt> or <tt class="docutils literal"><span class="pre">ugettext()</span></tt> can take placeholders, specified with Python’s standard named-string interpolation syntax. </font><font id="35">Example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">'Today is </span><span class="si">%(month)s</span><span class="s"> </span><span class="si">%(day)s</span><span class="s">.'</span><span class="p">)</span> <span class="o">%</span> <span class="p">{</span><span class="s">'month'</span><span class="p">:</span> <span class="n">m</span><span class="p">,</span> <span class="s">'day'</span><span class="p">:</span> <span class="n">d</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="36">This technique lets language-specific translations reorder the placeholder text. </font><font id="636">For example, an English translation may be <tt class="docutils literal"><span class="pre">"Today</span> <span class="pre">is</span> <span class="pre">November</span> <span class="pre">26."</span></tt>, while a Spanish translation may be <tt class="docutils literal"><span class="pre">"Hoy</span> <span class="pre">es</span> <span class="pre">26</span> <span class="pre">de</span> <span class="pre">Noviembre."</span></tt> – with the month and the day placeholders swapped.</font></p>
<p><font id="37">For this reason, you should use named-string interpolation (e.g., <tt class="docutils literal"><span class="pre">%(day)s</span></tt>) instead of positional interpolation (e.g., <tt class="docutils literal"><span class="pre">%s</span></tt> or <tt class="docutils literal"><span class="pre">%d</span></tt>) whenever you have more than a single parameter. </font><font id="38">If you used positional interpolation, translations wouldn’t be able to reorder placeholder text.</font></p>
</div>
<div class="section" id="s-comments-for-translators">
<span id="s-translator-comments"></span><span id="comments-for-translators"></span><span id="translator-comments"></span><h3><font id="433">Comments for translators</font><a class="headerlink" href="translation.html#comments-for-translators" title="Permalink to this headline">¶</a></h3>
<p><font id="39">If you would like to give translators hints about a translatable string, you can add a comment prefixed with the <tt class="docutils literal"><span class="pre">Translators</span></tt> keyword on the line preceding the string, e.g.:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c"># Translators: This message appears on the home page only</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">ugettext</span><span class="p">(</span><span class="s">"Welcome to my site."</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="40">The comment will then appear in the resulting <tt class="docutils literal"><span class="pre">.po</span></tt> file associated with the translatable construct located below it and should also be displayed by most translation tools.</font></p>
<div class="admonition note">
<p class="first admonition-title"><font id="41">Note</font></p>
<p><font id="42">Just for completeness, this is the corresponding fragment of the resulting <tt class="docutils literal"><span class="pre">.po</span></tt> file:</font></p>
<div class="last highlight-po"><div class="highlight"><pre><span class="c1">#. Translators: This message appears on the home page only</span>
<span class="c1"># path/to/python/file.py:123</span>
<span class="nv">msgid</span> <span class="s">"Welcome to my site."</span>
<span class="nv">msgstr</span> <span class="s">""</span>
</pre></div>
</div>
</div>
<p><font id="43">This also works in templates. </font><font id="44">See <a class="reference internal" href="translation.html#translator-comments-in-templates"><em>Comments for translators in templates</em></a> for more details.</font></p>
</div>
<div class="section" id="s-marking-strings-as-no-op">
<span id="marking-strings-as-no-op"></span><h3><font id="434">Marking strings as no-op</font><a class="headerlink" href="translation.html#marking-strings-as-no-op" title="Permalink to this headline">¶</a></h3>
<p><font id="45">Use the function <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext_noop" title="django.utils.translation.ugettext_noop"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.ugettext_noop()</span></tt></a> to mark a string as a translation string without translating it. </font><font id="46">The string is later translated from a variable.</font></p>
<p><font id="47">Use this if you have constant strings that should be stored in the source language because they are exchanged over systems or users – such as strings in a database – but should be translated at the last possible point in time, such as when the string is presented to the user.</font></p>
</div>
<div class="section" id="s-pluralization">
<span id="pluralization"></span><h3><font id="435">Pluralization</font><a class="headerlink" href="translation.html#pluralization" title="Permalink to this headline">¶</a></h3>
<p><font id="48">Use the function <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ungettext" title="django.utils.translation.ungettext"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.ungettext()</span></tt></a> to specify pluralized messages.</font></p>
<p><font id="49"><tt class="docutils literal"><span class="pre">ungettext</span></tt> takes three arguments: the singular translation string, the plural translation string and the number of objects.</font></p>
<p><font id="50">This function is useful when you need your Django application to be localizable to languages where the number and complexity of <a class="reference external" href="http://www.gnu.org/software/gettext/manual/gettext.html#Plural-forms">plural forms</a> is greater than the two forms used in English (‘object’ for the singular and ‘objects’ for all the cases where <tt class="docutils literal"><span class="pre">count</span></tt> is different from one, irrespective of its value.)</font></p>
<p><font id="51">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ungettext</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">ungettext</span><span class="p">(</span>
        <span class="s">'there is </span><span class="si">%(count)d</span><span class="s"> object'</span><span class="p">,</span>
        <span class="s">'there are </span><span class="si">%(count)d</span><span class="s"> objects'</span><span class="p">,</span>
    <span class="n">count</span><span class="p">)</span> <span class="o">%</span> <span class="p">{</span>
        <span class="s">'count'</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="52">In this example the number of objects is passed to the translation languages as the <tt class="docutils literal"><span class="pre">count</span></tt> variable.</font></p>
<p><font id="53">Note that pluralization is complicated and works differently in each language. </font><font id="54">Comparing <tt class="docutils literal"><span class="pre">count</span></tt> to 1 isn’t always the correct rule. </font><font id="55">This code looks sophisticated, but will produce incorrect results for some languages:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ungettext</span>
<span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">Report</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">Report</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Report</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">verbose_name</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Report</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">verbose_name_plural</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">ungettext</span><span class="p">(</span>
    <span class="s">'There is </span><span class="si">%(count)d</span><span class="s"> </span><span class="si">%(name)s</span><span class="s"> available.'</span><span class="p">,</span>
    <span class="s">'There are </span><span class="si">%(count)d</span><span class="s"> </span><span class="si">%(name)s</span><span class="s"> available.'</span><span class="p">,</span>
    <span class="n">count</span>
<span class="p">)</span> <span class="o">%</span> <span class="p">{</span>
    <span class="s">'count'</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="n">name</span>
<span class="p">}</span>
</pre></div>
</div>
<p><font id="56">Don’t try to implement your own singular-or-plural logic, it won’t be correct. </font><font id="57">In a case like this, consider something like the following:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">text</span> <span class="o">=</span> <span class="n">ungettext</span><span class="p">(</span>
    <span class="s">'There is </span><span class="si">%(count)d</span><span class="s"> </span><span class="si">%(name)s</span><span class="s"> object available.'</span><span class="p">,</span>
    <span class="s">'There are </span><span class="si">%(count)d</span><span class="s"> </span><span class="si">%(name)s</span><span class="s"> objects available.'</span><span class="p">,</span>
    <span class="n">count</span>
<span class="p">)</span> <span class="o">%</span> <span class="p">{</span>
    <span class="s">'count'</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="n">Report</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note" id="pluralization-var-notes">
<p class="first admonition-title"><font id="58">Note</font></p>
<p><font id="59">When using <tt class="docutils literal"><span class="pre">ungettext()</span></tt>, make sure you use a single name for every extrapolated variable included in the literal. </font><font id="60">In the examples above, note how we used the <tt class="docutils literal"><span class="pre">name</span></tt> Python variable in both translation strings. </font><font id="61">This example, besides being incorrect in some languages as noted above, would fail:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">text</span> <span class="o">=</span> <span class="n">ungettext</span><span class="p">(</span>
    <span class="s">'There is </span><span class="si">%(count)d</span><span class="s"> </span><span class="si">%(name)s</span><span class="s"> available.'</span><span class="p">,</span>
    <span class="s">'There are </span><span class="si">%(count)d</span><span class="s"> </span><span class="si">%(plural_name)s</span><span class="s"> available.'</span><span class="p">,</span>
    <span class="n">count</span>
<span class="p">)</span> <span class="o">%</span> <span class="p">{</span>
    <span class="s">'count'</span><span class="p">:</span> <span class="n">Report</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="n">Report</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">verbose_name</span><span class="p">,</span>
    <span class="s">'plural_name'</span><span class="p">:</span> <span class="n">Report</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">verbose_name_plural</span>
<span class="p">}</span>
</pre></div>
</div>
<p><font id="62">You would get an error when running <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span></tt></a>:</font></p>
<div class="last highlight-python"><div class="highlight"><pre>a format specification for argument 'name', as in 'msgstr[0]', doesn't exist in 'msgid'
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font id="63">Note</font></p>
<p><font id="64">Plural form and po files</font></p>
<p class="last"><font id="65">Django does not support custom plural equations in po files. </font><font id="66">As all translation catalogs are merged, only the plural form for the main Django po file (in <tt class="docutils literal"><span class="pre">django/conf/locale/&lt;lang_code&gt;/LC_MESSAGES/django.po</span></tt>) is considered. </font><font id="67">Plural forms in all other po files are ignored. </font><font id="68">Therefore, you should not use different plural equations in your project or application po files.</font></p>
</div>
</div>
<div class="section" id="s-contextual-markers">
<span id="s-id1"></span><span id="contextual-markers"></span><span id="id1"></span><h3><font id="436">Contextual markers</font><a class="headerlink" href="translation.html#contextual-markers" title="Permalink to this headline">¶</a></h3>
<p><font id="69">Sometimes words have several meanings, such as <tt class="docutils literal"><span class="pre">"May"</span></tt> in English, which refers to a month name and to a verb. </font><font id="637">To enable translators to translate these words correctly in different contexts, you can use the <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.pgettext" title="django.utils.translation.pgettext"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.pgettext()</span></tt></a> function, or the <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.npgettext" title="django.utils.translation.npgettext"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.npgettext()</span></tt></a> function if the string needs pluralization. Both take a context string as the first variable.</font></p>
<p><font id="70">In the resulting <tt class="docutils literal"><span class="pre">.po</span></tt> file, the string will then appear as often as there are different contextual markers for the same string (the context will appear on the <tt class="docutils literal"><span class="pre">msgctxt</span></tt> line), allowing the translator to give a different translation for each of them.</font></p>
<p><font id="71">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">pgettext</span>

<span class="n">month</span> <span class="o">=</span> <span class="n">pgettext</span><span class="p">(</span><span class="s">"month name"</span><span class="p">,</span> <span class="s">"May"</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="72">or:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">pgettext_lazy</span>

<span class="k">class</span> <span class="nc">MyThing</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="n">pgettext_lazy</span><span class="p">(</span>
        <span class="s">'help text for MyThing model'</span><span class="p">,</span> <span class="s">'This is the help text'</span><span class="p">))</span>
</pre></div>
</div>
<p><font id="73">will appear in the <tt class="docutils literal"><span class="pre">.po</span></tt> file as:</font></p>
<div class="highlight-po"><div class="highlight"><pre>msgctxt "month name"
msgid "May"
msgstr ""
</pre></div>
</div>
<p><font id="74">Contextual markers are also supported by the <a class="reference internal" href="translation.html#std:templatetag-trans"><tt class="xref std std-ttag docutils literal"><span class="pre">trans</span></tt></a> and <a class="reference internal" href="translation.html#std:templatetag-blocktrans"><tt class="xref std std-ttag docutils literal"><span class="pre">blocktrans</span></tt></a> template tags.</font></p>
</div>
<div class="section" id="s-lazy-translation">
<span id="s-lazy-translations"></span><span id="lazy-translation"></span><span id="lazy-translations"></span><h3><font id="437">Lazy translation</font><a class="headerlink" href="translation.html#lazy-translation" title="Permalink to this headline">¶</a></h3>
<p><font id="75">Use the lazy versions of translation functions in <a class="reference internal" href="translation.html#module-django.utils.translation" title="django.utils.translation"><tt class="xref py py-mod docutils literal"><span class="pre">django.utils.translation</span></tt></a> (easily recognizable by the <tt class="docutils literal"><span class="pre">lazy</span></tt> suffix in their names) to translate strings lazily – when the value is accessed rather than when they’re called.</font></p>
<p><font id="76">These functions store a lazy reference to the string – not the actual translation. </font><font id="77">The translation itself will be done when the string is used in a string context, such as in template rendering.</font></p>
<p><font id="78">This is essential when calls to these functions are located in code paths that are executed at module load time.</font></p>
<p><font id="79">This is something that can easily happen when defining models, forms and model forms, because Django implements these such that their fields are actually class-level attributes. </font><font id="80">For that reason, make sure to use lazy translations in the following cases:</font></p>
<div class="section" id="s-model-fields-and-relationships-verbose-name-and-help-text-option-values">
<span id="model-fields-and-relationships-verbose-name-and-help-text-option-values"></span><h4><font id="470">Model fields and relationships </font><tt class="docutils literal"><span class="pre">verbose_name</span></tt></h4>
<p><font id="81">For example, to translate the help text of the <em>name</em> field in the following model, do the following:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">MyThing</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">'This is the help text'</span><span class="p">))</span>
</pre></div>
</div>
<p><font id="82">You can mark names of <a class="reference internal" href="../../ref/models/fields.html#django.db.models.ForeignKey" title="django.db.models.ForeignKey"><tt class="xref py py-class docutils literal"><span class="pre">ForeignKey</span></tt></a>, <a class="reference internal" href="../../ref/models/fields.html#django.db.models.ManyToManyField" title="django.db.models.ManyToManyField"><tt class="xref py py-class docutils literal"><span class="pre">ManyToManyField</span></tt></a> or <a class="reference internal" href="../../ref/models/fields.html#django.db.models.OneToOneField" title="django.db.models.OneToOneField"><tt class="xref py py-class docutils literal"><span class="pre">OneToOneField</span></tt></a> relationship as translatable by using their <a class="reference internal" href="../../ref/models/options.html#django.db.models.Options.verbose_name" title="django.db.models.Options.verbose_name"><tt class="xref py py-attr docutils literal"><span class="pre">verbose_name</span></tt></a> options:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyThing</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">ThingKind</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">'kinds'</span><span class="p">,</span>
                             <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">'kind'</span><span class="p">))</span>
</pre></div>
</div>
<p><font id="83">Just like you would do in <a class="reference internal" href="../../ref/models/options.html#django.db.models.Options.verbose_name" title="django.db.models.Options.verbose_name"><tt class="xref py py-attr docutils literal"><span class="pre">verbose_name</span></tt></a> you should provide a lowercase verbose name text for the relation as Django will automatically titlecase it when required.</font></p>
</div>
<div class="section" id="s-model-verbose-names-values">
<span id="model-verbose-names-values"></span><h4><font id="471">Model verbose names values</font><a class="headerlink" href="translation.html#model-verbose-names-values" title="Permalink to this headline">¶</a></h4>
<p><font id="84">It is recommended to always provide explicit <a class="reference internal" href="../../ref/models/options.html#django.db.models.Options.verbose_name" title="django.db.models.Options.verbose_name"><tt class="xref py py-attr docutils literal"><span class="pre">verbose_name</span></tt></a> and <a class="reference internal" href="../../ref/models/options.html#django.db.models.Options.verbose_name_plural" title="django.db.models.Options.verbose_name_plural"><tt class="xref py py-attr docutils literal"><span class="pre">verbose_name_plural</span></tt></a> options rather than relying on the fallback English-centric and somewhat naïve determination of verbose names Django performs by looking at the model’s class name:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">MyThing</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">'name'</span><span class="p">),</span> <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">'This is the help text'</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">'my thing'</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">'my things'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-model-methods-short-description-attribute-values">
<span id="model-methods-short-description-attribute-values"></span><h4><font id="472">Model methods </font><tt class="docutils literal"><span class="pre">short_description</span></tt></h4>
<p><font id="85">For model methods, you can provide translations to Django and the admin site with the <tt class="docutils literal"><span class="pre">short_description</span></tt> attribute:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">MyThing</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">ThingKind</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">'kinds'</span><span class="p">,</span>
                             <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">'kind'</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">is_mouse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">MOUSE_TYPE</span>
    <span class="n">is_mouse</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">'Is it a mouse?'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-working-with-lazy-translation-objects">
<span id="working-with-lazy-translation-objects"></span><h3><font id="438">Working with lazy translation objects</font><a class="headerlink" href="translation.html#working-with-lazy-translation-objects" title="Permalink to this headline">¶</a></h3>
<p><font id="86">The result of a <tt class="docutils literal"><span class="pre">ugettext_lazy()</span></tt> call can be used wherever you would use a unicode string (an object with type <tt class="docutils literal"><span class="pre">unicode</span></tt>) in Python. </font><font id="87">If you try to use it where a bytestring (a <tt class="docutils literal"><span class="pre">str</span></tt> object) is expected, things will not work as expected, since a <tt class="docutils literal"><span class="pre">ugettext_lazy()</span></tt> object doesn’t know how to convert itself to a bytestring. </font><font id="88">You can’t use a unicode string inside a bytestring, either, so this is consistent with normal Python behavior. </font><font id="89">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This is fine: putting a unicode proxy into a unicode string.</span>
<span class="s">"Hello </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">ugettext_lazy</span><span class="p">(</span><span class="s">"people"</span><span class="p">)</span>

<span class="c"># This will not work, since you cannot insert a unicode object</span>
<span class="c"># into a bytestring (nor can you insert our unicode proxy there)</span>
<span class="n">b</span><span class="s">"Hello </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">ugettext_lazy</span><span class="p">(</span><span class="s">"people"</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="90">If you ever see output that looks like <tt class="docutils literal"><span class="pre">"hello</span> <span class="pre">&lt;django.utils.functional...&gt;"</span></tt>, you have tried to insert the result of <tt class="docutils literal"><span class="pre">ugettext_lazy()</span></tt> into a bytestring. </font><font id="638">That’s a bug in your code.</font></p>
<p><font id="91">If you don’t like the long <tt class="docutils literal"><span class="pre">ugettext_lazy</span></tt> name, you can just alias it as <tt class="docutils literal"><span class="pre">_</span></tt> (underscore), like so:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">MyThing</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">'This is the help text'</span><span class="p">))</span>
</pre></div>
</div>
<p><font id="92">Using <tt class="docutils literal"><span class="pre">ugettext_lazy()</span></tt> and <tt class="docutils literal"><span class="pre">ungettext_lazy()</span></tt> to mark strings in models and utility functions is a common operation. </font><font id="93">When you’re working with these objects elsewhere in your code, you should ensure that you don’t accidentally convert them to strings, because they should be converted as late as possible (so that the correct locale is in effect). </font><font id="94">This necessitates the use of the helper function described next.</font></p>
<div class="section" id="s-lazy-translations-and-plural">
<span id="s-lazy-plural-translations"></span><span id="lazy-translations-and-plural"></span><span id="lazy-plural-translations"></span><h4><font id="473">Lazy translations and plural</font><a class="headerlink" href="translation.html#lazy-translations-and-plural" title="Permalink to this headline">¶</a></h4>
<p><font id="95">When using lazy translation for a plural string (<tt class="docutils literal"><span class="pre">[u]n[p]gettext_lazy</span></tt>), you generally don’t know the <tt class="docutils literal"><span class="pre">number</span></tt> argument at the time of the string definition. </font><font id="96">Therefore, you are authorized to pass a key name instead of an integer as the <tt class="docutils literal"><span class="pre">number</span></tt> argument. </font><font id="97">Then <tt class="docutils literal"><span class="pre">number</span></tt> will be looked up in the dictionary under that key during string interpolation. </font><font id="98">Here’s example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ungettext_lazy</span>

<span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">error_message</span> <span class="o">=</span> <span class="n">ungettext_lazy</span><span class="p">(</span><span class="s">"You only provided </span><span class="si">%(num)d</span><span class="s"> argument"</span><span class="p">,</span>
        <span class="s">"You only provided </span><span class="si">%(num)d</span><span class="s"> arguments"</span><span class="p">,</span> <span class="s">'num'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># ...</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="o">%</span> <span class="p">{</span><span class="s">'num'</span><span class="p">:</span> <span class="n">number</span><span class="p">})</span>
</pre></div>
</div>
<p><font id="99">If the string contains exactly one unnamed placeholder, you can interpolate directly with the <tt class="docutils literal"><span class="pre">number</span></tt> argument:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyForm</span><span class="p">(</span><span class="n">forms</span><span class="o">.</span><span class="n">Form</span><span class="p">):</span>
    <span class="n">error_message</span> <span class="o">=</span> <span class="n">ungettext_lazy</span><span class="p">(</span><span class="s">"You provided </span><span class="si">%d</span><span class="s"> argument"</span><span class="p">,</span>
        <span class="s">"You provided </span><span class="si">%d</span><span class="s"> arguments"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># ...</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">forms</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_message</span> <span class="o">%</span> <span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-joining-strings-string-concat">
<span id="joining-strings-string-concat"></span><h4><font id="474">Joining strings: string_concat()</font><a class="headerlink" href="translation.html#joining-strings-string-concat" title="Permalink to this headline">¶</a></h4>
<p><font id="100">Standard Python string joins (<tt class="docutils literal"><span class="pre">''.join([...])</span></tt>) will not work on lists containing lazy translation objects. </font><font id="101">Instead, you can use <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.string_concat" title="django.utils.translation.string_concat"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.string_concat()</span></tt></a>, which creates a lazy object that concatenates its contents <em>and</em> converts them to strings only when the result is included in a string. </font><font id="102">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">string_concat</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span>
<span class="o">...</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">ugettext_lazy</span><span class="p">(</span><span class="s">'John Lennon'</span><span class="p">)</span>
<span class="n">instrument</span> <span class="o">=</span> <span class="n">ugettext_lazy</span><span class="p">(</span><span class="s">'guitar'</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">string_concat</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s">': '</span><span class="p">,</span> <span class="n">instrument</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="103">In this case, the lazy translations in <tt class="docutils literal"><span class="pre">result</span></tt> will only be converted to strings when <tt class="docutils literal"><span class="pre">result</span></tt> itself is used in a string (usually at template rendering time).</font></p>
</div>
<div class="section" id="s-other-uses-of-lazy-in-delayed-translations">
<span id="other-uses-of-lazy-in-delayed-translations"></span><h4><font id="475">Other uses of lazy in delayed translations</font><a class="headerlink" href="translation.html#other-uses-of-lazy-in-delayed-translations" title="Permalink to this headline">¶</a></h4>
<p><font id="104">For any other case where you would like to delay the translation, but have to pass the translatable string as argument to another function, you can wrap this function inside a lazy call yourself. </font><font id="105">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">six</span>  <span class="c"># Python 3 compatibility</span>
<span class="kn">from</span> <span class="nn">django.utils.functional</span> <span class="kn">import</span> <span class="n">lazy</span>
<span class="kn">from</span> <span class="nn">django.utils.safestring</span> <span class="kn">import</span> <span class="n">mark_safe</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="n">mark_safe_lazy</span> <span class="o">=</span> <span class="n">lazy</span><span class="p">(</span><span class="n">mark_safe</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="106">And then later:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">lazy_string</span> <span class="o">=</span> <span class="n">mark_safe_lazy</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">"&lt;p&gt;My &lt;strong&gt;string!&lt;/strong&gt;&lt;/p&gt;"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-localized-names-of-languages">
<span id="localized-names-of-languages"></span><h3><font id="439">Localized names of languages</font><a class="headerlink" href="translation.html#localized-names-of-languages" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.utils.translation.get_language_info">
<tt class="descname">get_language_info</tt>()<a class="reference internal" href="http://python.usyiyi.cn/django/_modules/django/utils/translation.html#get_language_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="translation.html#django.utils.translation.get_language_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="107">The <tt class="docutils literal"><span class="pre">get_language_info()</span></tt> function provides detailed information about languages:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">get_language_info</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">li</span> <span class="o">=</span> <span class="n">get_language_info</span><span class="p">(</span><span class="s">'de'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">li</span><span class="p">[</span><span class="s">'name'</span><span class="p">],</span> <span class="n">li</span><span class="p">[</span><span class="s">'name_local'</span><span class="p">],</span> <span class="n">li</span><span class="p">[</span><span class="s">'bidi'</span><span class="p">])</span>
<span class="go">German Deutsch False</span>
</pre></div>
</div>
<p><font id="108">The <tt class="docutils literal"><span class="pre">name</span></tt> and <tt class="docutils literal"><span class="pre">name_local</span></tt> attributes of the dictionary contain the name of the language in English and in the language itself, respectively. </font><font id="109">The <tt class="docutils literal"><span class="pre">bidi</span></tt> attribute is True only for bi-directional languages.</font></p>
<p><font id="110">The source of the language information is the <tt class="docutils literal"><span class="pre">django.conf.locale</span></tt> module. </font><font id="111">Similar access to this information is available for template code. </font><font id="112">See below.</font></p>
</div>
</div>
<div class="section" id="s-internationalization-in-template-code">
<span id="s-specifying-translation-strings-in-template-code"></span><span id="internationalization-in-template-code"></span><span id="specifying-translation-strings-in-template-code"></span><h2><font id="426">Internationalization: in template code</font><a class="headerlink" href="translation.html#internationalization-in-template-code" title="Permalink to this headline">¶</a></h2>
<p><font id="113">Translations in <a class="reference internal" href="../../ref/templates/language.html"><em>Django templates</em></a> uses two template tags and a slightly different syntax than in Python code. </font><font id="114">To give your template access to these tags, put <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">i18n</span> <span class="pre">%}</span></tt> toward the top of your template. </font><font id="115">As with all template tags, this tag needs to be loaded in all templates which use translations, even those templates that extend from other templates which have already loaded the <tt class="docutils literal"><span class="pre">i18n</span></tt> tag.</font></p>
<div class="section" id="s-trans-template-tag">
<span id="s-std:templatetag-trans"></span><span id="trans-template-tag"></span><span id="std:templatetag-trans"></span><h3><font id="440">trans</font> template tag</h3>
<p><font id="116">The <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">trans</span> <span class="pre">%}</span></tt> template tag translates either a constant string (enclosed in single or double quotes) or variable content:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"This is the title."</span> <span class="cp">%}</span><span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="nv">myvar</span> <span class="cp">%}</span><span class="nt">&lt;/title&gt;</span>
</pre></div>
</div>
<p><font id="117">If the <tt class="docutils literal"><span class="pre">noop</span></tt> option is present, variable lookup still takes place but the translation is skipped. </font><font id="118">This is useful when “stubbing out” content that will require translation in the future:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"myvar"</span> <span class="nv">noop</span> <span class="cp">%}</span><span class="nt">&lt;/title&gt;</span>
</pre></div>
</div>
<p><font id="119">Internally, inline translations use an <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext" title="django.utils.translation.ugettext"><tt class="xref py py-func docutils literal"><span class="pre">ugettext()</span></tt></a> call.</font></p>
<p><font id="120">In case a template var (<tt class="docutils literal"><span class="pre">myvar</span></tt> above) is passed to the tag, the tag will first resolve such variable to a string at run-time and then look up that string in the message catalogs.</font></p>
<p><font id="121">It’s not possible to mix a template variable inside a string within <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">trans</span> <span class="pre">%}</span></tt>. </font><font id="122">If your translations require strings with variables (placeholders), use <a class="reference internal" href="translation.html#std:templatetag-blocktrans"><tt class="xref std std-ttag docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt></a> instead.</font></p>
<p><font id="123">If you’d like to retrieve a translated string without displaying it, you can use the following syntax:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"This is the title"</span> <span class="k">as</span> <span class="nv">the_title</span> <span class="cp">%}</span>

<span class="nt">&lt;title&gt;</span><span class="cp">{{</span> <span class="nv">the_title</span> <span class="cp">}}</span><span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"description"</span> <span class="na">content=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">the_title</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p><font id="124">In practice you’ll use this to get strings that are used in multiple places or should be used as arguments for other template tags or filters:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"starting point"</span> <span class="k">as</span> <span class="nv">start</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"end point"</span> <span class="k">as</span> <span class="nv">end</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"La Grande Boucle"</span> <span class="k">as</span> <span class="nv">race</span> <span class="cp">%}</span>

<span class="nt">&lt;h1&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/"</span> <span class="na">title=</span><span class="s">"</span><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="cp">%}</span><span class="s">Back to '</span><span class="cp">{{</span> <span class="nv">race</span> <span class="cp">}}</span><span class="s">' homepage</span><span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">race</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">stage</span> <span class="k">in</span> <span class="nv">tour_stages</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">cycle</span> <span class="nv">start</span> <span class="nv">end</span> <span class="cp">%}</span>: <span class="cp">{{</span> <span class="nv">stage</span> <span class="cp">}}{%</span> <span class="k">if</span> <span class="nb">forloop</span><span class="nv">.counter</span><span class="o">|</span><span class="nf">divisibleby</span><span class="o">:</span><span class="m">2</span> <span class="cp">%}</span><span class="nt">&lt;br</span> <span class="nt">/&gt;</span><span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>, <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p><font id="125"><tt class="docutils literal"><span class="pre">{%</span> <span class="pre">trans</span> <span class="pre">%}</span></tt> also supports <a class="reference internal" href="translation.html#contextual-markers"><em>contextual markers</em></a> using the <tt class="docutils literal"><span class="pre">context</span></tt> keyword:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"May"</span> <span class="nv">context</span> <span class="s2">"month name"</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="section" id="s-blocktrans-template-tag">
<span id="s-std:templatetag-blocktrans"></span><span id="blocktrans-template-tag"></span><span id="std:templatetag-blocktrans"></span><h3><font id="441">blocktrans</font> template tag</h3>
<p><font id="126">Contrarily to the <a class="reference internal" href="translation.html#std:templatetag-trans"><tt class="xref std std-ttag docutils literal"><span class="pre">trans</span></tt></a> tag, the <tt class="docutils literal"><span class="pre">blocktrans</span></tt> tag allows you to mark complex sentences consisting of literals and variable content for translation by making use of placeholders:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="cp">%}</span>This string will have <span class="cp">{{</span> <span class="nv">value</span> <span class="cp">}}</span> inside.<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="127">To translate a template expression – say, accessing object attributes or using template filters – you need to bind the expression to a local variable for use within the translation block. </font><font id="128">Examples:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="k">with</span> <span class="nv">amount</span><span class="o">=</span><span class="nv">article.price</span> <span class="cp">%}</span>
That will cost $ <span class="cp">{{</span> <span class="nv">amount</span> <span class="cp">}}</span>.
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">blocktrans</span> <span class="k">with</span> <span class="nv">myvar</span><span class="o">=</span><span class="nv">value</span><span class="o">|</span><span class="nf">filter</span> <span class="cp">%}</span>
This will have <span class="cp">{{</span> <span class="nv">myvar</span> <span class="cp">}}</span> inside.
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="129">You can use multiple expressions inside a single <tt class="docutils literal"><span class="pre">blocktrans</span></tt> tag:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="k">with</span> <span class="nv">book_t</span><span class="o">=</span><span class="nv">book</span><span class="o">|</span><span class="nf">title</span> <span class="nv">author_t</span><span class="o">=</span><span class="nv">author</span><span class="o">|</span><span class="nf">title</span> <span class="cp">%}</span>
This is <span class="cp">{{</span> <span class="nv">book_t</span> <span class="cp">}}</span> by <span class="cp">{{</span> <span class="nv">author_t</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font id="130">Note</font></p>
<p class="last"><font id="131">The previous more verbose format is still supported: <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">with</span> <span class="pre">book|title</span> <span class="pre">as</span> <span class="pre">book_t</span> <span class="pre">and</span> <span class="pre">author|title</span> <span class="pre">as</span> <span class="pre">author_t</span> <span class="pre">%}</span></tt></font></p>
</div>
<p><font id="132">Other block tags (for example <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">for</span> <span class="pre">%}</span></tt> or <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">if</span> <span class="pre">%}</span></tt>) are not allowed inside a <tt class="docutils literal"><span class="pre">blocktrans</span></tt> tag.</font></p>
<p><font id="133">If resolving one of the block arguments fails, blocktrans will fall back to the default language by deactivating the currently active language temporarily with the <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.deactivate_all" title="django.utils.translation.deactivate_all"><tt class="xref py py-func docutils literal"><span class="pre">deactivate_all()</span></tt></a> function.</font></p>
<p><font id="134">This tag also provides for pluralization. </font><font id="135">To use it:</font></p>
<ul class="simple">
<li><font id="490">Designate and bind a counter value with the name <tt class="docutils literal"><span class="pre">count</span></tt>. </font><font id="491">This value will be the one used to select the right plural form.</font></li>
<li><font id="492">Specify both the singular and plural forms separating them with the <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">plural</span> <span class="pre">%}</span></tt> tag within the <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt> and <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">endblocktrans</span> <span class="pre">%}</span></tt> tags.</font></li>
</ul>
<p><font id="136">An example:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="nv">count</span> <span class="nv">counter</span><span class="o">=</span><span class="nv">list</span><span class="o">|</span><span class="nf">length</span> <span class="cp">%}</span>
There is only one <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span> object.
<span class="cp">{%</span> <span class="k">plural</span> <span class="cp">%}</span>
There are <span class="cp">{{</span> <span class="nv">counter</span> <span class="cp">}}</span> <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span> objects.
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="137">A more complex example:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="k">with</span> <span class="nv">amount</span><span class="o">=</span><span class="nv">article.price</span> <span class="nv">count</span> <span class="nv">years</span><span class="o">=</span><span class="nv">i.length</span> <span class="cp">%}</span>
That will cost $ <span class="cp">{{</span> <span class="nv">amount</span> <span class="cp">}}</span> per year.
<span class="cp">{%</span> <span class="k">plural</span> <span class="cp">%}</span>
That will cost $ <span class="cp">{{</span> <span class="nv">amount</span> <span class="cp">}}</span> per <span class="cp">{{</span> <span class="nv">years</span> <span class="cp">}}</span> years.
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="138">When you use both the pluralization feature and bind values to local variables in addition to the counter value, keep in mind that the <tt class="docutils literal"><span class="pre">blocktrans</span></tt> construct is internally converted to an <tt class="docutils literal"><span class="pre">ungettext</span></tt> call. </font><font id="139">This means the same <a class="reference internal" href="translation.html#pluralization-var-notes"><em>notes regarding ungettext variables</em></a> apply.</font></p>
<p><font id="140">Reverse URL lookups cannot be carried out within the <tt class="docutils literal"><span class="pre">blocktrans</span></tt> and should be retrieved (and stored) beforehand:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">url</span> <span class="s1">'path.to.view'</span> <span class="nv">arg</span> <span class="nv">arg2</span> <span class="k">as</span> <span class="nv">the_url</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">blocktrans</span> <span class="cp">%}</span>
This is a URL: <span class="cp">{{</span> <span class="nv">the_url</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="141"><tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt> also supports <a class="reference internal" href="translation.html#contextual-markers"><em>contextual markers</em></a> using the <tt class="docutils literal"><span class="pre">context</span></tt> keyword:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="k">with</span> <span class="nv">name</span><span class="o">=</span><span class="nv">user.username</span> <span class="nv">context</span> <span class="s2">"greeting"</span> <span class="cp">%}</span>Hi <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="142">Another feature <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt> supports is the <tt class="docutils literal"><span class="pre">trimmed</span></tt> option. </font><font id="143">This option will remove newline characters from the beginning and the end of the content of the <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt> tag, replace any whitespace at the beginning and end of a line and merge all lines into one using a space character to separate them. </font><font id="144">This is quite useful for indenting the content of a <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt> tag without having the indentation characters end up in the corresponding entry in the PO file, which makes the translation process easier.</font></p>
<p><font id="145">For instance, the following <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">blocktrans</span> <span class="pre">%}</span></tt> tag:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="nv">trimmed</span> <span class="cp">%}</span>
  First sentence.
  Second paragraph.
<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="146">will result in the entry <tt class="docutils literal"><span class="pre">"First</span> <span class="pre">sentence.</span> <span class="pre">Second</span> <span class="pre">paragraph."</span></tt> in the PO file, compared to <tt class="docutils literal"><span class="pre">"
</span>  <span class="pre">First</span> <span class="pre">sentence.
</span>  <span class="pre">Second</span> <span class="pre">sentence.
"</span></tt>, if the <tt class="docutils literal"><span class="pre">trimmed</span></tt> option had not been specified.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="147">The <tt class="docutils literal"><span class="pre">trimmed</span></tt> option was added.</font></p>
</div>
</div>
<div class="section" id="s-string-literals-passed-to-tags-and-filters">
<span id="string-literals-passed-to-tags-and-filters"></span><h3><font id="442">String literals passed to tags and filters</font><a class="headerlink" href="translation.html#string-literals-passed-to-tags-and-filters" title="Permalink to this headline">¶</a></h3>
<p><font id="148">You can translate string literals passed as arguments to tags and filters by using the familiar <tt class="docutils literal"><span class="pre">_()</span></tt> syntax:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">some_tag</span> <span class="kp">_</span><span class="o">(</span><span class="s2">"Page not found"</span><span class="o">)</span> <span class="nv">value</span><span class="o">|</span><span class="nf">yesno</span><span class="o">:</span><span class="kp">_</span><span class="o">(</span><span class="s2">"yes,no"</span><span class="o">)</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="149">In this case, both the tag and the filter will see the translated string, so they don’t need to be aware of translations.</font></p>
<div class="admonition note">
<p class="first admonition-title"><font id="150">Note</font></p>
<p class="last"><font id="151">In this example, the translation infrastructure will be passed the string <tt class="docutils literal"><span class="pre">"yes,no"</span></tt>, not the individual strings <tt class="docutils literal"><span class="pre">"yes"</span></tt> and <tt class="docutils literal"><span class="pre">"no"</span></tt>. </font><font id="639">The translated string will need to contain the comma so that the filter parsing code knows how to split up the arguments. </font><font id="640">For example, a German translator might translate the string <tt class="docutils literal"><span class="pre">"yes,no"</span></tt> as <tt class="docutils literal"><span class="pre">"ja,nein"</span></tt> (keeping the comma intact).</font></p>
</div>
</div>
<div class="section" id="s-comments-for-translators-in-templates">
<span id="s-translator-comments-in-templates"></span><span id="comments-for-translators-in-templates"></span><span id="translator-comments-in-templates"></span><h3><font id="443">Comments for translators in templates</font><a class="headerlink" href="translation.html#comments-for-translators-in-templates" title="Permalink to this headline">¶</a></h3>
<p><font id="152">Just like with <a class="reference internal" href="translation.html#translator-comments"><em>Python code</em></a>, these notes for translators can be specified using comments, either with the <a class="reference internal" href="../../ref/templates/builtins.html#std:templatetag-comment"><tt class="xref std std-ttag docutils literal"><span class="pre">comment</span></tt></a> tag:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">comment</span> <span class="cp">%}</span><span class="c">Translators: View verb</span><span class="cp">{%</span> <span class="k">endcomment</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"View"</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">comment</span> <span class="cp">%}</span><span class="c">Translators: Short intro blurb</span><span class="cp">{%</span> <span class="k">endcomment</span> <span class="cp">%}</span>
<span class="nt">&lt;p&gt;</span><span class="cp">{%</span> <span class="k">blocktrans</span> <span class="cp">%}</span>A multiline translatable
literal.<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span><span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
<p><font id="153">or with the <tt class="docutils literal"><span class="pre">{#</span></tt> ... </font><font id="154"><tt class="docutils literal"><span class="pre">#}</span></tt> </font><font id="155"><a class="reference internal" href="../../ref/templates/language.html#template-comments"><em>one-line comment constructs</em></a>:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="c"></span>
<span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"Go"</span> <span class="cp">%}</span><span class="nt">&lt;/button&gt;</span>

<span class="c"></span>
<span class="cp">{%</span> <span class="k">blocktrans</span> <span class="cp">%}</span>Ambiguous translatable block of text<span class="cp">{%</span> <span class="k">endblocktrans</span> <span class="cp">%}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title"><font id="156">Note</font></p>
<p><font id="157">Just for completeness, these are the corresponding fragments of the resulting <tt class="docutils literal"><span class="pre">.po</span></tt> file:</font></p>
<div class="last highlight-po"><div class="highlight"><pre><span class="c1">#. Translators: View verb</span>
<span class="c1"># path/to/template/file.html:10</span>
<span class="nv">msgid</span> <span class="s">"View"</span>
<span class="nv">msgstr</span> <span class="s">""</span>

<span class="c1">#. Translators: Short intro blurb</span>
<span class="c1"># path/to/template/file.html:13</span>
<span class="nv">msgid</span> <span class="s">""</span>
<span class="s">"A multiline translatable"</span>
<span class="s">"literal."</span>
<span class="nv">msgstr</span> <span class="s">""</span>

<span class="c1"># ...</span>

<span class="c1">#. Translators: Label of a button that triggers search</span>
<span class="c1"># path/to/template/file.html:100</span>
<span class="nv">msgid</span> <span class="s">"Go"</span>
<span class="nv">msgstr</span> <span class="s">""</span>

<span class="c1">#. Translators: This is a text of the base template</span>
<span class="c1"># path/to/template/file.html:103</span>
<span class="nv">msgid</span> <span class="s">"Ambiguous translatable block of text"</span>
<span class="nv">msgstr</span> <span class="s">""</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-switching-language-in-templates">
<span id="s-std:templatetag-language"></span><span id="switching-language-in-templates"></span><span id="std:templatetag-language"></span><h3><font id="444">Switching language in templates</font><a class="headerlink" href="translation.html#switching-language-in-templates" title="Permalink to this headline">¶</a></h3>
<p><font id="158">If you want to select a language within a template, you can use the <tt class="docutils literal"><span class="pre">language</span></tt> template tag:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">i18n</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">get_current_language</span> <span class="k">as</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">%}</span>
<span class="c">&lt;!-- Current language: </span><span class="cp">{{</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">}}</span><span class="c"> --&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"Welcome to our page"</span> <span class="cp">%}</span><span class="nt">&lt;/p&gt;</span>

<span class="cp">{%</span> <span class="k">language</span> <span class="s1">'en'</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">get_current_language</span> <span class="k">as</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">%}</span>
    <span class="c">&lt;!-- Current language: </span><span class="cp">{{</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">}}</span><span class="c"> --&gt;</span>
    <span class="nt">&lt;p&gt;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"Welcome to our page"</span> <span class="cp">%}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endlanguage</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="159">While the first occurrence of “Welcome to our page” uses the current language, the second will always be in English.</font></p>
</div>
<div class="section" id="s-other-tags">
<span id="s-template-translation-vars"></span><span id="other-tags"></span><span id="template-translation-vars"></span><h3><font id="445">Other tags</font><a class="headerlink" href="translation.html#other-tags" title="Permalink to this headline">¶</a></h3>
<p><font id="160">These tags also require a <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">i18n</span> <span class="pre">%}</span></tt>.</font></p>
<ul class="simple">
<li><font id="493"><tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_available_languages</span> <span class="pre">as</span> <span class="pre">LANGUAGES</span> <span class="pre">%}</span></tt> returns a list of tuples in which the first element is the <a class="reference internal" href="index.html#term-language-code"><em class="xref std std-term">language code</em></a> and the second is the language name (translated into the currently active locale).</font></li>
<li><font id="494"><tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_current_language</span> <span class="pre">as</span> <span class="pre">LANGUAGE_CODE</span> <span class="pre">%}</span></tt> returns the current user’s preferred language, as a string. </font><font id="495">Example: <tt class="docutils literal"><span class="pre">en-us</span></tt>. </font><font id="496">(See <a class="reference internal" href="translation.html#how-django-discovers-language-preference"><em>How Django discovers language preference</em></a>.)</font></li>
<li><font id="497"><tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_current_language_bidi</span> <span class="pre">as</span> <span class="pre">LANGUAGE_BIDI</span> <span class="pre">%}</span></tt> returns the current locale’s direction. </font><font id="498">If True, it’s a right-to-left language, e.g.: Hebrew, Arabic. </font><font id="499">If False it’s a left-to-right language, e.g.: English, French, German etc.</font></li>
</ul>
<p><font id="161">If you enable the <tt class="docutils literal"><span class="pre">django.template.context_processors.i18n</span></tt> context processor then each <tt class="docutils literal"><span class="pre">RequestContext</span></tt> will have access to <tt class="docutils literal"><span class="pre">LANGUAGES</span></tt>, <tt class="docutils literal"><span class="pre">LANGUAGE_CODE</span></tt>, and <tt class="docutils literal"><span class="pre">LANGUAGE_BIDI</span></tt> as defined above.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.8:</span> <p><font id="162">The <tt class="docutils literal"><span class="pre">i18n</span></tt> context processor is not enabled by default for new projects.</font></p>
</div>
<p><font id="163">You can also retrieve information about any of the available languages using provided template tags and filters. </font><font id="164">To get information about a single language, use the <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_language_info</span> <span class="pre">%}</span></tt> tag:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">get_language_info</span> <span class="nv">for</span> <span class="nv">LANGUAGE_CODE</span> <span class="k">as</span> <span class="nv">lang</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">get_language_info</span> <span class="nv">for</span> <span class="s2">"pl"</span> <span class="k">as</span> <span class="nv">lang</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="165">You can then access the information:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>Language code: <span class="cp">{{</span> <span class="nv">lang.code</span> <span class="cp">}}</span><span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
Name of language: <span class="cp">{{</span> <span class="nv">lang.name_local</span> <span class="cp">}}</span><span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
Name in English: <span class="cp">{{</span> <span class="nv">lang.name</span> <span class="cp">}}</span><span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
Bi-directional: <span class="cp">{{</span> <span class="nv">lang.bidi</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="166">You can also use the <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_language_info_list</span> <span class="pre">%}</span></tt> template tag to retrieve information for a list of languages (e.g. active languages as specified in <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGES</span></tt></a>). </font><font id="167">See <a class="reference internal" href="translation.html#set-language-redirect-view"><em>the section about the set_language redirect view</em></a> for an example of how to display a language selector using <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_language_info_list</span> <span class="pre">%}</span></tt>.</font></p>
<p><font id="168">In addition to <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGES</span></tt></a> style nested tuples, <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">get_language_info_list</span> <span class="pre">%}</span></tt> supports simple lists of language codes. </font><font id="169">If you do this in your view:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s">'available_languages'</span><span class="p">:</span> <span class="p">[</span><span class="s">'en'</span><span class="p">,</span> <span class="s">'es'</span><span class="p">,</span> <span class="s">'fr'</span><span class="p">]}</span>
<span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s">'mytemplate.html'</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="170">you can iterate over those languages in the template:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">get_language_info_list</span> <span class="nv">for</span> <span class="nv">available_languages</span> <span class="k">as</span> <span class="nv">langs</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">lang</span> <span class="k">in</span> <span class="nv">langs</span> <span class="cp">%}</span> ... <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="171">There are also simple filters available for convenience:</font></p>
<ul class="simple">
<li><font id="500"><tt class="docutils literal"><span class="pre">{{</span> <span class="pre">LANGUAGE_CODE|language_name</span> <span class="pre">}}</span></tt> </font><font id="501">(“German”)</font></li>
<li><font id="502"><tt class="docutils literal"><span class="pre">{{</span> <span class="pre">LANGUAGE_CODE|language_name_local</span> <span class="pre">}}</span></tt> </font><font id="503">(“Deutsch”)</font></li>
<li><font id="504"><tt class="docutils literal"><span class="pre">{{</span> <span class="pre">LANGUAGE_CODE|language_bidi</span> <span class="pre">}}</span></tt> </font><font id="505">(False)</font></li>
</ul>
</div>
</div>
<div class="section" id="s-internationalization-in-javascript-code">
<span id="internationalization-in-javascript-code"></span><h2><font id="427">Internationalization: in JavaScript code</font><a class="headerlink" href="translation.html#internationalization-in-javascript-code" title="Permalink to this headline">¶</a></h2>
<p><font id="172">Adding translations to JavaScript poses some problems:</font></p>
<ul class="simple">
<li><font id="506">JavaScript code doesn’t have access to a <tt class="docutils literal"><span class="pre">gettext</span></tt> implementation.</font></li>
<li><font id="507">JavaScript code doesn’t have access to <tt class="docutils literal"><span class="pre">.po</span></tt> or <tt class="docutils literal"><span class="pre">.mo</span></tt> files; </font><font id="508">they need to be delivered by the server.</font></li>
<li><font id="509">The translation catalogs for JavaScript should be kept as small as possible.</font></li>
</ul>
<p><font id="173">Django provides an integrated solution for these problems: It passes the translations into JavaScript, so you can call <tt class="docutils literal"><span class="pre">gettext</span></tt>, etc., from within JavaScript.</font></p>
<div class="section" id="s-module-django.views.i18n">
<span id="s-the-javascript-catalog-view"></span><span id="s-javascript-catalog-view"></span><span id="module-django.views.i18n"></span><span id="the-javascript-catalog-view"></span><span id="javascript-catalog-view"></span><h3><font id="446">The </font><tt class="docutils literal"><span class="pre">javascript_catalog</span></tt></h3>
<dl class="function">
<dt id="django.views.i18n.javascript_catalog">
<tt class="descname">javascript_catalog</tt>(<em>request</em>, <em>domain='djangojs'</em>, <em>packages=None</em>)<a class="reference internal" href="http://python.usyiyi.cn/django/_modules/django/views/i18n.html#javascript_catalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="translation.html#django.views.i18n.javascript_catalog" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="174">The main solution to these problems is the <a class="reference internal" href="translation.html#django.views.i18n.javascript_catalog" title="django.views.i18n.javascript_catalog"><tt class="xref py py-meth docutils literal"><span class="pre">django.views.i18n.javascript_catalog()</span></tt></a> view, which sends out a JavaScript code library with functions that mimic the <tt class="docutils literal"><span class="pre">gettext</span></tt> interface, plus an array of translation strings. </font><font id="175">Those translation strings are taken from applications or Django core, according to what you specify in either the <tt class="docutils literal"><span class="pre">info_dict</span></tt> or the URL. </font><font id="176">Paths listed in <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> are also included.</font></p>
<p><font id="177">You hook it up like this:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.views.i18n</span> <span class="kn">import</span> <span class="n">javascript_catalog</span>

<span class="n">js_info_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'packages'</span><span class="p">:</span> <span class="p">(</span><span class="s">'your.app.package'</span><span class="p">,),</span>
<span class="p">}</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^jsi18n/$'</span><span class="p">,</span> <span class="n">javascript_catalog</span><span class="p">,</span> <span class="n">js_info_dict</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p><font id="178">Each string in <tt class="docutils literal"><span class="pre">packages</span></tt> should be in Python dotted-package syntax (the same format as the strings in <a class="reference internal" href="../../ref/settings.html#std:setting-INSTALLED_APPS"><tt class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></tt></a>) and should refer to a package that contains a <tt class="docutils literal"><span class="pre">locale</span></tt> directory. </font><font id="179">If you specify multiple packages, all those catalogs are merged into one catalog. </font><font id="180">This is useful if you have JavaScript that uses strings from different applications.</font></p>
<p><font id="181">The precedence of translations is such that the packages appearing later in the <tt class="docutils literal"><span class="pre">packages</span></tt> argument have higher precedence than the ones appearing at the beginning, this is important in the case of clashing translations for the same literal.</font></p>
<p><font id="182">By default, the view uses the <tt class="docutils literal"><span class="pre">djangojs</span></tt> gettext domain. </font><font id="183">This can be changed by altering the <tt class="docutils literal"><span class="pre">domain</span></tt> argument.</font></p>
<p><font id="184">You can make the view dynamic by putting the packages into the URL pattern:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r'^jsi18n/(?P&lt;packages&gt;\S+?)/$'</span><span class="p">,</span> <span class="n">javascript_catalog</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p><font id="185">With this, you specify the packages as a list of package names delimited by ‘+’ signs in the URL. </font><font id="186">This is especially useful if your pages use code from different apps and this changes often and you don’t want to pull in one big catalog file. </font><font id="187">As a security measure, these values can only be either <tt class="docutils literal"><span class="pre">django.conf</span></tt> or any package from the <a class="reference internal" href="../../ref/settings.html#std:setting-INSTALLED_APPS"><tt class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></tt></a> setting.</font></p>
<p><font id="188">The JavaScript translations found in the paths listed in the <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> setting are also always included. </font><font id="189">To keep consistency with the translations lookup order algorithm used for Python and templates, the directories listed in <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> have the highest precedence with the ones appearing first having higher precedence than the ones appearing later.</font></p>
</div>
<div class="section" id="s-using-the-javascript-translation-catalog">
<span id="using-the-javascript-translation-catalog"></span><h3><font id="447">Using the JavaScript translation catalog</font><a class="headerlink" href="translation.html#using-the-javascript-translation-catalog" title="Permalink to this headline">¶</a></h3>
<p><font id="190">To use the catalog, just pull in the dynamically generated script like this:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">'django.views.i18n.javascript_catalog'</span> <span class="cp">%}</span><span class="s">"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
<p><font id="191">This uses reverse URL lookup to find the URL of the JavaScript catalog view. </font><font id="192">When the catalog is loaded, your JavaScript code can use the following methods:</font></p>
<ul class="simple">
<li><font id="510"><tt class="docutils literal"><span class="pre">gettext</span></tt></font></li>
<li><font id="511"><tt class="docutils literal"><span class="pre">ngettext</span></tt></font></li>
<li><font id="512"><tt class="docutils literal"><span class="pre">interpolate</span></tt></font></li>
<li><font id="513"><tt class="docutils literal"><span class="pre">get_format</span></tt></font></li>
<li><font id="514"><tt class="docutils literal"><span class="pre">gettext_noop</span></tt></font></li>
<li><font id="515"><tt class="docutils literal"><span class="pre">pgettext</span></tt></font></li>
<li><font id="516"><tt class="docutils literal"><span class="pre">npgettext</span></tt></font></li>
<li><font id="517"><tt class="docutils literal"><span class="pre">pluralidx</span></tt></font></li>
</ul>
<div class="section" id="s-gettext">
<span id="gettext"></span><h4><font id="476">gettext</font><a class="headerlink" href="translation.html#gettext" title="Permalink to this headline">¶</a></h4>
<p><font id="193">The <tt class="docutils literal"><span class="pre">gettext</span></tt> function behaves similarly to the standard <tt class="docutils literal"><span class="pre">gettext</span></tt> interface within your Python code:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">gettext</span><span class="p">(</span><span class="s1">'this is to be translated'</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="s-ngettext">
<span id="ngettext"></span><h4><font id="477">ngettext</font><a class="headerlink" href="translation.html#ngettext" title="Permalink to this headline">¶</a></h4>
<p><font id="194">The <tt class="docutils literal"><span class="pre">ngettext</span></tt> function provides an interface to pluralize words and phrases:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">object_count</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">// or 0, or 2, or 3, ...</span>
<span class="nx">s</span> <span class="o">=</span> <span class="nx">ngettext</span><span class="p">(</span><span class="s1">'literal for the singular case'</span><span class="p">,</span>
        <span class="s1">'literal for the plural case'</span><span class="p">,</span> <span class="nx">object_count</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="s-interpolate">
<span id="interpolate"></span><h4><font id="478">interpolate</font><a class="headerlink" href="translation.html#interpolate" title="Permalink to this headline">¶</a></h4>
<p><font id="195">The <tt class="docutils literal"><span class="pre">interpolate</span></tt> function supports dynamically populating a format string. </font><font id="196">The interpolation syntax is borrowed from Python, so the <tt class="docutils literal"><span class="pre">interpolate</span></tt> function supports both positional and named interpolation:</font></p>
<ul>
<li><p class="first"><font id="197">Positional interpolation: <tt class="docutils literal"><span class="pre">obj</span></tt> contains a JavaScript Array object whose elements values are then sequentially interpolated in their corresponding <tt class="docutils literal"><span class="pre">fmt</span></tt> placeholders in the same order they appear. </font><font id="198">For example:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fmts</span> <span class="o">=</span> <span class="nx">ngettext</span><span class="p">(</span><span class="s1">'There is %s object. Remaining: %s'</span><span class="p">,</span>
        <span class="s1">'There are %s objects. Remaining: %s'</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="nx">s</span> <span class="o">=</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">fmts</span><span class="p">,</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">]);</span>
<span class="c1">// s is 'There are 11 objects. Remaining: 20'</span>
</pre></div>
</div>
</li>
<li><p class="first"><font id="199">Named interpolation: This mode is selected by passing the optional boolean <tt class="docutils literal"><span class="pre">named</span></tt> parameter as <tt class="docutils literal"><span class="pre">true</span></tt>. </font><font id="200"><tt class="docutils literal"><span class="pre">obj</span></tt> contains a JavaScript object or associative array. </font><font id="201">For example:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">d</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">count</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nx">total</span><span class="o">:</span> <span class="mi">50</span>
<span class="p">};</span>

<span class="nx">fmts</span> <span class="o">=</span> <span class="nx">ngettext</span><span class="p">(</span><span class="s1">'Total: %(total)s, there is %(count)s object'</span><span class="p">,</span>
<span class="s1">'there are %(count)s of a total of %(total)s objects'</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">count</span><span class="p">);</span>
<span class="nx">s</span> <span class="o">=</span> <span class="nx">interpolate</span><span class="p">(</span><span class="nx">fmts</span><span class="p">,</span> <span class="nx">d</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p><font id="202">You shouldn’t go over the top with string interpolation, though: this is still JavaScript, so the code has to make repeated regular-expression substitutions. </font><font id="203">This isn’t as fast as string interpolation in Python, so keep it to those cases where you really need it (for example, in conjunction with <tt class="docutils literal"><span class="pre">ngettext</span></tt> to produce proper pluralizations).</font></p>
</div>
<div class="section" id="s-get-format">
<span id="get-format"></span><h4><font id="479">get_format</font><a class="headerlink" href="translation.html#get-format" title="Permalink to this headline">¶</a></h4>
<p><font id="204">The <tt class="docutils literal"><span class="pre">get_format</span></tt> function has access to the configured i18n formatting settings and can retrieve the format string for a given setting name:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">get_format</span><span class="p">(</span><span class="s1">'DATE_FORMAT'</span><span class="p">));</span>
<span class="c1">// 'N j, Y'</span>
</pre></div>
</div>
<p><font id="205">It has access to the following settings:</font></p>
<ul class="simple">
<li><a class="reference internal" href="../../ref/settings.html#std:setting-DATE_FORMAT"><font id="518">DATE_FORMAT</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-DATE_INPUT_FORMATS"><font id="519">DATE_INPUT_FORMATS</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-DATETIME_FORMAT"><font id="520">DATETIME_FORMAT</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-DATETIME_INPUT_FORMATS"><font id="521">DATETIME_INPUT_FORMATS</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-DECIMAL_SEPARATOR"><font id="522">DECIMAL_SEPARATOR</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-FIRST_DAY_OF_WEEK"><font id="523">FIRST_DAY_OF_WEEK</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-MONTH_DAY_FORMAT"><font id="524">MONTH_DAY_FORMAT</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-NUMBER_GROUPING"><font id="525">NUMBER_GROUPING</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-SHORT_DATE_FORMAT"><font id="526">SHORT_DATE_FORMAT</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-SHORT_DATETIME_FORMAT"><font id="527">SHORT_DATETIME_FORMAT</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-THOUSAND_SEPARATOR"><font id="528">THOUSAND_SEPARATOR</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-TIME_FORMAT"><font id="529">TIME_FORMAT</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-TIME_INPUT_FORMATS"><font id="530">TIME_INPUT_FORMATS</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-YEAR_MONTH_FORMAT"><font id="531">YEAR_MONTH_FORMAT</font></a></li>
</ul>
<p><font id="206">This is useful for maintaining formatting consistency with the Python-rendered values.</font></p>
</div>
<div class="section" id="s-gettext-noop">
<span id="gettext-noop"></span><h4><font id="480">gettext_noop</font><a class="headerlink" href="translation.html#gettext-noop" title="Permalink to this headline">¶</a></h4>
<p><font id="207">This emulates the <tt class="docutils literal"><span class="pre">gettext</span></tt> function but does nothing, returning whatever is passed to it:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">gettext_noop</span><span class="p">(</span><span class="s1">'this will not be translated'</span><span class="p">));</span>
</pre></div>
</div>
<p><font id="208">This is useful for stubbing out portions of the code that will need translation in the future.</font></p>
</div>
<div class="section" id="s-pgettext">
<span id="pgettext"></span><h4><font id="481">pgettext</font><a class="headerlink" href="translation.html#pgettext" title="Permalink to this headline">¶</a></h4>
<p><font id="209">The <tt class="docutils literal"><span class="pre">pgettext</span></tt> function behaves like the Python variant (<a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.pgettext" title="django.utils.translation.pgettext"><tt class="xref py py-func docutils literal"><span class="pre">pgettext()</span></tt></a>), providing a contextually translated word:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">pgettext</span><span class="p">(</span><span class="s1">'month name'</span><span class="p">,</span> <span class="s1">'May'</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="s-npgettext">
<span id="npgettext"></span><h4><font id="482">npgettext</font><a class="headerlink" href="translation.html#npgettext" title="Permalink to this headline">¶</a></h4>
<p><font id="210">The <tt class="docutils literal"><span class="pre">npgettext</span></tt> function also behaves like the Python variant (<a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.npgettext" title="django.utils.translation.npgettext"><tt class="xref py py-func docutils literal"><span class="pre">npgettext()</span></tt></a>), providing a <strong>pluralized</strong> contextually translated word:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">npgettext</span><span class="p">(</span><span class="s1">'group'</span><span class="p">,</span> <span class="s1">'party'</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
<span class="c1">// party</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">npgettext</span><span class="p">(</span><span class="s1">'group'</span><span class="p">,</span> <span class="s1">'party'</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span>
<span class="c1">// parties</span>
</pre></div>
</div>
</div>
<div class="section" id="s-pluralidx">
<span id="pluralidx"></span><h4><font id="483">pluralidx</font><a class="headerlink" href="translation.html#pluralidx" title="Permalink to this headline">¶</a></h4>
<p><font id="211">The <tt class="docutils literal"><span class="pre">pluralidx</span></tt> function works in a similar way to the <a class="reference internal" href="../../ref/templates/builtins.html#std:templatefilter-pluralize"><tt class="xref std std-tfilter docutils literal"><span class="pre">pluralize</span></tt></a> template filter, determining if a given <tt class="docutils literal"><span class="pre">count</span></tt> should use a plural form of a word or not:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">pluralidx</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
<span class="c1">// true</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">pluralidx</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="c1">// false</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">pluralidx</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="c1">// true</span>
</pre></div>
</div>
<p><font id="212">In the simplest case, if no custom pluralization is needed, this returns <tt class="docutils literal"><span class="pre">false</span></tt> for the integer <tt class="docutils literal"><span class="pre">1</span></tt> and <tt class="docutils literal"><span class="pre">true</span></tt> for all other numbers.</font></p>
<p><font id="213">However, pluralization is not this simple in all languages. </font><font id="214">If the language does not support pluralization, an empty value is provided.</font></p>
<p><font id="215">Additionally, if there are complex rules around pluralization, the catalog view will render a conditional expression. </font><font id="216">This will evaluate to either a <tt class="docutils literal"><span class="pre">true</span></tt> (should pluralize) or <tt class="docutils literal"><span class="pre">false</span></tt> (should <strong>not</strong> pluralize) value.</font></p>
</div>
</div>
<div class="section" id="s-note-on-performance">
<span id="note-on-performance"></span><h3><font id="448">Note on performance</font><a class="headerlink" href="translation.html#note-on-performance" title="Permalink to this headline">¶</a></h3>
<p><font id="217">The <a class="reference internal" href="translation.html#django.views.i18n.javascript_catalog" title="django.views.i18n.javascript_catalog"><tt class="xref py py-func docutils literal"><span class="pre">javascript_catalog()</span></tt></a> view generates the catalog from <tt class="docutils literal"><span class="pre">.mo</span></tt> files on every request. </font><font id="218">Since its output is constant — at least for a given version of a site — it’s a good candidate for caching.</font></p>
<p><font id="219">Server-side caching will reduce CPU load. </font><font id="220">It’s easily implemented with the <a class="reference internal" href="../cache.html#django.views.decorators.cache.cache_page" title="django.views.decorators.cache.cache_page"><tt class="xref py py-func docutils literal"><span class="pre">cache_page()</span></tt></a> decorator. </font><font id="221">To trigger cache invalidation when your translations change, provide a version-dependent key prefix, as shown in the example below, or map the view at a version-dependent URL.</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.views.decorators.cache</span> <span class="kn">import</span> <span class="n">cache_page</span>
<span class="kn">from</span> <span class="nn">django.views.i18n</span> <span class="kn">import</span> <span class="n">javascript_catalog</span>

<span class="c"># The value returned by get_version() must change when translations change.</span>
<span class="nd">@cache_page</span><span class="p">(</span><span class="mi">86400</span><span class="p">,</span> <span class="n">key_prefix</span><span class="o">=</span><span class="s">'js18n-</span><span class="si">%s</span><span class="s">'</span> <span class="o">%</span> <span class="n">get_version</span><span class="p">())</span>
<span class="k">def</span> <span class="nf">cached_javascript_catalog</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'djangojs'</span><span class="p">,</span> <span class="n">packages</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">javascript_catalog</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">packages</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="222">Client-side caching will save bandwidth and make your site load faster. </font><font id="223">If you’re using ETags (<a class="reference internal" href="../../ref/settings.html#std:setting-USE_ETAGS"><tt class="xref std std-setting docutils literal"><span class="pre">USE_ETAGS</span> <span class="pre">=</span> <span class="pre">True</span></tt></a>), you’re already covered. </font><font id="224">Otherwise, you can apply <a class="reference internal" href="../conditional-view-processing.html#conditional-decorators"><em>conditional decorators</em></a>. </font><font id="225">In the following example, the cache is invalidated whenever you restart your application server.</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span> <span class="nn">django.views.decorators.http</span> <span class="kn">import</span> <span class="n">last_modified</span>
<span class="kn">from</span> <span class="nn">django.views.i18n</span> <span class="kn">import</span> <span class="n">javascript_catalog</span>

<span class="n">last_modified_date</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="nd">@last_modified</span><span class="p">(</span><span class="k">lambda</span> <span class="n">req</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="n">last_modified_date</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cached_javascript_catalog</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="s">'djangojs'</span><span class="p">,</span> <span class="n">packages</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">javascript_catalog</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">packages</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="226">You can even pre-generate the JavaScript catalog as part of your deployment procedure and serve it as a static file. </font><font id="227">This radical technique is implemented in <a class="reference external" href="http://django-statici18n.readthedocs.org/en/latest/">django-statici18n</a>.</font></p>
</div>
</div>
<div class="section" id="s-module-django.conf.urls.i18n">
<span id="s-internationalization-in-url-patterns"></span><span id="s-url-internationalization"></span><span id="module-django.conf.urls.i18n"></span><span id="internationalization-in-url-patterns"></span><span id="url-internationalization"></span><h2><font id="428">Internationalization: in URL patterns</font><a class="headerlink" href="translation.html#module-django.conf.urls.i18n" title="Permalink to this headline">¶</a></h2>
<p><font id="228">Django provides two mechanisms to internationalize URL patterns:</font></p>
<ul class="simple">
<li><font id="532">Adding the language prefix to the root of the URL patterns to make it possible for <a class="reference internal" href="../../ref/middleware.html#django.middleware.locale.LocaleMiddleware" title="django.middleware.locale.LocaleMiddleware"><tt class="xref py py-class docutils literal"><span class="pre">LocaleMiddleware</span></tt></a> to detect the language to activate from the requested URL.</font></li>
<li><font id="533">Making URL patterns themselves translatable via the <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext_lazy" title="django.utils.translation.ugettext_lazy"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.ugettext_lazy()</span></tt></a> function.</font></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title"><font id="229">Warning</font></p>
<p class="last"><font id="230">Using either one of these features requires that an active language be set for each request; </font><font id="231">in other words, you need to have <a class="reference internal" href="../../ref/middleware.html#django.middleware.locale.LocaleMiddleware" title="django.middleware.locale.LocaleMiddleware"><tt class="xref py py-class docutils literal"><span class="pre">django.middleware.locale.LocaleMiddleware</span></tt></a> in your <a class="reference internal" href="../../ref/settings.html#std:setting-MIDDLEWARE_CLASSES"><tt class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></tt></a> setting.</font></p>
</div>
<div class="section" id="s-language-prefix-in-url-patterns">
<span id="language-prefix-in-url-patterns"></span><h3><font id="449">Language prefix in URL patterns</font><a class="headerlink" href="translation.html#language-prefix-in-url-patterns" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="django.conf.urls.i18n.i18n_patterns">
<tt class="descname">i18n_patterns</tt>(<em>prefix</em>, <em>pattern_description</em>, <em>...</em>)<a class="reference internal" href="http://python.usyiyi.cn/django/_modules/django/conf/urls/i18n.html#i18n_patterns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="translation.html#django.conf.urls.i18n.i18n_patterns" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<div class="deprecated">
<p><font id="232"><span class="versionmodified">Deprecated since version 1.8: </span></font><font id="233">The <tt class="docutils literal"><span class="pre">prefix</span></tt> argument to <tt class="docutils literal"><span class="pre">i18n_patterns()</span></tt> has been deprecated and will not be supported in Django 2.0. </font><font id="234">Simply pass a list of <a class="reference internal" href="../../ref/urls.html#django.conf.urls.url" title="django.conf.urls.url"><tt class="xref py py-func docutils literal"><span class="pre">django.conf.urls.url()</span></tt></a> instances instead.</font></p>
</div>
<p><font id="235">This function can be used in your root URLconf and Django will automatically prepend the current active language code to all url patterns defined within <a class="reference internal" href="translation.html#django.conf.urls.i18n.i18n_patterns" title="django.conf.urls.i18n.i18n_patterns"><tt class="xref py py-func docutils literal"><span class="pre">i18n_patterns()</span></tt></a>. </font><font id="236">Example URL patterns:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">conf</span><span class="p">.</span><span class="nx">urls</span> <span class="kr">import</span> <span class="nx">include</span><span class="p">,</span> <span class="nx">url</span>
<span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">conf</span><span class="p">.</span><span class="nx">urls</span><span class="p">.</span><span class="nx">i18n</span> <span class="kr">import</span> <span class="nx">i18n_patterns</span>

<span class="nx">from</span> <span class="nx">about</span> <span class="kr">import</span> <span class="nx">views</span> <span class="nx">as</span> <span class="nx">about_views</span>
<span class="nx">from</span> <span class="nx">news</span> <span class="kr">import</span> <span class="nx">views</span> <span class="nx">as</span> <span class="nx">news_views</span>
<span class="nx">from</span> <span class="nx">sitemap</span><span class="p">.</span><span class="nx">views</span> <span class="kr">import</span> <span class="nx">sitemap</span>

<span class="nx">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^sitemap\.xml$'</span><span class="p">,</span> <span class="nx">sitemap</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'sitemap_xml'</span><span class="p">),</span>
<span class="p">]</span>

<span class="nx">news_patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^$'</span><span class="p">,</span> <span class="nx">news_views</span><span class="p">.</span><span class="nx">index</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'index'</span><span class="p">),</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^category/(?P&lt;slug&gt;[\w-]+)/$'</span><span class="p">,</span> <span class="nx">news_views</span><span class="p">.</span><span class="nx">category</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'category'</span><span class="p">),</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^(?P&lt;slug&gt;[\w-]+)/$'</span><span class="p">,</span> <span class="nx">news_views</span><span class="p">.</span><span class="nx">details</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'detail'</span><span class="p">),</span>
<span class="p">]</span>

<span class="nx">urlpatterns</span> <span class="o">+=</span> <span class="nx">i18n_patterns</span><span class="p">(</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^about/$'</span><span class="p">,</span> <span class="nx">about_views</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'about'</span><span class="p">),</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^news/'</span><span class="p">,</span> <span class="nx">include</span><span class="p">(</span><span class="nx">news_patterns</span><span class="p">,</span> <span class="nx">namespace</span><span class="o">=</span><span class="s1">'news'</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font id="237">After defining these URL patterns, Django will automatically add the language prefix to the URL patterns that were added by the <tt class="docutils literal"><span class="pre">i18n_patterns</span></tt> function. </font><font id="238">Example:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">urlresolvers</span> <span class="kr">import</span> <span class="nx">reverse</span>
<span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">translation</span> <span class="kr">import</span> <span class="nx">activate</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nx">activate</span><span class="p">(</span><span class="s1">'en'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">reverse</span><span class="p">(</span><span class="s1">'sitemap_xml'</span><span class="p">)</span>
<span class="s1">'/sitemap.xml'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">reverse</span><span class="p">(</span><span class="s1">'news:index'</span><span class="p">)</span>
<span class="s1">'/en/news/'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nx">activate</span><span class="p">(</span><span class="s1">'nl'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">reverse</span><span class="p">(</span><span class="s1">'news:detail'</span><span class="p">,</span> <span class="nx">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">'slug'</span><span class="o">:</span> <span class="s1">'news-slug'</span><span class="p">})</span>
<span class="s1">'/nl/news/news-slug/'</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title"><font id="239">Warning</font></p>
<p class="last"><font id="240"><a class="reference internal" href="translation.html#django.conf.urls.i18n.i18n_patterns" title="django.conf.urls.i18n.i18n_patterns"><tt class="xref py py-func docutils literal"><span class="pre">i18n_patterns()</span></tt></a> is only allowed in your root URLconf. </font><font id="241">Using it within an included URLconf will throw an <a class="reference internal" href="../../ref/exceptions.html#django.core.exceptions.ImproperlyConfigured" title="django.core.exceptions.ImproperlyConfigured"><tt class="xref py py-exc docutils literal"><span class="pre">ImproperlyConfigured</span></tt></a> exception.</font></p>
</div>
<div class="admonition warning">
<p class="first admonition-title"><font id="242">Warning</font></p>
<p class="last"><font id="243">Ensure that you don’t have non-prefixed URL patterns that might collide with an automatically-added language prefix.</font></p>
</div>
</div>
<div class="section" id="s-translating-url-patterns">
<span id="translating-url-patterns"></span><h3><font id="450">Translating URL patterns</font><a class="headerlink" href="translation.html#translating-url-patterns" title="Permalink to this headline">¶</a></h3>
<p><font id="244">URL patterns can also be marked translatable using the <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext_lazy" title="django.utils.translation.ugettext_lazy"><tt class="xref py py-func docutils literal"><span class="pre">ugettext_lazy()</span></tt></a> function. </font><font id="245">Example:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">conf</span><span class="p">.</span><span class="nx">urls</span> <span class="kr">import</span> <span class="nx">include</span><span class="p">,</span> <span class="nx">url</span>
<span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">conf</span><span class="p">.</span><span class="nx">urls</span><span class="p">.</span><span class="nx">i18n</span> <span class="kr">import</span> <span class="nx">i18n_patterns</span>
<span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">translation</span> <span class="kr">import</span> <span class="nx">ugettext_lazy</span> <span class="nx">as</span> <span class="nx">_</span>

<span class="nx">from</span> <span class="nx">about</span> <span class="kr">import</span> <span class="nx">views</span> <span class="nx">as</span> <span class="nx">about_views</span>
<span class="nx">from</span> <span class="nx">news</span> <span class="kr">import</span> <span class="nx">views</span> <span class="nx">as</span> <span class="nx">news_views</span>
<span class="nx">from</span> <span class="nx">sitemaps</span><span class="p">.</span><span class="nx">views</span> <span class="kr">import</span> <span class="nx">sitemap</span>

<span class="nx">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^sitemap\.xml$'</span><span class="p">,</span> <span class="nx">sitemap</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'sitemap_xml'</span><span class="p">),</span>
<span class="p">]</span>

<span class="nx">news_patterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^$'</span><span class="p">,</span> <span class="nx">news_views</span><span class="p">.</span><span class="nx">index</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'index'</span><span class="p">),</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^category/(?P&lt;slug&gt;[\w-]+)/$'</span><span class="p">),</span> <span class="nx">news_views</span><span class="p">.</span><span class="nx">category</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'category'</span><span class="p">),</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^(?P&lt;slug&gt;[\w-]+)/$'</span><span class="p">,</span> <span class="nx">news_views</span><span class="p">.</span><span class="nx">details</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'detail'</span><span class="p">),</span>
<span class="p">]</span>

<span class="nx">urlpatterns</span> <span class="o">+=</span> <span class="nx">i18n_patterns</span><span class="p">(</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^about/$'</span><span class="p">),</span> <span class="nx">about_views</span><span class="p">.</span><span class="nx">main</span><span class="p">,</span> <span class="nx">name</span><span class="o">=</span><span class="s1">'about'</span><span class="p">),</span>
    <span class="nx">url</span><span class="p">(</span><span class="nx">_</span><span class="p">(</span><span class="nx">r</span><span class="s1">'^news/'</span><span class="p">),</span> <span class="nx">include</span><span class="p">(</span><span class="nx">news_patterns</span><span class="p">,</span> <span class="nx">namespace</span><span class="o">=</span><span class="s1">'news'</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font id="246">After you’ve created the translations, the <a class="reference internal" href="../../ref/urlresolvers.html#django.core.urlresolvers.reverse" title="django.core.urlresolvers.reverse"><tt class="xref py py-func docutils literal"><span class="pre">reverse()</span></tt></a> function will return the URL in the active language. </font><font id="247">Example:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">core</span><span class="p">.</span><span class="nx">urlresolvers</span> <span class="kr">import</span> <span class="nx">reverse</span>
<span class="nx">from</span> <span class="nx">django</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">translation</span> <span class="kr">import</span> <span class="nx">activate</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nx">activate</span><span class="p">(</span><span class="s1">'en'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">reverse</span><span class="p">(</span><span class="s1">'news:category'</span><span class="p">,</span> <span class="nx">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">'slug'</span><span class="o">:</span> <span class="s1">'recent'</span><span class="p">})</span>
<span class="s1">'/en/news/category/recent/'</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nx">activate</span><span class="p">(</span><span class="s1">'nl'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">reverse</span><span class="p">(</span><span class="s1">'news:category'</span><span class="p">,</span> <span class="nx">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">'slug'</span><span class="o">:</span> <span class="s1">'recent'</span><span class="p">})</span>
<span class="s1">'/nl/nieuws/categorie/recent/'</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title"><font id="248">Warning</font></p>
<p class="last"><font id="249">In most cases, it’s best to use translated URLs only within a language-code-prefixed block of patterns (using <a class="reference internal" href="translation.html#django.conf.urls.i18n.i18n_patterns" title="django.conf.urls.i18n.i18n_patterns"><tt class="xref py py-func docutils literal"><span class="pre">i18n_patterns()</span></tt></a>), to avoid the possibility that a carelessly translated URL causes a collision with a non-translated URL pattern.</font></p>
</div>
</div>
<div class="section" id="s-reversing-in-templates">
<span id="s-id2"></span><span id="reversing-in-templates"></span><span id="id2"></span><h3><font id="451">Reversing in templates</font><a class="headerlink" href="translation.html#reversing-in-templates" title="Permalink to this headline">¶</a></h3>
<p><font id="250">If localized URLs get reversed in templates they always use the current language. </font><font id="251">To link to a URL in another language use the <a class="reference internal" href="translation.html#std:templatetag-language"><tt class="xref std std-ttag docutils literal"><span class="pre">language</span></tt></a> template tag. </font><font id="252">It enables the given language in the enclosed template section:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">i18n</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">get_available_languages</span> <span class="k">as</span> <span class="nv">languages</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">trans</span> <span class="s2">"View this category in:"</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">lang_code</span><span class="o">,</span> <span class="nv">lang_name</span> <span class="k">in</span> <span class="nv">languages</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">language</span> <span class="nv">lang_code</span> <span class="cp">%}</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">'category'</span> <span class="nv">slug</span><span class="o">=</span><span class="nv">category.slug</span> <span class="cp">%}</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">{{</span> <span class="nv">lang_name</span> <span class="cp">}}</span><span class="nt">&lt;/a&gt;</span>
    <span class="cp">{%</span> <span class="k">endlanguage</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="253">The <a class="reference internal" href="translation.html#std:templatetag-language"><tt class="xref std std-ttag docutils literal"><span class="pre">language</span></tt></a> tag expects the language code as the only argument.</font></p>
</div>
</div>
<div class="section" id="s-localization-how-to-create-language-files">
<span id="s-how-to-create-language-files"></span><span id="localization-how-to-create-language-files"></span><span id="how-to-create-language-files"></span><h2><font id="429">Localization: how to create language files</font><a class="headerlink" href="translation.html#localization-how-to-create-language-files" title="Permalink to this headline">¶</a></h2>
<p><font id="254">Once the string literals of an application have been tagged for later translation, the translation themselves need to be written (or obtained). </font><font id="255">Here’s how that works.</font></p>
<div class="section" id="s-message-files">
<span id="message-files"></span><h3><font id="452">Message files</font><a class="headerlink" href="translation.html#message-files" title="Permalink to this headline">¶</a></h3>
<p><font id="256">The first step is to create a <a class="reference internal" href="index.html#term-message-file"><em class="xref std std-term">message file</em></a> for a new language. </font><font id="257">A message file is a plain-text file, representing a single language, that contains all available translation strings and how they should be represented in the given language. </font><font id="258">Message files have a <tt class="docutils literal"><span class="pre">.po</span></tt> file extension.</font></p>
<p><font id="259">Django comes with a tool, <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a>, that automates the creation and upkeep of these files.</font></p>
<div class="admonition-gettext-utilities admonition">
<p class="first admonition-title"><font id="260">Gettext utilities</font></p>
<p><font id="261">The <tt class="docutils literal"><span class="pre">makemessages</span></tt> command (and <tt class="docutils literal"><span class="pre">compilemessages</span></tt> discussed later) use commands from the GNU gettext toolset: <tt class="docutils literal"><span class="pre">xgettext</span></tt>, <tt class="docutils literal"><span class="pre">msgfmt</span></tt>, <tt class="docutils literal"><span class="pre">msgmerge</span></tt> and <tt class="docutils literal"><span class="pre">msguniq</span></tt>.</font></p>
<p class="last"><font id="262">The minimum version of the <tt class="docutils literal"><span class="pre">gettext</span></tt> utilities supported is 0.15.</font></p>
</div>
<p><font id="263">To create or update a message file, run this command:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">django</span><span class="o">-</span><span class="nx">admin</span> <span class="nx">makemessages</span> <span class="o">-</span><span class="nx">l</span> <span class="nx">de</span>
</pre></div>
</div>
<p><font id="264">...where <tt class="docutils literal"><span class="pre">de</span></tt> is the <a class="reference internal" href="index.html#term-locale-name"><em class="xref std std-term">locale name</em></a> for the message file you want to create. </font><font id="265">For example, <tt class="docutils literal"><span class="pre">pt_BR</span></tt> for Brazilian Portuguese, <tt class="docutils literal"><span class="pre">de_AT</span></tt> for Austrian German or <tt class="docutils literal"><span class="pre">id</span></tt> for Indonesian.</font></p>
<p><font id="266">The script should be run from one of two places:</font></p>
<ul class="simple">
<li><font id="534">The root directory of your Django project (the one that contains <tt class="docutils literal"><span class="pre">manage.py</span></tt>).</font></li>
<li><font id="535">The root directory of one of your Django apps.</font></li>
</ul>
<p><font id="267">The script runs over your project source tree or your application source tree and pulls out all strings marked for translation (see <a class="reference internal" href="translation.html#how-django-discovers-translations"><em>How Django discovers translations</em></a> and be sure <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> is configured correctly). </font><font id="268">It creates (or updates) a message file in the directory <tt class="docutils literal"><span class="pre">locale/LANG/LC_MESSAGES</span></tt>. </font><font id="269">In the <tt class="docutils literal"><span class="pre">de</span></tt> example, the file will be <tt class="docutils literal"><span class="pre">locale/de/LC_MESSAGES/django.po</span></tt>.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="270">When you run <tt class="docutils literal"><span class="pre">makemessages</span></tt> from the root directory of your project, the extracted strings will be automatically distributed to the proper message files. </font><font id="271">That is, a string extracted from a file of an app containing a <tt class="docutils literal"><span class="pre">locale</span></tt> directory will go in a message file under that directory. </font><font id="272">A string extracted from a file of an app without any <tt class="docutils literal"><span class="pre">locale</span></tt> directory will either go in a message file under the directory listed first in <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> or will generate an error if <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> is empty.</font></p>
</div>
<p><font id="273">By default <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a> examines every file that has the <tt class="docutils literal"><span class="pre">.html</span></tt> or <tt class="docutils literal"><span class="pre">.txt</span></tt> file extension. </font><font id="274">In case you want to override that default, use the <tt class="docutils literal"><span class="pre">--extension</span></tt> or <tt class="docutils literal"><span class="pre">-e</span></tt> option to specify the file extensions to examine:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">django</span><span class="o">-</span><span class="nx">admin</span> <span class="nx">makemessages</span> <span class="o">-</span><span class="nx">l</span> <span class="nx">de</span> <span class="o">-</span><span class="nx">e</span> <span class="nx">txt</span>
</pre></div>
</div>
<p><font id="275">Separate multiple extensions with commas and/or use <tt class="docutils literal"><span class="pre">-e</span></tt> or <tt class="docutils literal"><span class="pre">--extension</span></tt> multiple times:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">django</span><span class="o">-</span><span class="nx">admin</span> <span class="nx">makemessages</span> <span class="o">-</span><span class="nx">l</span> <span class="nx">de</span> <span class="o">-</span><span class="nx">e</span> <span class="nx">html</span><span class="p">,</span><span class="nx">txt</span> <span class="o">-</span><span class="nx">e</span> <span class="nx">xml</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title"><font id="276">Warning</font></p>
<p class="last"><font id="277">When <a class="reference internal" href="translation.html#creating-message-files-from-js-code"><em>creating message files from JavaScript source code</em></a> you need to use the special ‘djangojs’ domain, <strong>not</strong> <tt class="docutils literal"><span class="pre">-e</span> <span class="pre">js</span></tt>.</font></p>
</div>
<div class="admonition-using-jinja2-templates admonition">
<p class="first admonition-title"><font id="278">Using Jinja2 templates?</font></p>
<p><font id="279"><a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a> doesn’t understand the syntax of Jinja2 templates. </font><font id="280">To extract strings from a project containing Jinja2 templates, use <a class="reference external" href="http://babel.pocoo.org/">Babel</a> instead.</font></p>
<p><font id="281">Here’s an example <tt class="docutils literal"><span class="pre">babel.cfg</span></tt> configuration file:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre># Extraction from Python source files
[python: **.py]

# Extraction from Jinja2 templates
[jinja2: **.jinja]
extensions = jinja2.ext.with_
</pre></div>
</div>
<p><font id="282">Make sure you list all extensions you’re using! </font><font id="283">Otherwise Babel won’t recognize the tags defined by these extensions and will ignore Jinja2 templates containing them entirely.</font></p>
<p class="last"><font id="284">Babel provides similar features to <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a>, can replace it in general, and doesn’t depend on <tt class="docutils literal"><span class="pre">gettext</span></tt>. </font><font id="285">For more information, read its documentation about <a class="reference external" href="http://babel.pocoo.org/docs/messages/">working with message catalogs</a>.</font></p>
</div>
<div class="admonition-no-gettext admonition">
<p class="first admonition-title"><font id="286">No gettext?</font></p>
<p class="last"><font id="287">If you don’t have the <tt class="docutils literal"><span class="pre">gettext</span></tt> utilities installed, <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a> will create empty files. </font><font id="288">If that’s the case, either install the <tt class="docutils literal"><span class="pre">gettext</span></tt> utilities or just copy the English message file (<tt class="docutils literal"><span class="pre">locale/en/LC_MESSAGES/django.po</span></tt>) if available and use it as a starting point; </font><font id="289">it’s just an empty translation file.</font></p>
</div>
<div class="admonition-working-on-windows admonition">
<p class="first admonition-title"><font id="290">Working on Windows?</font></p>
<p class="last"><font id="291">If you’re using Windows and need to install the GNU gettext utilities so <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a> works, see <a class="reference internal" href="translation.html#gettext-on-windows"><em>gettext on Windows</em></a> for more information.</font></p>
</div>
<p><font id="292">The format of <tt class="docutils literal"><span class="pre">.po</span></tt> files is straightforward. </font><font id="293">Each <tt class="docutils literal"><span class="pre">.po</span></tt> file contains a small bit of metadata, such as the translation maintainer’s contact information, but the bulk of the file is a list of <strong>messages</strong> – simple mappings between translation strings and the actual translated text for the particular language.</font></p>
<p><font id="294">For example, if your Django app contained a translation string for the text <tt class="docutils literal"><span class="pre">"Welcome</span> <span class="pre">to</span> <span class="pre">my</span> <span class="pre">site."</span></tt>, like so:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">_</span><span class="p">(</span><span class="s2">"Welcome to my site."</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="295">...then <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a> will have created a <tt class="docutils literal"><span class="pre">.po</span></tt> file containing the following snippet – a message:</font></p>
<div class="highlight-po"><div class="highlight"><pre><span class="kd">#: path/to/python/module.py:23</span>
<span class="nv">msgid</span> <span class="s">"Welcome to my site."</span>
<span class="nv">msgstr</span> <span class="s">""</span>
</pre></div>
</div>
<p><font id="296">A quick explanation:</font></p>
<ul class="simple">
<li><font id="536"><tt class="docutils literal"><span class="pre">msgid</span></tt> is the translation string, which appears in the source. </font><font id="537">Don’t change it.</font></li>
<li><font id="538"><tt class="docutils literal"><span class="pre">msgstr</span></tt> is where you put the language-specific translation. </font><font id="539">It starts out empty, so it’s your responsibility to change it. </font><font id="540">Make sure you keep the quotes around your translation.</font></li>
<li><font id="541">As a convenience, each message includes, in the form of a comment line prefixed with <tt class="docutils literal"><span class="pre">#</span></tt> and located above the <tt class="docutils literal"><span class="pre">msgid</span></tt> line, the filename and line number from which the translation string was gleaned.</font></li>
</ul>
<p><font id="297">Long messages are a special case. </font><font id="298">There, the first string directly after the <tt class="docutils literal"><span class="pre">msgstr</span></tt> (or <tt class="docutils literal"><span class="pre">msgid</span></tt>) is an empty string. </font><font id="299">Then the content itself will be written over the next few lines as one string per line. </font><font id="300">Those strings are directly concatenated. </font><font id="301">Don’t forget trailing spaces within the strings; </font><font id="302">otherwise, they’ll be tacked together without whitespace!</font></p>
<div class="admonition-mind-your-charset admonition">
<p class="first admonition-title"><font id="303">Mind your charset</font></p>
<p class="last"><font id="304">Due to the way the <tt class="docutils literal"><span class="pre">gettext</span></tt> tools work internally and because we want to allow non-ASCII source strings in Django’s core and your applications, you <strong>must</strong> use UTF-8 as the encoding for your PO files (the default when PO files are created). </font><font id="305">This means that everybody will be using the same encoding, which is important when Django processes the PO files.</font></p>
</div>
<p><font id="306">To reexamine all source code and templates for new translation strings and update all message files for <strong>all</strong> languages, run this:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">django</span><span class="o">-</span><span class="nx">admin</span> <span class="nx">makemessages</span> <span class="o">-</span><span class="nx">a</span>
</pre></div>
</div>
</div>
<div class="section" id="s-compiling-message-files">
<span id="compiling-message-files"></span><h3><font id="453">Compiling message files</font><a class="headerlink" href="translation.html#compiling-message-files" title="Permalink to this headline">¶</a></h3>
<p><font id="307">After you create your message file – and each time you make changes to it – you’ll need to compile it into a more efficient form, for use by <tt class="docutils literal"><span class="pre">gettext</span></tt>. </font><font id="308">Do this with the <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span></tt></a> utility.</font></p>
<p><font id="309">This tool runs over all available <tt class="docutils literal"><span class="pre">.po</span></tt> files and creates <tt class="docutils literal"><span class="pre">.mo</span></tt> files, which are binary files optimized for use by <tt class="docutils literal"><span class="pre">gettext</span></tt>. </font><font id="310">In the same directory from which you ran <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a>, run <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span></tt></a> like this:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">django</span><span class="o">-</span><span class="nx">admin</span> <span class="nx">compilemessages</span>
</pre></div>
</div>
<p><font id="311">That’s it. </font><font id="312">Your translations are ready for use.</font></p>
<div class="admonition-working-on-windows admonition">
<p class="first admonition-title"><font id="313">Working on Windows?</font></p>
<p class="last"><font id="314">If you’re using Windows and need to install the GNU gettext utilities so <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span></tt></a> works see <a class="reference internal" href="translation.html#gettext-on-windows"><em>gettext on Windows</em></a> for more information.</font></p>
</div>
<div class="admonition-po-files-encoding-and-bom-usage admonition">
<p class="first admonition-title"><font id="315">.po files: Encoding and BOM usage.</font></p>
<p class="last"><font id="316">Django only supports <tt class="docutils literal"><span class="pre">.po</span></tt> files encoded in UTF-8 and without any BOM (Byte Order Mark) so if your text editor adds such marks to the beginning of files by default then you will need to reconfigure it.</font></p>
</div>
</div>
<div class="section" id="s-creating-message-files-from-javascript-source-code">
<span id="s-creating-message-files-from-js-code"></span><span id="creating-message-files-from-javascript-source-code"></span><span id="creating-message-files-from-js-code"></span><h3><font id="454">Creating message files from JavaScript source code</font><a class="headerlink" href="translation.html#creating-message-files-from-javascript-source-code" title="Permalink to this headline">¶</a></h3>
<p><font id="317">You create and update the message files the same way as the other Django message files – with the <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a> tool. </font><font id="318">The only difference is you need to explicitly specify what in gettext parlance is known as a domain in this case the <tt class="docutils literal"><span class="pre">djangojs</span></tt> domain, by providing a <tt class="docutils literal"><span class="pre">-d</span> <span class="pre">djangojs</span></tt> parameter, like this:</font></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">django</span><span class="o">-</span><span class="nx">admin</span> <span class="nx">makemessages</span> <span class="o">-</span><span class="nx">d</span> <span class="nx">djangojs</span> <span class="o">-</span><span class="nx">l</span> <span class="nx">de</span>
</pre></div>
</div>
<p><font id="319">This would create or update the message file for JavaScript for German. </font><font id="320">After updating message files, just run <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span></tt></a> the same way as you do with normal Django message files.</font></p>
</div>
<div class="section" id="s-gettext-on-windows">
<span id="s-id3"></span><span id="gettext-on-windows"></span><span id="id3"></span><h3><font id="455">gettext</font> on Windows</h3>
<p><font id="321">This is only needed for people who either want to extract message IDs or compile message files (<tt class="docutils literal"><span class="pre">.po</span></tt>). </font><font id="322">Translation work itself just involves editing existing files of this type, but if you want to create your own message files, or want to test or compile a changed message file, you will need the <tt class="docutils literal"><span class="pre">gettext</span></tt> utilities:</font></p>
<ul>
<li><p class="first"><font id="323">Download the following zip files from the GNOME servers <a class="reference external" href="https://download.gnome.org/binaries/win32/dependencies/">https://download.gnome.org/binaries/win32/dependencies/</a></font></p>
<ul class="simple">
<li><font id="542"><tt class="docutils literal"><span class="pre">gettext-runtime-X.zip</span></tt></font></li>
<li><font id="543"><tt class="docutils literal"><span class="pre">gettext-tools-X.zip</span></tt></font></li>
</ul>
<p><font id="324"><tt class="docutils literal"><span class="pre">X</span></tt> is the version number, we are requiring <tt class="docutils literal"><span class="pre">0.15</span></tt> or higher.</font></p>
</li>
<li><p class="first"><font id="325">Extract the contents of the <tt class="docutils literal"><span class="pre">bin</span></tt> directories in both files to the same folder on your system (i.e. <tt class="docutils literal"><span class="pre">C:Program</span> <span class="pre">Filesgettext-utils</span></tt>)</font></p>
</li>
<li><p class="first"><font id="326">Update the system PATH:</font></p>
<ul class="simple">
<li><font id="544"><tt class="docutils literal"><span class="pre">Control</span> <span class="pre">Panel</span> <span class="pre">&gt;</span> <span class="pre">System</span> <span class="pre">&gt;</span> <span class="pre">Advanced</span> <span class="pre">&gt;</span> <span class="pre">Environment</span> <span class="pre">Variables</span></tt>.</font></li>
<li><font id="545">In the <tt class="docutils literal"><span class="pre">System</span> <span class="pre">variables</span></tt> list, click <tt class="docutils literal"><span class="pre">Path</span></tt>, click <tt class="docutils literal"><span class="pre">Edit</span></tt>.</font></li>
<li><font id="546">Add <tt class="docutils literal"><span class="pre">;C:Program</span> <span class="pre">Filesgettext-utilsin</span></tt> at the end of the <tt class="docutils literal"><span class="pre">Variable</span> <span class="pre">value</span></tt> field.</font></li>
</ul>
</li>
</ul>
<p><font id="327">You may also use <tt class="docutils literal"><span class="pre">gettext</span></tt> binaries you have obtained elsewhere, so long as the <tt class="docutils literal"><span class="pre">xgettext</span> <span class="pre">--version</span></tt> command works properly. </font><font id="328">Do not attempt to use Django translation utilities with a <tt class="docutils literal"><span class="pre">gettext</span></tt> package if the command <tt class="docutils literal"><span class="pre">xgettext</span> <span class="pre">--version</span></tt> entered at a Windows command prompt causes a popup window saying “xgettext.exe has generated errors and will be closed by Windows”.</font></p>
</div>
<div class="section" id="s-customizing-the-makemessages-command">
<span id="s-customizing-makemessages"></span><span id="customizing-the-makemessages-command"></span><span id="customizing-makemessages"></span><h3><font id="456">Customizing the </font><tt class="docutils literal"><span class="pre">makemessages</span></tt></h3>
<p><font id="329">If you want to pass additional parameters to <tt class="docutils literal"><span class="pre">xgettext</span></tt>, you need to create a custom <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a> command and override its <tt class="docutils literal"><span class="pre">xgettext_options</span></tt> attribute:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core.management.commands</span> <span class="kn">import</span> <span class="n">makemessages</span>

<span class="k">class</span> <span class="nc">Command</span><span class="p">(</span><span class="n">makemessages</span><span class="o">.</span><span class="n">Command</span><span class="p">):</span>
    <span class="n">xgettext_options</span> <span class="o">=</span> <span class="n">makemessages</span><span class="o">.</span><span class="n">Command</span><span class="o">.</span><span class="n">xgettext_options</span> <span class="o">+</span> <span class="p">[</span><span class="s">'--keyword=mytrans'</span><span class="p">]</span>
</pre></div>
</div>
<p><font id="330">If you need more flexibility, you could also add a new argument to your custom <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">makemessages</span></tt></a> command:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core.management.commands</span> <span class="kn">import</span> <span class="n">makemessages</span>

<span class="k">class</span> <span class="nc">Command</span><span class="p">(</span><span class="n">makemessages</span><span class="o">.</span><span class="n">Command</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">add_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Command</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_arguments</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'--extra-keyword'</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">'xgettext_keywords'</span><span class="p">,</span>
                            <span class="n">action</span><span class="o">=</span><span class="s">'append'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="n">xgettext_keywords</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">'xgettext_keywords'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xgettext_keywords</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xgettext_options</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">makemessages</span><span class="o">.</span><span class="n">Command</span><span class="o">.</span><span class="n">xgettext_options</span><span class="p">[:]</span> <span class="o">+</span>
                <span class="p">[</span><span class="s">'--keyword=</span><span class="si">%s</span><span class="s">'</span> <span class="o">%</span> <span class="n">kwd</span> <span class="k">for</span> <span class="n">kwd</span> <span class="ow">in</span> <span class="n">xgettext_keywords</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Command</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-miscellaneous">
<span id="miscellaneous"></span><h2><font id="430">Miscellaneous</font><a class="headerlink" href="translation.html#miscellaneous" title="Permalink to this headline">¶</a></h2>
<div class="section" id="s-the-set-language-redirect-view">
<span id="s-set-language-redirect-view"></span><span id="the-set-language-redirect-view"></span><span id="set-language-redirect-view"></span><h3><font id="457">The </font><tt class="docutils literal"><span class="pre">set_language</span></tt></h3>
<dl class="function">
<dt id="django.views.i18n.set_language">
<tt class="descname">set_language</tt>(<em>request</em>)<a class="reference internal" href="http://python.usyiyi.cn/django/_modules/django/views/i18n.html#set_language"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="translation.html#django.views.i18n.set_language" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<p><font id="331">As a convenience, Django comes with a view, <a class="reference internal" href="translation.html#django.views.i18n.set_language" title="django.views.i18n.set_language"><tt class="xref py py-func docutils literal"><span class="pre">django.views.i18n.set_language()</span></tt></a>, that sets a user’s language preference and redirects to a given URL or, by default, back to the previous page.</font></p>
<p><font id="332">Activate this view by adding the following line to your URLconf:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">url</span><span class="p">(</span><span class="s">r'^i18n/'</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">'django.conf.urls.i18n'</span><span class="p">)),</span>
</pre></div>
</div>
<p><font id="333">(Note that this example makes the view available at <tt class="docutils literal"><span class="pre">/i18n/setlang/</span></tt>.)</font></p>
<div class="admonition warning">
<p class="first admonition-title"><font id="334">Warning</font></p>
<p class="last"><font id="335">Make sure that you don’t include the above URL within <a class="reference internal" href="translation.html#django.conf.urls.i18n.i18n_patterns" title="django.conf.urls.i18n.i18n_patterns"><tt class="xref py py-func docutils literal"><span class="pre">i18n_patterns()</span></tt></a> - it needs to be language-independent itself to work correctly.</font></p>
</div>
<p><font id="336">The view expects to be called via the <tt class="docutils literal"><span class="pre">POST</span></tt> method, with a <tt class="docutils literal"><span class="pre">language</span></tt> parameter set in request. </font><font id="337">If session support is enabled, the view saves the language choice in the user’s session. </font><font id="338">Otherwise, it saves the language choice in a cookie that is by default named <tt class="docutils literal"><span class="pre">django_language</span></tt>. </font><font id="339">(The name can be changed through the <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_NAME"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_COOKIE_NAME</span></tt></a> setting.)</font></p>
<p><font id="340">After setting the language choice, Django redirects the user, following this algorithm:</font></p>
<ul class="simple">
<li><font id="547">Django looks for a <tt class="docutils literal"><span class="pre">next</span></tt> parameter in the <tt class="docutils literal"><span class="pre">POST</span></tt> data.</font></li>
<li><font id="548">If that doesn’t exist, or is empty, Django tries the URL in the <tt class="docutils literal"><span class="pre">Referrer</span></tt> header.</font></li>
<li><font id="549">If that’s empty – say, if a user’s browser suppresses that header – then the user will be redirected to <tt class="docutils literal"><span class="pre">/</span></tt> (the site root) as a fallback.</font></li>
</ul>
<p><font id="341">Here’s example HTML template code:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">i18n</span> <span class="cp">%}</span>
<span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">'set_language'</span> <span class="cp">%}</span><span class="s">"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
<span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"next"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">redirect_to</span> <span class="cp">}}</span><span class="s">"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;select</span> <span class="na">name=</span><span class="s">"language"</span><span class="nt">&gt;</span>
<span class="cp">{%</span> <span class="k">get_current_language</span> <span class="k">as</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">get_available_languages</span> <span class="k">as</span> <span class="nv">LANGUAGES</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">get_language_info_list</span> <span class="nv">for</span> <span class="nv">LANGUAGES</span> <span class="k">as</span> <span class="nv">languages</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">language</span> <span class="k">in</span> <span class="nv">languages</span> <span class="cp">%}</span>
<span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">language.code</span> <span class="cp">}}</span><span class="s">"</span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">language.code</span> <span class="o">==</span> <span class="nv">LANGUAGE_CODE</span> <span class="cp">%}</span> <span class="na">selected=</span><span class="s">"selected"</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="nt">&gt;</span>
    <span class="cp">{{</span> <span class="nv">language.name_local</span> <span class="cp">}}</span> (<span class="cp">{{</span> <span class="nv">language.code</span> <span class="cp">}}</span>)
<span class="nt">&lt;/option&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Go"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<p><font id="342">In this example, Django looks up the URL of the page to which the user will be redirected in the <tt class="docutils literal"><span class="pre">redirect_to</span></tt> context variable.</font></p>
</div>
<div class="section" id="s-explicitly-setting-the-active-language">
<span id="explicitly-setting-the-active-language"></span><h3><font id="458">Explicitly setting the active language</font><a class="headerlink" href="translation.html#explicitly-setting-the-active-language" title="Permalink to this headline">¶</a></h3>
<p><font id="343">You may want to set the active language for the current session explicitly. </font><font id="344">Perhaps a user’s language preference is retrieved from another system, for example. </font><font id="345">You’ve already been introduced to <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.activate" title="django.utils.translation.activate"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.activate()</span></tt></a>. </font><font id="346">That applies to the current thread only. </font><font id="347">To persist the language for the entire session, also modify <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.LANGUAGE_SESSION_KEY" title="django.utils.translation.LANGUAGE_SESSION_KEY"><tt class="xref py py-data docutils literal"><span class="pre">LANGUAGE_SESSION_KEY</span></tt></a> in the session:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">translation</span>
<span class="n">user_language</span> <span class="o">=</span> <span class="s">'fr'</span>
<span class="n">translation</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">user_language</span><span class="p">)</span>
<span class="n">request</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="n">translation</span><span class="o">.</span><span class="n">LANGUAGE_SESSION_KEY</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_language</span>
</pre></div>
</div>
<p><font id="348">You would typically want to use both: <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.activate" title="django.utils.translation.activate"><tt class="xref py py-func docutils literal"><span class="pre">django.utils.translation.activate()</span></tt></a> will change the language for this thread, and modifying the session makes this preference persist in future requests.</font></p>
<p><font id="349">If you are not using sessions, the language will persist in a cookie, whose name is configured in <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_NAME"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_COOKIE_NAME</span></tt></a>. </font><font id="350">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">translation</span>
<span class="kn">from</span> <span class="nn">django</span> <span class="kn">import</span> <span class="n">http</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="n">user_language</span> <span class="o">=</span> <span class="s">'fr'</span>
<span class="n">translation</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">user_language</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">HttpResponse</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">LANGUAGE_COOKIE_NAME</span><span class="p">,</span> <span class="n">user_language</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-using-translations-outside-views-and-templates">
<span id="using-translations-outside-views-and-templates"></span><h3><font id="459">Using translations outside views and templates</font><a class="headerlink" href="translation.html#using-translations-outside-views-and-templates" title="Permalink to this headline">¶</a></h3>
<p><font id="351">While Django provides a rich set of i18n tools for use in views and templates, it does not restrict the usage to Django-specific code. </font><font id="352">The Django translation mechanisms can be used to translate arbitrary texts to any language that is supported by Django (as long as an appropriate translation catalog exists, of course). </font><font id="353">You can load a translation catalog, activate it and translate text to language of your choice, but remember to switch back to original language, as activating a translation catalog is done on per-thread basis and such change will affect code running in the same thread.</font></p>
<p><font id="354">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">translation</span>

<span class="k">def</span> <span class="nf">welcome_translated</span><span class="p">(</span><span class="n">language</span><span class="p">):</span>
    <span class="n">cur_language</span> <span class="o">=</span> <span class="n">translation</span><span class="o">.</span><span class="n">get_language</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">translation</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">language</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">translation</span><span class="o">.</span><span class="n">ugettext</span><span class="p">(</span><span class="s">'welcome'</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">translation</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">cur_language</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>
</pre></div>
</div>
<p><font id="355">Calling this function with the value ‘de’ will give you <tt class="docutils literal"><span class="pre">"Willkommen"</span></tt>, regardless of <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_CODE"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_CODE</span></tt></a> and language set by middleware.</font></p>
<p><font id="356">Functions of particular interest are <tt class="docutils literal"><span class="pre">django.utils.translation.get_language()</span></tt> which returns the language used in the current thread, <tt class="docutils literal"><span class="pre">django.utils.translation.activate()</span></tt> which activates a translation catalog for the current thread, and <tt class="docutils literal"><span class="pre">django.utils.translation.check_for_language()</span></tt> which checks if the given language is supported by Django.</font></p>
<p><font id="357">To help write more concise code, there is also a context manager <tt class="docutils literal"><span class="pre">django.utils.translation.override()</span></tt> that stores the current language on enter and restores it on exit. </font><font id="358">With it, the above example becomes:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">translation</span>

<span class="k">def</span> <span class="nf">welcome_translated</span><span class="p">(</span><span class="n">language</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">translation</span><span class="o">.</span><span class="n">override</span><span class="p">(</span><span class="n">language</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">translation</span><span class="o">.</span><span class="n">ugettext</span><span class="p">(</span><span class="s">'welcome'</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="s-language-cookie">
<span id="language-cookie"></span><h3><font id="460">Language cookie</font><a class="headerlink" href="translation.html#language-cookie" title="Permalink to this headline">¶</a></h3>
<p><font id="359">A number of settings can be used to adjust language cookie options:</font></p>
<ul class="simple">
<li><a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_NAME"><font id="550">LANGUAGE_COOKIE_NAME</font></a></li>
</ul>
<div class="versionadded">
<span class="title">New in Django 1.7.</span> </div>
<ul class="simple">
<li><a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_AGE"><font id="551">LANGUAGE_COOKIE_AGE</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_DOMAIN"><font id="552">LANGUAGE_COOKIE_DOMAIN</font></a></li>
<li><a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_PATH"><font id="553">LANGUAGE_COOKIE_PATH</font></a></li>
</ul>
</div>
</div>
<div class="section" id="s-implementation-notes">
<span id="implementation-notes"></span><h2><font id="431">Implementation notes</font><a class="headerlink" href="translation.html#implementation-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="s-specialties-of-django-translation">
<span id="s-specialties-of-django-i18n"></span><span id="specialties-of-django-translation"></span><span id="specialties-of-django-i18n"></span><h3><font id="461">Specialties of Django translation</font><a class="headerlink" href="translation.html#specialties-of-django-translation" title="Permalink to this headline">¶</a></h3>
<p><font id="360">Django’s translation machinery uses the standard <tt class="docutils literal"><span class="pre">gettext</span></tt> module that comes with Python. </font><font id="361">If you know <tt class="docutils literal"><span class="pre">gettext</span></tt>, you might note these specialties in the way Django does translation:</font></p>
<ul class="simple">
<li><font id="554">The string domain is <tt class="docutils literal"><span class="pre">django</span></tt> or <tt class="docutils literal"><span class="pre">djangojs</span></tt>. </font><font id="555">This string domain is used to differentiate between different programs that store their data in a common message-file library (usually <tt class="docutils literal"><span class="pre">/usr/share/locale/</span></tt>). </font><font id="556">The <tt class="docutils literal"><span class="pre">django</span></tt> domain is used for python and template translation strings and is loaded into the global translation catalogs. </font><font id="557">The <tt class="docutils literal"><span class="pre">djangojs</span></tt> domain is only used for JavaScript translation catalogs to make sure that those are as small as possible.</font></li>
<li><font id="558">Django doesn’t use <tt class="docutils literal"><span class="pre">xgettext</span></tt> alone. </font><font id="559">It uses Python wrappers around <tt class="docutils literal"><span class="pre">xgettext</span></tt> and <tt class="docutils literal"><span class="pre">msgfmt</span></tt>. </font><font id="560">This is mostly for convenience.</font></li>
</ul>
</div>
<div class="section" id="s-how-django-discovers-language-preference">
<span id="s-id4"></span><span id="how-django-discovers-language-preference"></span><span id="id4"></span><h3><font id="462">How Django discovers language preference</font><a class="headerlink" href="translation.html#how-django-discovers-language-preference" title="Permalink to this headline">¶</a></h3>
<p><font id="362">Once you’ve prepared your translations – or, if you just want to use the translations that come with Django – you’ll just need to activate translation for your app.</font></p>
<p><font id="363">Behind the scenes, Django has a very flexible model of deciding which language should be used – installation-wide, for a particular user, or both.</font></p>
<p><font id="364">To set an installation-wide language preference, set <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_CODE"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_CODE</span></tt></a>. </font><font id="365">Django uses this language as the default translation – the final attempt if no better matching translation is found through one of the methods employed by the locale middleware (see below).</font></p>
<p><font id="366">If all you want is to run Django with your native language all you need to do is set <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_CODE"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_CODE</span></tt></a> and make sure the corresponding <a class="reference internal" href="index.html#term-message-file"><em class="xref std std-term">message files</em></a> and their compiled versions (<tt class="docutils literal"><span class="pre">.mo</span></tt>) exist.</font></p>
<p><font id="367">If you want to let each individual user specify which language they prefer, then you also need to use the <tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt>. </font><font id="368"><tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt> enables language selection based on data from the request. </font><font id="369">It customizes content for each user.</font></p>
<p><font id="370">To use <tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt>, add <tt class="docutils literal"><span class="pre">'django.middleware.locale.LocaleMiddleware'</span></tt> to your <a class="reference internal" href="../../ref/settings.html#std:setting-MIDDLEWARE_CLASSES"><tt class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></tt></a> setting. </font><font id="371">Because middleware order matters, you should follow these guidelines:</font></p>
<ul class="simple">
<li><font id="561">Make sure it’s one of the first middlewares installed.</font></li>
<li><font id="562">It should come after <tt class="docutils literal"><span class="pre">SessionMiddleware</span></tt>, because <tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt> makes use of session data. </font><font id="563">And it should come before <tt class="docutils literal"><span class="pre">CommonMiddleware</span></tt> because <tt class="docutils literal"><span class="pre">CommonMiddleware</span></tt> needs an activated language in order to resolve the requested URL.</font></li>
<li><font id="564">If you use <tt class="docutils literal"><span class="pre">CacheMiddleware</span></tt>, put <tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt> after it.</font></li>
</ul>
<p><font id="372">For example, your <a class="reference internal" href="../../ref/settings.html#std:setting-MIDDLEWARE_CLASSES"><tt class="xref std std-setting docutils literal"><span class="pre">MIDDLEWARE_CLASSES</span></tt></a> might look like this:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">MIDDLEWARE_CLASSES</span> <span class="o">=</span> <span class="p">(</span>
   <span class="s">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="p">,</span>
   <span class="s">'django.middleware.locale.LocaleMiddleware'</span><span class="p">,</span>
   <span class="s">'django.middleware.common.CommonMiddleware'</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font id="373">(For more on middleware, see the <a class="reference internal" href="../http/middleware.html"><em>middleware documentation</em></a>.)</font></p>
<p><font id="374"><tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt> tries to determine the user’s language preference by following this algorithm:</font></p>
<ul>
<li><p class="first"><font id="375">First, it looks for the language prefix in the requested URL. </font><font id="376">This is only performed when you are using the <tt class="docutils literal"><span class="pre">i18n_patterns</span></tt> function in your root URLconf. </font><font id="377">See <a class="reference internal" href="translation.html#url-internationalization"><em>Internationalization: in URL patterns</em></a> for more information about the language prefix and how to internationalize URL patterns.</font></p>
</li>
<li><p class="first"><font id="378">Failing that, it looks for the <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.LANGUAGE_SESSION_KEY" title="django.utils.translation.LANGUAGE_SESSION_KEY"><tt class="xref py py-data docutils literal"><span class="pre">LANGUAGE_SESSION_KEY</span></tt></a> key in the current user’s session.</font></p>
<div class="versionchanged">
<span class="title">Changed in Django 1.7:</span> <p><font id="379">In previous versions, the key was named <tt class="docutils literal"><span class="pre">django_language</span></tt>, and the <tt class="docutils literal"><span class="pre">LANGUAGE_SESSION_KEY</span></tt> constant did not exist.</font></p>
</div>
</li>
<li><p class="first"><font id="380">Failing that, it looks for a cookie.</font></p>
<p><font id="381">The name of the cookie used is set by the <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_COOKIE_NAME"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_COOKIE_NAME</span></tt></a> setting. </font><font id="382">(The default name is <tt class="docutils literal"><span class="pre">django_language</span></tt>.)</font></p>
</li>
<li><p class="first"><font id="383">Failing that, it looks at the <tt class="docutils literal"><span class="pre">Accept-Language</span></tt> HTTP header. </font><font id="384">This header is sent by your browser and tells the server which language(s) you prefer, in order by priority. </font><font id="385">Django tries each language in the header until it finds one with available translations.</font></p>
</li>
<li><p class="first"><font id="386">Failing that, it uses the global <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGE_CODE"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGE_CODE</span></tt></a> setting.</font></p>
</li>
</ul>
<p id="locale-middleware-notes"><font id="387">Notes:</font></p>
<ul>
<li><p class="first"><font id="388">In each of these places, the language preference is expected to be in the standard <a class="reference internal" href="index.html#term-language-code"><em class="xref std std-term">language format</em></a>, as a string. </font><font id="389">For example, Brazilian Portuguese is <tt class="docutils literal"><span class="pre">pt-br</span></tt>.</font></p>
</li>
<li><p class="first"><font id="390">If a base language is available but the sublanguage specified is not, Django uses the base language. </font><font id="391">For example, if a user specifies <tt class="docutils literal"><span class="pre">de-at</span></tt> (Austrian German) but Django only has <tt class="docutils literal"><span class="pre">de</span></tt> available, Django uses <tt class="docutils literal"><span class="pre">de</span></tt>.</font></p>
</li>
<li><p class="first"><font id="392">Only languages listed in the <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGES</span></tt></a> setting can be selected. </font><font id="393">If you want to restrict the language selection to a subset of provided languages (because your application doesn’t provide all those languages), set <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGES</span></tt></a> to a list of languages. </font><font id="394">For example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">LANGUAGES</span> <span class="o">=</span> <span class="p">(</span>
  <span class="p">(</span><span class="s">'de'</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">'German'</span><span class="p">)),</span>
  <span class="p">(</span><span class="s">'en'</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">'English'</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
<p><font id="395">This example restricts languages that are available for automatic selection to German and English (and any sublanguage, like de-ch or en-us).</font></p>
</li>
<li><p class="first"><font id="396">If you define a custom <a class="reference internal" href="../../ref/settings.html#std:setting-LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">LANGUAGES</span></tt></a> setting, as explained in the previous bullet, you can mark the language names as translation strings – but use <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext_lazy" title="django.utils.translation.ugettext_lazy"><tt class="xref py py-func docutils literal"><span class="pre">ugettext_lazy()</span></tt></a> instead of <a class="reference internal" href="http://python.usyiyi.cn/django/ref/utils.html#django.utils.translation.ugettext" title="django.utils.translation.ugettext"><tt class="xref py py-func docutils literal"><span class="pre">ugettext()</span></tt></a> to avoid a circular import.</font></p>
<p><font id="397">Here’s a sample settings file:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="n">LANGUAGES</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s">'de'</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">'German'</span><span class="p">)),</span>
    <span class="p">(</span><span class="s">'en'</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">'English'</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p><font id="398">Once <tt class="docutils literal"><span class="pre">LocaleMiddleware</span></tt> determines the user’s preference, it makes this preference available as <tt class="docutils literal"><span class="pre">request.</span></tt></font><font id="399">LANGUAGE_CODE for each <a class="reference internal" href="../../ref/request-response.html#django.http.HttpRequest" title="django.http.HttpRequest"><tt class="xref py py-class docutils literal"><span class="pre">HttpRequest</span></tt></a>. </font><font id="400">Feel free to read this value in your view code. </font><font id="401">Here’s a simple example:</font></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">hello_world</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">LANGUAGE_CODE</span> <span class="o">==</span> <span class="s">'de-at'</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">"You prefer to read Austrian German."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s">"You prefer to read another language."</span><span class="p">)</span>
</pre></div>
</div>
<p><font id="402">Note that, with static (middleware-less) translation, the language is in <tt class="docutils literal"><span class="pre">settings.</span></tt></font><font id="403">LANGUAGE_CODE, while with dynamic (middleware) translation, it’s in <tt class="docutils literal"><span class="pre">request.</span></tt></font><font id="404">LANGUAGE_CODE.</font></p>
</div>
<div class="section" id="s-how-django-discovers-translations">
<span id="s-id5"></span><span id="how-django-discovers-translations"></span><span id="id5"></span><h3><font id="463">How Django discovers translations</font><a class="headerlink" href="translation.html#how-django-discovers-translations" title="Permalink to this headline">¶</a></h3>
<p><font id="405">At runtime, Django builds an in-memory unified catalog of literals-translations. </font><font id="406">To achieve this it looks for translations by following this algorithm regarding the order in which it examines the different file paths to load the compiled <a class="reference internal" href="index.html#term-message-file"><em class="xref std std-term">message files</em></a> (<tt class="docutils literal"><span class="pre">.mo</span></tt>) and the precedence of multiple translations for the same literal:</font></p>
<ol class="arabic simple">
<li><font id="565">The directories listed in <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> have the highest precedence, with the ones appearing first having higher precedence than the ones appearing later.</font></li>
<li><font id="566">Then, it looks for and uses if it exists a <tt class="docutils literal"><span class="pre">locale</span></tt> directory in each of the installed apps listed in <a class="reference internal" href="../../ref/settings.html#std:setting-INSTALLED_APPS"><tt class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></tt></a>. </font><font id="567">The ones appearing first have higher precedence than the ones appearing later.</font></li>
<li><font id="568">Finally, the Django-provided base translation in <tt class="docutils literal"><span class="pre">django/conf/locale</span></tt> is used as a fallback.</font></li>
</ol>
<div class="admonition seealso">
<p class="first admonition-title"><font id="407">See also</font></p>
<p class="last"><font id="408">The translations for literals included in JavaScript assets are looked up following a similar but not identical algorithm. </font><font id="409">See the <a class="reference internal" href="translation.html#javascript-catalog-view"><em>javascript_catalog view documentation</em></a> for more details.</font></p>
</div>
<p><font id="410">In all cases the name of the directory containing the translation is expected to be named using <a class="reference internal" href="index.html#term-locale-name"><em class="xref std std-term">locale name</em></a> notation. </font><font id="411">E.g. <tt class="docutils literal"><span class="pre">de</span></tt>, <tt class="docutils literal"><span class="pre">pt_BR</span></tt>, <tt class="docutils literal"><span class="pre">es_AR</span></tt>, etc.</font></p>
<p><font id="412">This way, you can write applications that include their own translations, and you can override base translations in your project. </font><font id="413">Or, you can just build a big project out of several apps and put all translations into one big common message file specific to the project you are composing. </font><font id="414">The choice is yours.</font></p>
<p><font id="415">All message file repositories are structured the same way. </font><font id="416">They are:</font></p>
<ul class="simple">
<li><font id="569">All paths listed in <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> in your settings file are searched for <tt class="docutils literal"><span class="pre">&lt;language&gt;/LC_MESSAGES/django.(</span></tt></font><font id="570">po|mo)</font></li>
<li><font id="571"><tt class="docutils literal"><span class="pre">$APPPATH/locale/&lt;language&gt;/LC_MESSAGES/django.(</span></tt></font><font id="572">po|mo)</font></li>
<li><font id="573"><tt class="docutils literal"><span class="pre">$PYTHONPATH/django/conf/locale/&lt;language&gt;/LC_MESSAGES/django.(</span></tt></font><font id="574">po|mo)</font></li>
</ul>
<p><font id="417">To create message files, you use the <a class="reference internal" href="../../ref/django-admin.html#django-admin-makemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">makemessages</span></tt></a> tool. </font><font id="418">And you use <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span></tt></a> to produce the binary <tt class="docutils literal"><span class="pre">.mo</span></tt> files that are used by <tt class="docutils literal"><span class="pre">gettext</span></tt>.</font></p>
<p><font id="419">You can also run <a class="reference internal" href="../../ref/django-admin.html#django-admin-compilemessages"><tt class="xref std std-djadmin docutils literal"><span class="pre">django-admin</span> <span class="pre">compilemessages</span> <span class="pre">--settings=path.to.settings</span></tt></a> to make the compiler process all the directories in your <a class="reference internal" href="../../ref/settings.html#std:setting-LOCALE_PATHS"><tt class="xref std std-setting docutils literal"><span class="pre">LOCALE_PATHS</span></tt></a> setting.</font></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="yui-b" id="sidebar">
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h3><font id="464">Table Of Contents</font></h3>
<ul>
<li><a class="reference internal" href="translation.html#"><font id="575">Translation</font></a><ul>
<li><a class="reference internal" href="translation.html#overview"><font id="576">Overview</font></a></li>
<li><a class="reference internal" href="translation.html#internationalization-in-python-code"><font id="577">Internationalization: in Python code</font></a><ul>
<li><a class="reference internal" href="translation.html#standard-translation"><font id="578">Standard translation</font></a></li>
<li><a class="reference internal" href="translation.html#comments-for-translators"><font id="579">Comments for translators</font></a></li>
<li><a class="reference internal" href="translation.html#marking-strings-as-no-op"><font id="580">Marking strings as no-op</font></a></li>
<li><a class="reference internal" href="translation.html#pluralization"><font id="581">Pluralization</font></a></li>
<li><a class="reference internal" href="translation.html#contextual-markers"><font id="582">Contextual markers</font></a></li>
<li><a class="reference internal" href="translation.html#lazy-translation"><font id="583">Lazy translation</font></a><ul>
<li><a class="reference internal" href="translation.html#model-fields-and-relationships-verbose-name-and-help-text-option-values"><font id="584">None</font></a></li>
<li><a class="reference internal" href="translation.html#model-verbose-names-values"><font id="585">Model verbose names values</font></a></li>
<li><a class="reference internal" href="translation.html#model-methods-short-description-attribute-values"><font id="586">None</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#working-with-lazy-translation-objects"><font id="587">Working with lazy translation objects</font></a><ul>
<li><a class="reference internal" href="translation.html#lazy-translations-and-plural"><font id="588">Lazy translations and plural</font></a></li>
<li><a class="reference internal" href="translation.html#joining-strings-string-concat"><font id="589">Joining strings: string_concat()</font></a></li>
<li><a class="reference internal" href="translation.html#other-uses-of-lazy-in-delayed-translations"><font id="590">Other uses of lazy in delayed translations</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#localized-names-of-languages"><font id="591">Localized names of languages</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#internationalization-in-template-code"><font id="592">Internationalization: in template code</font></a><ul>
<li><a class="reference internal" href="translation.html#trans-template-tag"><font id="593">None</font></a></li>
<li><a class="reference internal" href="translation.html#blocktrans-template-tag"><font id="594">None</font></a></li>
<li><a class="reference internal" href="translation.html#string-literals-passed-to-tags-and-filters"><font id="595">String literals passed to tags and filters</font></a></li>
<li><a class="reference internal" href="translation.html#comments-for-translators-in-templates"><font id="596">Comments for translators in templates</font></a></li>
<li><a class="reference internal" href="translation.html#switching-language-in-templates"><font id="597">Switching language in templates</font></a></li>
<li><a class="reference internal" href="translation.html#other-tags"><font id="598">Other tags</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#internationalization-in-javascript-code"><font id="599">Internationalization: in JavaScript code</font></a><ul>
<li><a class="reference internal" href="translation.html#module-django.views.i18n"><font id="600">None</font></a></li>
<li><a class="reference internal" href="translation.html#using-the-javascript-translation-catalog"><font id="601">Using the JavaScript translation catalog</font></a><ul>
<li><a class="reference internal" href="translation.html#gettext"><font id="602">gettext</font></a></li>
<li><a class="reference internal" href="translation.html#ngettext"><font id="603">ngettext</font></a></li>
<li><a class="reference internal" href="translation.html#interpolate"><font id="604">interpolate</font></a></li>
<li><a class="reference internal" href="translation.html#get-format"><font id="605">get_format</font></a></li>
<li><a class="reference internal" href="translation.html#gettext-noop"><font id="606">gettext_noop</font></a></li>
<li><a class="reference internal" href="translation.html#pgettext"><font id="607">pgettext</font></a></li>
<li><a class="reference internal" href="translation.html#npgettext"><font id="608">npgettext</font></a></li>
<li><a class="reference internal" href="translation.html#pluralidx"><font id="609">pluralidx</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#note-on-performance"><font id="610">Note on performance</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#module-django.conf.urls.i18n"><font id="611">Internationalization: in URL patterns</font></a><ul>
<li><a class="reference internal" href="translation.html#language-prefix-in-url-patterns"><font id="612">Language prefix in URL patterns</font></a></li>
<li><a class="reference internal" href="translation.html#translating-url-patterns"><font id="613">Translating URL patterns</font></a></li>
<li><a class="reference internal" href="translation.html#reversing-in-templates"><font id="614">Reversing in templates</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#localization-how-to-create-language-files"><font id="615">Localization: how to create language files</font></a><ul>
<li><a class="reference internal" href="translation.html#message-files"><font id="616">Message files</font></a></li>
<li><a class="reference internal" href="translation.html#compiling-message-files"><font id="617">Compiling message files</font></a></li>
<li><a class="reference internal" href="translation.html#creating-message-files-from-javascript-source-code"><font id="618">Creating message files from JavaScript source code</font></a></li>
<li><a class="reference internal" href="translation.html#gettext-on-windows"><font id="619">None</font></a></li>
<li><a class="reference internal" href="translation.html#customizing-the-makemessages-command"><font id="620">None</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#miscellaneous"><font id="621">Miscellaneous</font></a><ul>
<li><a class="reference internal" href="translation.html#the-set-language-redirect-view"><font id="622">None</font></a></li>
<li><a class="reference internal" href="translation.html#explicitly-setting-the-active-language"><font id="623">Explicitly setting the active language</font></a></li>
<li><a class="reference internal" href="translation.html#using-translations-outside-views-and-templates"><font id="624">Using translations outside views and templates</font></a></li>
<li><a class="reference internal" href="translation.html#language-cookie"><font id="625">Language cookie</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="translation.html#implementation-notes"><font id="626">Implementation notes</font></a><ul>
<li><a class="reference internal" href="translation.html#specialties-of-django-translation"><font id="627">Specialties of Django translation</font></a></li>
<li><a class="reference internal" href="translation.html#how-django-discovers-language-preference"><font id="628">How Django discovers language preference</font></a></li>
<li><a class="reference internal" href="translation.html#how-django-discovers-translations"><font id="629">How Django discovers translations</font></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><font id="465">Browse</font></h3>
<ul>
<li><font id="630">Prev: <a href="index.html">Internationalization and localization</a></font></li>
<li><font id="631">Next: <a href="formatting.html">Format localization</a></font></li>
</ul>
<h3><font id="466">You are here:</font></h3>
<ul>
<li>
<a href="../../index.html"><font id="632">Django 1.8.2.dev20150513143415 documentation</font></a>
<ul><li><a href="../index.html"><font id="633">Using Django</font></a>
<ul><li><a href="index.html"><font id="634">Internationalization and localization</font></a>
<ul><li><font id="635">Translation</font></li></ul>
</li></ul></li></ul>
</li>
</ul>
<h3><font id="467">This Page</font></h3>
<ul class="this-page-menu">
<li><a href="http://python.usyiyi.cn/django/_sources/topics/i18n/translation.txt" rel="nofollow"><font id="636">For example, an English translation may be <tt class="docutils literal"><span class="pre">"Today</span> <span class="pre">is</span> <span class="pre">November</span> <span class="pre">26."</span></tt>, while a Spanish translation may be <tt class="docutils literal"><span class="pre">"Hoy</span> <span class="pre">es</span> <span class="pre">26</span> <span class="pre">de</span> <span class="pre">Noviembre."</span></tt> – with the month and the day placeholders swapped.</font></a></li>
</ul>
<div id="searchbox" style="display: none">
<h3><font id="468">Quick search</font></h3>
<form action="http://python.usyiyi.cn/django/search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%"><font id="420"> Enter search terms or a module, class or function name. </font></p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<h3><font id="469">Last update:</font></h3>
<p class="topless"><font id="421">May 13, 2015</font></p>
</div>
</div>
<div id="ft">
<div class="nav">
    « <a href="index.html" title="Internationalization and localization">previous</a>
     |
    <a accesskey="U" href="../index.html" title="Using Django">up</a>
   |
    <a href="formatting.html" title="Format localization">next</a> »</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div id="disqus_thread"></div><br>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'djangocn'; // required: replace example with your forum shortname
    var disqus_identifier = '/django/topics/i18n/translation';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="http://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<link href="http://python.usyiyi.cn/django/_static/ms_translator.css" rel="stylesheet" type="text/css"/>
<script src="http://python.usyiyi.cn/django/_static/ms_translator.js" type="text/javascript"></script>
<script src="http://python.usyiyi.cn/django/_static/jquery-ui-1.9.2.custom.min.js" type="text/javascript"></script>
<div id="MicrosoftTranslator" style="display:none; position: absolute; z-index: 2147483647; margin: 0px; border: 2px solid rgb(210, 210, 210); padding: 0px; color: rgb(0, 0, 0); background-color: rgb(230, 230, 230); font-family: Arial,Helvetica,Sans-Serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 12px; line-height: normal; direction: ltr; text-align: left; left: 274px; top: 2048.03px; min-width: 400px;">
    <div id="MSTCClose" style="float: right;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/tooltip_close.gif">
      </a>
    </div>
    
    <div id="MSTCPopDown" style="float: right;" style="display: none;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/popdown.gif">
      </a>
    </div>
    <div id="MSTCPopUP" style="float: right;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/popup.gif">
      </a>
    </div>
    
    <div id="MSTCTitle" style="margin: 4px 4px 8px; font-weight: bold;">原文
    </div>
    
    <div style="direction: ltr; text-align: left;">
      <span id="MSTCOrigion" style="display: inline-block; margin: 0px 4px 4px;"> </span>
    </div>
    
    <div id="MicrosoftTranslatorCommunity" class="MSTCltr">
      <div id="MSTCContent">
        <a id="MSTCExpandLink">
          <span id="MSTCImprove">改进翻译</span>
          <span id="MSTCSuggest">最小化</span>
          <img src="http://python.usyiyi.cn/django/_static/ctftoggledown.gif" id="MSTCToggleDown">
          <img src="http://python.usyiyi.cn/django/_static/ctftoggleup.gif" id="MSTCToggleUp">
        </a>
        <div id="MSTCRootPanel">
          <span id="MSTCLoading" style="display: none;">正在加载...</span>
          <div style="display: none;" id="MSTCTransPanelError">
            <div class="MSTCTableRow">
              <div class="MSTCTransPanelExc MSTCTableCell">
                <img style="border-width:0px;" src="http://python.usyiyi.cn/django/_static/error_exclamation.gif" id="ExclamationImage">
              </div>
              <div class="MSTCTableCell">
                <span id="MSTCTransPanelErrorMsg"></span>
              </div>
            </div>
            <div class="MSTCTableRow">
              <div class="MSTCTableCell"></div>
              <div class="MSTCTableCell MSTCFlipHoriz">
                <input type="image" style="border-width:0px;" src="http://python.usyiyi.cn/django/_static/error_OK.gif" class="MSTCErrorButtons" id="MSTCOKImgBtn" name="MSTCOKImgBtn">
              </div>
            </div>
          </div>
          
          <div id="MSTCTransPanel">
          </div>
          
          <div id="MSTCPrevNextPanel">
            <a id="MSTCPrevLink" style='border-right-width: 1px;border-right-style: solid;padding-right: 5px;'>
              <span>上一页</span>
            </a>
            <a style='color: black; border-right-width: 1px;border-right-style: solid;padding-right: 5px;'>
              <span>第</span>
              <span id="MSTCPage"></span>
              <span>页</span>
            </a>
            <a id="MSTCNextLink" style='padding-left: 5px;'>
              <span>下一页</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>