<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>The Django template language — Django 1.8.2 中文文档</title>
<link href="../../_static/default.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/pygments.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.8.2.dev20150513143415',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
<script src="../../_static/jquery.js" type="text/javascript"></script>
<script src="../../_static/underscore.js" type="text/javascript"></script>
<script src="../../_static/doctools.js" type="text/javascript"></script>
<link href="../../index.html" rel="top" title="Django 1.8.2.dev20150513143415 documentation"/>
<link href="index.html" rel="up" title="Templates"/>
<link href="builtins.html" rel="next" title="Built-in template tags and filters"/>
<link href="index.html" rel="prev" title="Templates"/>
<script src="http://python.usyiyi.cn/django/templatebuiltins.js" type="text/javascript"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='http://python.usyiyi.cn/django/ref/templates/&quot;&#32;+&#32;base&#32;+&#32;&quot;#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='http://python.usyiyi.cn/django/ref/templates/&quot;&#32;+&#32;base&#32;+&#32;&quot;#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);
</script>
</head>
<body>
<div class="document">
<div class="yui-t6" id="custom-doc">
<div id="hd">
<h1><font id="197">Django 1.8.2 文档</font></h1>
<div id="global-nav">
<a href="../../index.html" title="Home page">Home</a>  |
        <a href="../../contents.html" title="Table of contents">Table of contents</a>  |
        <a href="../../genindex.html" title="Global index">Index</a>  |
        <a href="../../py-modindex.html" title="Module index">Modules</a>
</div>
<div class="nav">
    « <a href="index.html" title="Templates">previous</a>
     |
    <a accesskey="U" href="../index.html" title="API Reference">up</a>
   |
    <a href="builtins.html" title="Built-in template tags and filters">next</a> »</div>
</div>
<div id="bd">
<div id="yui-main">
<div class="yui-b">
<div class="yui-g" id="ref-templates-language">
<div class="section" id="s-the-django-template-language">
<span id="the-django-template-language"></span><h1><font id="198">Django模版语言</font><a class="headerlink" href="language.html#the-django-template-language" title="Permalink to this headline">¶</a></h1>
<p><font id="1">
本文将介绍Django模版系统的语法。</font><font id="2">如果您需要更多该系统如何工作的技术细节，以及希望扩展它，请浏览 <a class="reference internal" href="api.html"><em>The Django template language: for Python programmers</em></a>.</font></p>
<p><font id="3">
Django模版语言的设计致力于在性能和简单上取得平衡。</font><font id="4">
它的设计使习惯于使用HTML的人也能够自如应对。</font><font id="5">如果您有过使用其他模版语言的经验，像是 <a class="reference external" href="http://www.smarty.net/">Smarty</a> 或者 <a class="reference external" href="http://jinja.pocoo.org/">Jinja2</a>, 那么您将对Django的模版语言感到一见如故。</font></p>
<div class="admonition-philosophy admonition">
<p class="first admonition-title"><font id="6">理念</font></p>
<p><font id="7">
如果您有过编程背景，或者您使用过一些在HTML中直接混入程序代码的语言，那么现在您需要记住，Django的模版系统并不是简单的将Python嵌入到HTML中。</font><font id="8">
设计决定了：模版系统致力于表达外观，而不是程序逻辑。</font></p>
<p class="last"><font id="9">Django的模版系统提供了和一些程序结构功能类似的标签——用于布尔判断的 <a class="reference internal" href="builtins.html#std:templatetag-if"><tt class="xref std std-ttag docutils literal"><span class="pre">if</span></tt></a> 标签, 用于循环的 <a class="reference internal" href="builtins.html#std:templatetag-for"><tt class="xref std std-ttag docutils literal"><span class="pre">for</span></tt></a> 标签等等。——但是这些都不是简单的作为Python代码那样来执行的，并且，模版系统也不会随意执行Python表达式。</font><font id="10">只有下面列表中的标签、过滤器和语法才是默认就被支持的。 （但是您也可以根据需要添加 <a class="reference internal" href="../../howto/custom-template-tags.html"><em> 您自己的扩展 </em></a> &nbsp;到模版语言中）。</font></p>
</div>
<div class="section" id="s-templates">
<span id="templates"></span><h2><font id="199">模版</font><a class="headerlink" href="language.html#templates" title="Permalink to this headline">¶</a></h2>
<p><font id="11">模版是纯文本文件。</font><font id="12">它可以产生任何基于文本的的格式（HTML，XML，CSV等等）。</font></p>
<p><font id="13">模版包括在使用时会被值替换掉的 <strong>变量</strong>，和控制模版逻辑的 <strong>标签</strong>。</font></p>
<p><font id="14">下面是一个小模版，它说明了一些基本的元素。</font><font id="15">后面的文档中会解释每个元素。</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">"base_generic.html"</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}{{</span> <span class="nv">section.title</span> <span class="cp">}}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="nt">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">section.title</span> <span class="cp">}}</span><span class="nt">&lt;/h1&gt;</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">story</span> <span class="k">in</span> <span class="nv">story_list</span> <span class="cp">%}</span>
<span class="nt">&lt;h2&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">story.get_absolute_url</span> <span class="cp">}}</span><span class="s">"</span><span class="nt">&gt;</span>
    <span class="cp">{{</span> <span class="nv">story.headline</span><span class="o">|</span><span class="nf">upper</span> <span class="cp">}}</span>
  <span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;p&gt;</span><span class="cp">{{</span> <span class="nv">story.tease</span><span class="o">|</span><span class="nf">truncatewords</span><span class="s2">:"100"</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<div class="admonition-philosophy admonition">
<p class="first admonition-title"><font id="16">理念</font></p>
<p><font id="17">为什么要使用基于文本的模版，而不是基于XML的（比如Zope的TAL）呢？</font><font id="18">我们希望Django的模版语言可以用在更多的地方，而不仅仅是XML/HTML模版。</font><font id="19">在线上世界，我们在email、Javascript和CSV中使用它。</font><font id="20">你可以在任何基于文本的格式中使用这个模版语言。</font></p>
<p class="last"><font id="21">还有，让人类编辑XML简直是施虐狂的做法！</font></p>
</div>
</div>
<div class="section" id="s-variables">
<span id="variables"></span><h2><font id="200">变量</font><a class="headerlink" href="language.html#variables" title="Permalink to this headline">¶</a></h2>
<p><font id="22">变量看起来就像是这样： <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">variable</span> <span class="pre">}}</span></tt>. </font><font id="263">当模版引擎遇到一个变量，它将计算这个变量，然后用结果替换掉它本身。</font><font id="264">变量的命名包括任何字母数字以及下划线 (<tt class="docutils literal"><span class="pre">"_"</span></tt>)的组合。</font><font id="265">点(<tt class="docutils literal"><span class="pre">"."</span></tt>) 也在会变量部分中出现，不过它有特殊的含义，我们将在后面说明。</font><font id="266">重要的是， <em>你不能在变量名称中使用空格和标点符号。</em></font></p>
<p><font id="23">使用点 (<tt class="docutils literal"><span class="pre">.</span></tt>) 来访问变量的属性。</font></p>
<div class="admonition-behind-the-scenes admonition">
<p class="first admonition-title"><font id="24">幕后</font></p>
<p><font id="25">从技术上来说，当模版系统遇到点(".")，它将以这样的顺序查询：</font></p>
<ul class="simple">
<li><font id="220">字典查询（Dictionary lookup）</font></li>
<li><font id="221">属性或方法查询（Attribute or method lookup）</font></li>
<li><font id="222">数字索引查询（Numeric index lookup）</font></li>
</ul>
<p><font id="26">如果计算结果的值是可调用的，它将被无参数的调用。</font><font id="27">调用的结果将成为模版的值。</font></p>
<p><font id="28">这个查询顺序，会在优先于字典查询的对象上造成意想不到的行为。</font><font id="29">例如，思考下面的代码片段，它尝试循环 <tt class="docutils literal"><span class="pre">collections.defaultdict</span></tt>:</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">for</span> <span class="nv">k</span><span class="o">,</span> <span class="nv">v</span> <span class="k">in</span> <span class="nv">defaultdict.iteritems</span> <span class="cp">%}</span>
    Do something with k and v here...
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p class="last"><font id="30">因为字典查询首先发生，行为奏效了并且提供了一个默认值，而不是使用我们期望的 <tt class="docutils literal"><span class="pre">.iteritems()</span></tt> 方法。</font><font id="31">在这种情况下，考虑首先转换成字典。</font></p>
</div>
<p><font id="32">在前文的例子中， <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">section.title</span> <span class="pre">}}</span></tt>将被替换为 &nbsp;<tt class="docutils literal"><span class="pre">section</span></tt> 对象的&nbsp;<tt class="docutils literal"><span class="pre">title</span></tt> 属性。</font></p>
<p><font id="33">如果你使用的变量不存在， 模版系统将插入 <tt class="docutils literal"><span class="pre">string_if_invalid</span></tt> 选项的值， 它被默认设置为<tt class="docutils literal"><span class="pre">''</span></tt> (空字符串) 。</font></p>
<p><font id="34">注意模版表达式中的“bar”， 比如 <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">foo.bar</span> <span class="pre">}}</span></tt> 将被逐字直译为一个字符串，而不是使用变量“bar”的值，如果这样一个变量在模版上下文中存在的话。</font></p>
</div>
<div class="section" id="s-filters">
<span id="filters"></span><h2><font id="201">过滤器</font><a class="headerlink" href="language.html#filters" title="Permalink to this headline">¶</a></h2>
<p><font id="35">您可以通过使用 <strong>过滤器</strong>来改变变量的显示。</font></p>
<p><font id="36">过滤器看起来是这样的：<tt class="docutils literal"><span class="pre">{{</span> <span class="pre">name|lower</span> <span class="pre">}}</span></tt>。</font><font id="37">这将在变量 <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">name</span> <span class="pre">}}</span></tt> 被过滤器 <a class="reference internal" href="builtins.html#std:templatefilter-lower"><tt class="xref std std-tfilter docutils literal"><span class="pre">lower</span></tt></a> 过滤后再显示它的值，该过滤器将文本转换成小写。</font><font id="38">使用管道符号 (<tt class="docutils literal"><span class="pre">|</span></tt>)来应用过滤器。</font></p>
<p><font id="39">过滤器能够被“串联”。</font><font id="40">一个过滤器的输出将被应用到下一个。</font><font id="41"><tt class="docutils literal"><span class="pre">{{</span> <span class="pre">text|escape|linebreaks</span> <span class="pre">}}</span></tt> 就是一个常用的过滤器链，它编码文本内容，然后把行打破转成<tt class="docutils literal"><span class="pre">&lt;p&gt;</span></tt> 标签。</font></p>
<p><font id="42">一些过滤器带有参数。</font><font id="43">过滤器的参数看起来像是这样： <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">bio|truncatewords:30</span> <span class="pre">}}</span></tt>。</font><font id="44">这将显示 <tt class="docutils literal"><span class="pre">bio</span></tt> 变量的前30个词。</font></p>
<p><font id="45">过滤器参数包含空格的话，必须被引号包起来；例如，连接一个有逗号和空格的列表，你需要使用 <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">list|join:",</span> <span class="pre">"</span> <span class="pre">}}</span></tt>。</font></p>
<p><font id="46">Django提供了大约六十个内置的模版过滤器。</font><font id="47">你可以在 <a class="reference internal" href="builtins.html#ref-templates-builtins-filters"><em>内置过滤器参考手册</em></a>中阅读全部关于它们的信息。</font><font id="48">为了体验一下它们的作用，这里有一些常用的模版过滤器：</font></p>
<dl class="docutils">
<dt><a class="reference internal" href="builtins.html#std:templatefilter-default"><tt class="xref std std-tfilter docutils literal"><span class="pre">default</span></tt></a></dt>
<dd><p class="first"><font id="49">如果一个变量是false或者为空，使用给定的默认值。</font><font id="50">否则，使用变量的值。</font><font id="51">例如：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">value</span><span class="o">|</span><span class="nf">default</span><span class="s2">:"nothing"</span> <span class="cp">}}</span>
</pre></div>
</div>
<p class="last"><font id="52">如果 <tt class="docutils literal"><span class="pre">value</span></tt>没有被提供，或者为空， 上面的例子将显示“<tt class="docutils literal"><span class="pre">nothing</span></tt>”。</font></p>
</dd>
<dt><a class="reference internal" href="builtins.html#std:templatefilter-length"><tt class="xref std std-tfilter docutils literal"><span class="pre">length</span></tt></a></dt>
<dd><p class="first"><font id="53">返回值的长度。</font><font id="54">它对字符串和列表都起作用。</font><font id="55">例如：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">value</span><span class="o">|</span><span class="nf">length</span> <span class="cp">}}</span>
</pre></div>
</div>
<p class="last"><font id="56">如果 <tt class="docutils literal"><span class="pre">value</span></tt> 是 <tt class="docutils literal"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c',</span> <span class="pre">'d']</span></tt>，那么输出是 <tt class="docutils literal"><span class="pre">4</span></tt>。</font></p>
</dd>
<dt><a class="reference internal" href="builtins.html#std:templatefilter-filesizeformat"><tt class="xref std std-tfilter docutils literal"><span class="pre">filesizeformat</span></tt></a></dt>
<dd><p class="first"><font id="57">将该数值格式化为一个 “人类可读的” 文件容量大小 （例如 <tt class="docutils literal"><span class="pre">'13</span> <span class="pre">KB'</span></tt>, <tt class="docutils literal"><span class="pre">'4.1</span> <span class="pre">MB'</span></tt>, <tt class="docutils literal"><span class="pre">'102</span> <span class="pre">bytes'</span></tt>, 等等）。</font><font id="58">例如：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">value</span><span class="o">|</span><span class="nf">filesizeformat</span> <span class="cp">}}</span>
</pre></div>
</div>
<p class="last"><font id="59">如果 <tt class="docutils literal"><span class="pre">value</span></tt> 是 123456789，输出将会是 <tt class="docutils literal"><span class="pre">117.7</span> <span class="pre">MB</span></tt>。</font></p>
</dd>
</dl>
<p><font id="60">再说一下，这仅仅是一些例子；</font><font id="61">查看 <a class="reference internal" href="builtins.html#ref-templates-builtins-filters"><em>内置过滤器参考手册</em></a> 来获取完整的列表。</font></p>
<p><font id="62">您也可以创建自己的自定义模版过滤器；</font><font id="63">参考 <a class="reference internal" href="../../howto/custom-template-tags.html"><em>自定义模版标签和过滤器</em></a>。</font></p>
<div class="admonition seealso">
<p class="first admonition-title"><font id="64">更多</font></p>
<p class="last"><font id="65">Django’s admin interface can include a complete reference of all template tags and filters available for a given site. </font><font id="66">See <a class="reference internal" href="../contrib/admin/admindocs.html"><em>The Django admin documentation generator</em></a>.</font></p>
</div>
</div>
<div class="section" id="s-tags">
<span id="tags"></span><h2><font id="202">标签</font><a class="headerlink" href="language.html#tags" title="Permalink to this headline">¶</a></h2>
<p><font id="67">标签看起来像是这样的： <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">tag</span> <span class="pre">%}</span></tt>。</font><font id="68">标签比变量更加复杂：一些在输出中创建文本，一些通过循环或逻辑来控制流程，一些加载其后的变量将使用到的额外信息到模版中。</font></p>
<p><font id="69">一些标签需要开始和结束标签 （例如<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">tag</span> <span class="pre">%}</span> <span class="pre">...</span> </tt></font><font id="70"><span class="pre">标签</span> </font><font id="71"><span class="pre">内容</span> </font><font id="72"><span class="pre">...</span> </font><font id="73"><span class="pre">{%</span> <span class="pre">endtag</span> <span class="pre">%}</span>）。</font></p>
<p><font id="74">Django自带了大约24个内置的模版标签。</font><font id="75">你可以在 <a class="reference internal" href="builtins.html#ref-templates-builtins-tags"><em>内置标签参考手册</em></a>中阅读全部关于它们的内容。</font><font id="76">为了体验一下它们的作用，这里有一些常用的标签：</font></p>
<dl class="docutils">
<dt><a class="reference internal" href="builtins.html#std:templatetag-for"><tt class="xref std std-ttag docutils literal"><span class="pre">for</span></tt></a></dt>
<dd><p class="first"><font id="77">循环数组中的每个元素。</font><font id="78">例如，显示 <tt class="docutils literal"><span class="pre">athlete_list</span></tt>中提供的运动员列表：</font></p>
<div class="last highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;ul&gt;</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">athlete</span> <span class="k">in</span> <span class="nv">athlete_list</span> <span class="cp">%}</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">{{</span> <span class="nv">athlete.name</span> <span class="cp">}}</span><span class="nt">&lt;/li&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="nt">&lt;/ul&gt;</span>
</pre></div>
</div>
</dd>
<dt><a class="reference internal" href="builtins.html#std:templatetag-if"><tt class="xref std std-ttag docutils literal"><span class="pre">if</span></tt></a>, <tt class="docutils literal"><span class="pre">elif</span></tt>, and <tt class="docutils literal"><span class="pre">else</span></tt></dt>
<dd><p class="first"><font id="79">计算一个变量，并且当变量是“true”是，显示块中的内容：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">if</span> <span class="nv">athlete_list</span> <span class="cp">%}</span>
    Number of athletes: <span class="cp">{{</span> <span class="nv">athlete_list</span><span class="o">|</span><span class="nf">length</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="nv">athlete_in_locker_room_list</span> <span class="cp">%}</span>
    Athletes should be out of the locker room soon!
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
    No athletes.
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="80">在上面的例子中，如果 <tt class="docutils literal"><span class="pre">athlete_list</span></tt> 不是空的，运动员的数量将显示为 <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">athlete_list|length</span> <span class="pre">}}</span></tt> 的输出。</font><font id="81">另一方面， 如果 <tt class="docutils literal"><span class="pre">athlete_in_locker_room_list</span></tt> 不为空， 将显示 “Athletes should be out...” 这个消息。</font><font id="82">如果两个列表都是空的，将显示 “No athletes.” 。</font></p>
<p><font id="83">您也可以在<a class="reference internal" href="builtins.html#std:templatetag-if"><tt class="xref std std-ttag docutils literal"><span class="pre">if</span></tt></a> 标签中使用过滤器和多种运算符：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">if</span> <span class="nv">athlete_list</span><span class="o">|</span><span class="nf">length</span> <span class="o">&gt;</span> <span class="m">1</span> <span class="cp">%}</span>
   Team: <span class="cp">{%</span> <span class="k">for</span> <span class="nv">athlete</span> <span class="k">in</span> <span class="nv">athlete_list</span> <span class="cp">%}</span> ... <span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span>
   Athlete: <span class="cp">{{</span> <span class="nv">athlete_list.0.name</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
<p class="last"><font id="84">当上面的例子工作时，需要注意，大多数模版过滤器返回字符串，所以使用过滤器做数学的比较通常都不会像您期望的那样工作。</font><font id="85"><a class="reference internal" href="builtins.html#std:templatefilter-length"><tt class="xref std std-tfilter docutils literal"><span class="pre">length</span></tt></a> 是一个例外。</font></p>
</dd>
<dt><a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">block</span></tt></a> and <a class="reference internal" href="builtins.html#std:templatetag-extends"><tt class="xref std std-ttag docutils literal"><span class="pre">extends</span></tt></a></dt>
<dd>Set up <a class="reference internal" href="language.html#id1">template inheritance</a> (see below), a powerful way
of cutting down on “boilerplate” in templates.</dd>
</dl>
<p><font id="86">再说一下，上面的仅仅是整个列表的一部分；</font><font id="87">查看 <a class="reference internal" href="builtins.html#ref-templates-builtins-tags"><em>内置标签参考手册</em></a> 来获取完整的列表。</font></p>
<p><font id="88">您也可以创建您自己的自定义模版标签；</font><font id="89">参考 <a class="reference internal" href="../../howto/custom-template-tags.html"><em>自定义模版标签和过滤器</em></a>。</font></p>
<div class="admonition seealso">
<p class="first admonition-title"><font id="90">更多</font></p>
<p class="last"><font id="91">Django’s admin interface can include a complete reference of all template tags and filters available for a given site. </font><font id="92">See <a class="reference internal" href="../contrib/admin/admindocs.html"><em>The Django admin documentation generator</em></a>.</font></p>
</div>
</div>
<div class="section" id="s-comments">
<span id="s-template-comments"></span><span id="comments"></span><span id="template-comments"></span><h2><font id="203">注释</font><a class="headerlink" href="language.html#comments" title="Permalink to this headline">¶</a></h2>
<p><font id="93">要注释模版中一行的部分内容，使用注释语法 <tt class="docutils literal"><span class="pre">{#</span> <span class="pre">#}</span></tt>.</font></p>
<p><font id="94">例如，这个模版将被渲染为 <tt class="docutils literal"><span class="pre">'hello'</span></tt>：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="c">{# greeting #}</span>hello
</pre></div>
</div>
<p><font id="95">注释可以包含任何模版代码，有效的或者无效的都可以。</font><font id="96">例如：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="c">{# {% if foo %}bar{% else %} #}</span>
</pre></div>
</div>
<p><font id="97">这个语法只能被用于单行注释 （在 <tt class="docutils literal"><span class="pre">{#</span></tt> 和 <tt class="docutils literal"><span class="pre">#}</span></tt> 分隔符中，不允许有新行）。</font><font id="98">如果你需要注释掉模版中的多行内容，请查看 <a class="reference internal" href="builtins.html#std:templatetag-comment"><tt class="xref std std-ttag docutils literal"><span class="pre">comment</span></tt></a> 标签。</font></p>
</div>
<div class="section" id="s-template-inheritance">
<span id="s-id1"></span><span id="template-inheritance"></span><span id="id1"></span><h2><font id="204">模版继承</font><a class="headerlink" href="language.html#template-inheritance" title="Permalink to this headline">¶</a></h2>
<p><font id="99">Django模版引擎中最强大也是最复杂的部分就是模版继承了。</font><font id="100">模版继承可以让您创建一个基本的“骨架”模版，它包含您站点中的全部元素，并且可以定义能够被子模版覆盖的 <strong>blocks</strong> 。</font></p>
<p><font id="101">通过从下面这个例子开始，可以容易的理解模版继承：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"style.css"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>My amazing site<span class="cp">{%/span&gt; <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"sidebar"</span><span class="nt">&gt;</span>
        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">sidebar</span> <span class="cp">%}</span>
        <span class="nt">&lt;ul&gt;</span>
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/blog/"</span><span class="nt">&gt;</span>Blog<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
        <span class="nt">&lt;/ul&gt;</span>
        <span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
        <span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</span></pre></div>
</div>
<p><font id="102">这个模版，我们把它叫作 <tt class="docutils literal"><span class="pre">base.html</span></tt>， 它定义了一个可以用于两列排版页面的简单HTML骨架。</font><font id="103">“子模版”的工作是用它们的内容填充空的blocks。</font></p>
<p><font id="104">在这个例子中， <a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">block</span></tt></a> 标签定义了三个可以被子模版内容填充的block。</font><font id="105">&nbsp;<a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">block</span></tt></a> 告诉模版引擎： 子模版可能会覆盖掉模版中的这些位置。</font></p>
<p><font id="106">子模版可能看起来是这样的：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">"base.html"</span> <span class="cp">%}/span&gt;

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>My amazing blog<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">for</span> <span class="nv">entry</span> <span class="k">in</span> <span class="nv">blog_entries</span> <span class="cp">%}</span>
    <span class="nt">&lt;h2&gt;</span><span class="cp">{{</span> <span class="nv">entry.title</span> <span class="cp">}}</span><span class="nt">&lt;/h2&gt;</span>
    <span class="nt">&lt;p&gt;</span><span class="cp">{{</span> <span class="nv">entry.body</span> <span class="cp">}}</span><span class="nt">&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</span></pre></div>
</div>
<p><font id="107"><a class="reference internal" href="builtins.html#std:templatetag-extends"><tt class="xref std std-ttag docutils literal"><span class="pre">extends</span></tt></a> 标签是这里的关键。</font><font id="108">它告诉模版引擎，这个模版“继承”了另一个模版。</font><font id="109">当模版系统处理这个模版时，首先，它将定位父模版——在此例中，就是“base.html”。</font></p>
<p><font id="110">那时，模版引擎将注意到 <tt class="docutils literal"><span class="pre">base.html</span></tt> 中的三个 <a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">block</span></tt></a> 标签，并用子模版中的内容来替换这些block。</font><font id="111">根据 <tt class="docutils literal"><span class="pre">blog_entries</span></tt> 的值，输出可能看起来是这样的：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"style.css"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;title&gt;</span>My amazing blog<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"sidebar"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;ul&gt;</span>
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/blog/"</span><span class="nt">&gt;</span>Blog<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
        <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/div&gt;</span>

    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"content"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;h2&gt;</span>Entry one<span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;p&gt;</span>This is my first entry.<span class="nt">&lt;/p&gt;</span>

        <span class="nt">&lt;h2&gt;</span>Entry two<span class="nt">&lt;/h2&gt;</span>
        <span class="nt">&lt;p&gt;</span>This is my second entry.<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</div>
<p><font id="112">请注意，子模版并没有定义 <tt class="docutils literal"><span class="pre">sidebar</span></tt> block，所以系统使用了父模版中的值。</font><font id="113">父模版的 <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> 标签中的内容总是被用作备选内容（fallback）。</font></p>
<p><font id="114">您可以根据需要使用多级继承。</font><font id="115">使用继承的一个常用方式是类似下面的三级结构：</font></p>
<ul class="simple">
<li><font id="223">创建一个 <tt class="docutils literal"><span class="pre">base.html</span></tt> 模版来控制您整个站点的主要视觉和体验。</font></li>
<li><font id="224">为您的站点的每一个“部分”创建一个<tt class="docutils literal"><span class="pre">base_SECTIONNAME.html</span></tt> 模版。&nbsp;</font><font id="225">例如， <tt class="docutils literal"><span class="pre">base_news.html</span></tt>, <tt class="docutils literal"><span class="pre">base_sports.html</span></tt>。</font><font id="226">这些模版都继承自 <tt class="docutils literal"><span class="pre">base.html</span></tt> ，并且包含了每部分特有的样式和设计。</font></li>
<li><font id="227">为每一种页面类型创建独立的模版，例如新闻内容或者博客文章。</font><font id="228">这些模版继承了有关的部分模版（section template）。</font></li>
</ul>
<p><font id="116">这种方式使代码得到最大程度的复用，并且使得添加内容到共享的内容区域更加简单，例如，部分范围内的导航。</font></p>
<p><font id="117">这里是使用继承的一些提示：</font></p>
<ul>
<li><p class="first"><font id="118">如果你在模版中使用 <a class="reference internal" href="builtins.html#std:templatetag-extends"><tt class="xref std std-ttag docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></tt></a> 标签，它必须是模版中的第一个标签。</font><font id="119">其他的任何情况下，模版继承都将无法工作。</font></p>
</li>
<li><p class="first"><font id="120">在base模版中设置越多的 <a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt></a> 标签越好。</font><font id="121">请记住，子模版不必定义全部父模版中的blocks，所以，你可以在大多数blocks中填充合理的默认内容，然后，只定义你需要的那一个。</font><font id="122">多一点钩子总比少一点好。</font></p>
</li>
<li><p class="first"><font id="123">如果你发现你自己在大量的模版中复制内容，那可能意味着你应该把内容移动到父模版中的一个 <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> 中。</font></p>
</li>
<li><p class="first"><font id="124">If you need to get the content of the block from the parent template, the <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">block.super</span> <span class="pre">}}</span></tt> variable will do the trick. </font><font id="125">This is useful if you want to add to the contents of a parent block instead of completely overriding it. </font><font id="126">Data inserted using <tt class="docutils literal"><span class="pre">{{</span> <span class="pre">block.super</span> <span class="pre">}}</span></tt> will not be automatically escaped (see the <a class="reference external" href="language.html#automatic-html-escaping">next section</a>), since it was already escaped, if necessary, in the parent template.</font></p>
</li>
<li><p class="first"><font id="127">为了更好的可读性，你也可以给你的 <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">endblock</span> <span class="pre">%}</span></tt> 标签一个 <em>名字</em> 。</font><font id="128">例如：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
...
<span class="cp">{%</span> <span class="k">endblock</span> <span class="nv">content</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="129">在大型模版中，这个方法帮你清楚的看到哪一个　 <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></tt> 标签被关闭了。</font></p>
</li>
</ul>
<p><font id="130">最后，请注意您并不能在一个模版中定义多个相同名字的 <a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">block</span></tt></a> 标签。</font><font id="131">这个限制的存在是因为block标签的作用是“双向”的。</font><font id="132">这个意思是，block标签不仅提供了一个坑去填，它还在 <em>父模版</em>中定义了填坑的内容。</font><font id="133">如果在一个模版中有两个名字一样的 <a class="reference internal" href="builtins.html#std:templatetag-block"><tt class="xref std std-ttag docutils literal"><span class="pre">block</span></tt></a> 标签，模版的父模版将不知道使用哪个block的内容。</font></p>
</div>
<div class="section" id="s-automatic-html-escaping">
<span id="s-id2"></span><span id="automatic-html-escaping"></span><span id="id2"></span><h2><font id="205">自动HTML转义</font><a class="headerlink" href="language.html#automatic-html-escaping" title="Permalink to this headline">¶</a></h2>
<p><font id="134">当从模版中生成HTML时，总会有这样一个风险：值可能会包含影响HTML最终呈现的字符。</font><font id="135">例如，思考这个模版片段：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>Hello, <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="136">首先，它看起来像是一个无害的方式来显示用户的名字，但是设想一下，如果用户像下面这样输入他的名字，会发生什么：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p><font id="137">使用这个名字值，模版将会被渲染成这样：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>Hello, <span class="nt">&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p><font id="138">...这意味着，浏览器将会弹出一个Javascript警示框！</font></p>
<p><font id="139">类似的，如果名字包含一个 <tt class="docutils literal"><span class="pre">'&lt;'</span></tt> 符号（比如下面这样），会发生什么呢？</font></p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;b&gt;</span>username
</pre></div>
</div>
<p><font id="140">这将会导致模版被渲染成这样：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>Hello, <span class="nt">&lt;b&gt;</span>username
</pre></div>
</div>
<p><font id="141">...进而这将导致网页的剩余部分都被加粗！</font></p>
<p><font id="142">显然，用户提交的数据都被应该被盲目的信任，并且被直接插入到你的网页中，因为一个怀有恶意的用户可能会使用这样的漏洞来做一些可能的坏事。</font><font id="143">这种类型的安全问题被叫做 <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_scripting">跨站脚本（Cross Site Scripting）</a> (XSS) 攻击。</font></p>
<p><font id="144">为避免这个问题，你有两个选择：</font></p>
<ul class="simple">
<li><font id="229">第一， 你可以确保每一个不被信任的值都通过 <a class="reference internal" href="builtins.html#std:templatefilter-escape"><tt class="xref std std-tfilter docutils literal"><span class="pre">escape</span></tt></a> 过滤器（下面的文档中将提到）运行，它将把潜在的有害HTML字符转换成无害的。</font><font id="230">This was the default solution in Django for its first few years, but the problem is that it puts the onus on <em>you</em>, the developer / template author, to ensure you’re escaping everything. </font><font id="231">It’s easy to forget to escape data.</font></li>
<li><font id="232">第二，你可以利用Django的自动HTML转义。 </font><font id="233">本节描述其余部分描述的是自动转义是如何工作的</font></li>
</ul>
<p><font id="145">By default in Django, every template automatically escapes the output of every variable tag. </font><font id="146">Specifically, these five characters are escaped:</font></p>
<ul class="simple">
<li><font id="234"><tt class="docutils literal"><span class="pre">&lt;</span></tt>会转换为<tt class="docutils literal"><span class="pre">&amp;lt;</span></tt></font></li>
<li><font id="235"><tt class="docutils literal"><span class="pre">&gt;</span></tt>会转换为<tt class="docutils literal"><span class="pre">&amp;gt;</span></tt></font></li>
<li><font id="236"><tt class="docutils literal"><span class="pre">'</span></tt> </font><font id="237">(单引号) 会转换为<tt class="docutils literal"><span class="pre">&amp;#39;</span></tt></font></li>
<li><font id="238"><tt class="docutils literal"><span class="pre">"</span></tt> (双引号)会转换为 <tt class="docutils literal"><span class="pre">&amp;quot;</span></tt></font></li>
<li><font id="239"><tt class="docutils literal"><span class="pre">&amp;</span></tt> 会转换为 <tt class="docutils literal"><span class="pre">&amp;amp;</span></tt></font></li>
</ul>
<p><font id="147">我们要再次强调这是默认行为。</font><font id="148">如果你使用Django的模板系统，会处于保护之下。</font></p>
<div class="section" id="s-how-to-turn-it-off">
<span id="how-to-turn-it-off"></span><h3><font id="208">如果关闭它</font><a class="headerlink" href="language.html#how-to-turn-it-off" title="Permalink to this headline">¶</a></h3>
<p><font id="149">如果你不希望数据自动转义，在站点、模板或者变量级别，你可以使用几种方法来关闭它。</font></p>
<p><font id="150">然而你为什么想要关闭它呢？</font><font id="151">由于有时，模板变量含有一些你<em>打算</em>渲染成原始HTML的数据，你并不想转义这些内容。</font><font id="152">例如，你可能会在数据库中储存一些HTML代码，并且直接在模板中嵌入它们。</font><font id="153">或者，你可能使用Django的模板系统来生成<em>不是</em>HTML的文本 -- 比如邮件信息。</font></p>
<div class="section" id="s-for-individual-variables">
<span id="for-individual-variables"></span><h4><font id="218">用于独立变量</font><a class="headerlink" href="language.html#for-individual-variables" title="Permalink to this headline">¶</a></h4>
<p><font id="154">使用<a class="reference internal" href="builtins.html#std:templatefilter-safe"><tt class="xref std std-tfilter docutils literal"><span class="pre">safe</span></tt></a>过滤器来关闭独立变量上的自动转移：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>This will be escaped: <span class="cp">{{</span> <span class="nv">data</span> <span class="cp">}}</span>
This will not be escaped: <span class="cp">{{</span> <span class="nv">data</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="155"><em>safe</em>是<em>safe from further escaping</em>或者<em>can be safely interpreted as HTML</em>的缩写。
</font><font id="156">在这个例子中，如果<tt class="docutils literal"><span class="pre">data</span></tt>含有<tt class="docutils literal"><span class="pre">'&lt;b&gt;'</span></tt>，输出会是：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>This will be escaped: <span class="ni">&amp;lt;</span>b<span class="ni">&amp;gt;</span>
This will not be escaped: <span class="nt">&lt;b&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="s-for-template-blocks">
<span id="for-template-blocks"></span><h4><font id="219">用于模板代码块</font><a class="headerlink" href="language.html#for-template-blocks" title="Permalink to this headline">¶</a></h4>
<p><font id="157">要控制模板上的自动转移，将模板（或者模板中的特定区域）包裹在<a class="reference internal" href="builtins.html#std:templatetag-autoescape"><tt class="xref std std-ttag docutils literal"><span class="pre">autoescape</span></tt></a>标签 中，像这样：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">autoescape</span> <span class="nv">off</span> <span class="cp">%}</span>
    Hello <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endautoescape</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="158"><a class="reference internal" href="builtins.html#std:templatetag-autoescape"><tt class="xref std std-ttag docutils literal"><span class="pre">autoescape</span></tt></a>标签接受<tt class="docutils literal"><span class="pre">on</span></tt> 或者 <tt class="docutils literal"><span class="pre">off</span></tt>作为它的参数。</font><font id="159">有时你可能想在自动转移关闭的情况下强制使用它。</font><font id="160">下面是一个模板的示例：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre>Auto-escaping is on by default. Hello <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>

<span class="cp">{%</span> <span class="k">autoescape</span> <span class="nv">off</span> <span class="cp">%}</span>
    This will not be auto-escaped: <span class="cp">{{</span> <span class="nv">data</span> <span class="cp">}}</span>.

    Nor this: <span class="cp">{{</span> <span class="nv">other_data</span> <span class="cp">}}</span>
    <span class="cp">{%</span> <span class="k">autoescape</span> <span class="nv">on</span> <span class="cp">%}</span>
        Auto-escaping applies again: <span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span>
    <span class="cp">{%</span> <span class="k">endautoescape</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endautoescape</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="161">自动转移标签作用于扩展了当前模板的模板，以及通过&nbsp;<a class="reference internal" href="builtins.html#std:templatetag-include"><tt class="xref std std-ttag docutils literal"><span class="pre">include</span></tt></a> 标签包含的模板，就像所有block标签那样。</font><font id="162">例如：</font></p>
<div class="highlight-html+django"><div class="snippet-filename">base.html</div>
<div class="highlight"><pre><span class="cp">{%</span> <span class="k">autoescape</span> <span class="nv">off</span> <span class="cp">%}</span>
<span class="nt">&lt;h1&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="nt">&lt;/h1&gt;</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endautoescape</span> <span class="cp">%}</span>
</pre></div>
</div>
<div class="highlight-html+django"><div class="snippet-filename">child.html</div>
<div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">"base.html"</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>This <span class="ni">&amp;amp;</span> that<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}{{</span> <span class="nv">greeting</span> <span class="cp">}}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="163">由于自动转义标签在base模板中关闭，它也会在child模板中关闭，导致当&nbsp;<tt class="docutils literal"><span class="pre">greeting</span></tt>变量含有<tt class="docutils literal"><span class="pre">&lt;b&gt;Hello!&lt;/b&gt;</span></tt>字符串时，会渲染HTML。</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>This <span class="ni">&amp;amp;</span> that<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;b&gt;</span>Hello!<span class="nt">&lt;/b&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-notes">
<span id="notes"></span><h3><font id="209">注释</font><a class="headerlink" href="language.html#notes" title="Permalink to this headline">¶</a></h3>
<p><font id="164">通常，模板的作用并不非常担心自动转义。</font><font id="165">Python一边的开发者（编写视图和自定义过滤器的人）需要考虑数据不应被转移的情况，以及合理地标记数据，让这些东西在模板中正常工作。
</font></p>
<p><font id="166">如果你创建了一个模板，它可能用于你不确定自动转移是否开启的环境，那么应该向任何需要转移的变量添加&nbsp;<a class="reference internal" href="builtins.html#std:templatefilter-escape"><tt class="xref std std-tfilter docutils literal"><span class="pre">escape</span></tt></a>过滤器。</font><font id="167">当自动转移打开时，<a class="reference internal" href="builtins.html#std:templatefilter-escape"><tt class="xref std std-tfilter docutils literal"><span class="pre">escape</span></tt></a>过滤器<em>双重过滤</em>数据没有任何危险 --&nbsp;<a class="reference internal" href="builtins.html#std:templatefilter-escape"><tt class="xref std std-tfilter docutils literal"><span class="pre">escape</span></tt></a>过滤器并不影响自动转义的变量。</font></p>
</div>
<div class="section" id="s-string-literals-and-automatic-escaping">
<span id="s-id3"></span><span id="string-literals-and-automatic-escaping"></span><span id="id3"></span><h3><font id="210">字符串字面值和自动转义</font><a class="headerlink" href="language.html#string-literals-and-automatic-escaping" title="Permalink to this headline">¶</a></h3>
<p><font id="168">像我们之前提到的那样，过滤器参数可以是字符串：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">data</span><span class="o">|</span><span class="nf">default</span><span class="s2">:"This is a string literal."</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="169">所有字面值字符串在插入模板时都&nbsp;<strong>不会</strong>带有任何自动转义 -- 它们的行为类似于通过&nbsp;<a class="reference internal" href="builtins.html#std:templatefilter-safe"><tt class="xref std std-tfilter docutils literal"><span class="pre">safe</span></tt></a>过滤器传递。</font><font id="170">背后的原因是，模板作者可以控制字符串字面值得内容，所以它们可以确保在模板编写时文本经过正确转义。</font></p>
<p><font id="171">也即是说你可以编写</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">data</span><span class="o">|</span><span class="nf">default</span><span class="s2">:"3 &amp;lt; 2"</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="172">...而不是：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">data</span><span class="o">|</span><span class="nf">default</span><span class="s2">:"3 &lt; 2"</span> <span class="cp">}}</span>  <span class="c">{# Bad! Don't do this. #}</span>
</pre></div>
</div>
<p><font id="173">这并不影响来源于模板自身的数据。</font><font id="174">模板内容在必要时仍然会自动转移，因为它们不受模板作者的控制。</font></p>
</div>
</div>
<div class="section" id="s-accessing-method-calls">
<span id="s-template-accessing-methods"></span><span id="accessing-method-calls"></span><span id="template-accessing-methods"></span><h2><font id="206">访问方法调用</font><a class="headerlink" href="language.html#accessing-method-calls" title="Permalink to this headline">¶</a></h2>
<p><font id="175">大多数对象上的方法调用同样可用于模板中。</font><font id="176">这意味着模板必须拥有对除了类属性（像是字段名称）和从视图中传入的变量之外的访问。</font><font id="177">例如，Django ORM提供了<a class="reference internal" href="../../topics/db/queries.html#topics-db-queries-related"><em>“entry_set”</em></a> 语法用于查找关联到外键的对象集合。</font><font id="178">所以，提供一个模型叫做“comment”，并带有一个关联到&nbsp;“task” 模型的外键，你就可以遍历给定任务附带的所有评论，像这样：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">for</span> <span class="nv">comment</span> <span class="k">in</span> <span class="nv">task.comment_set.all</span> <span class="cp">%}</span>
    <span class="cp">{{</span> <span class="nv">comment</span> <span class="cp">}}</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="179">与之类似，<a class="reference internal" href="../models/querysets.html"><em>QuerySets</em></a>提供了&nbsp;<tt class="docutils literal"><span class="pre">count()</span></tt>方法来计算含有对象的总数。</font><font id="180">因此，你可以像这样获取所有关于当前任务的评论总数：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{{</span> <span class="nv">task.comment_set.all.count</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="181">当然，你可以轻易访问已经显式定义在你自己模型上的方法：</font></p>
<div class="highlight-html+django"><div class="snippet-filename">models.py</div>
<div class="highlight"><pre>class Task(models.Model):
    def foo(self):
        return "bar"
</pre></div>
</div>
<div class="highlight-html+django"><div class="snippet-filename">template.html</div>
<div class="highlight"><pre><span class="cp">{{</span> <span class="nv">task.foo</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="182">由于Django有意限制了模板语言中逻辑处理的总数，不能够在模板中传递参数来调用方法。</font><font id="183">数据应该在视图中处理，然后传递给模板用于展示。</font></p>
</div>
<div class="section" id="s-custom-tag-and-filter-libraries">
<span id="s-loading-custom-template-libraries"></span><span id="custom-tag-and-filter-libraries"></span><span id="loading-custom-template-libraries"></span><h2><font id="207">自定义标签和过滤器库</font><a class="headerlink" href="language.html#custom-tag-and-filter-libraries" title="Permalink to this headline">¶</a></h2>
<p><font id="184">特定的应用提供自定义的标签和过滤器库。</font><font id="185">要在模板中访问它们，确保应用在<a class="reference internal" href="../settings.html#std:setting-INSTALLED_APPS"><tt class="xref std std-setting docutils literal"><span class="pre">INSTALLED_APPS</span></tt></a>之内（在这个例子中我们添加了<tt class="docutils literal"><span class="pre">'django.contrib.humanize'</span></tt>），之后在模板中使用<a class="reference internal" href="builtins.html#std:templatetag-load"><tt class="xref std std-ttag docutils literal"><span class="pre">load</span></tt></a>标签：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">humanize</span> <span class="cp">%}</span>

<span class="cp">{{</span> <span class="m">45000</span><span class="o">|</span><span class="nf">intcomma</span> <span class="cp">}}</span>
</pre></div>
</div>
<p><font id="186">上面的例子中，&nbsp;<a class="reference internal" href="builtins.html#std:templatetag-load"><tt class="xref std std-ttag docutils literal"><span class="pre">load</span></tt></a>标签加载了<tt class="docutils literal"><span class="pre">humanize</span></tt>标签库，之后我们可以使用<tt class="docutils literal"><span class="pre">intcomma</span></tt>过滤器。</font><font id="187">如果你开启了<a class="reference internal" href="../contrib/admin/admindocs.html#module-django.contrib.admindocs" title="django.contrib.admindocs: Django's admin documentation generator."><tt class="xref py py-mod docutils literal"><span class="pre">django.contrib.admindocs</span></tt></a>，你可以查询admin站点中的文档部分，来寻找你的安装中的自定义库列表。</font></p>
<p><font id="188"><a class="reference internal" href="builtins.html#std:templatetag-load"><tt class="xref std std-ttag docutils literal"><span class="pre">load</span></tt></a>标签可以接受多个库名称，由空格分隔。</font><font id="189">例如：</font></p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">humanize</span> <span class="nv">i18n</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><font id="190">关于编写你自己的自定义模板库，详见<a class="reference internal" href="../../howto/custom-template-tags.html"><em>自定义模板标签和过滤器</em></a>。</font></p>
<div class="section" id="s-custom-libraries-and-template-inheritance">
<span id="custom-libraries-and-template-inheritance"></span><h3><font id="211">自定义库和模板继承</font><a class="headerlink" href="language.html#custom-libraries-and-template-inheritance" title="Permalink to this headline">¶</a></h3>
<p><font id="191">当你加载一个自定义标签或过滤器库时，标签或过滤器只在当前模板中有效 -- 并不是带有模板继承关系的任何父模板或者子模版中都有效。</font></p>
<p><font id="192">例如，如果一个模板<tt class="docutils literal"><span class="pre">foo.html</span></tt>带有<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">humanize</span> <span class="pre">%}</span></tt>，子模版（例如，带有<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">"foo.html"</span> <span class="pre">%}</span></tt>）中<em>不能</em>&nbsp;访问humanize模板标签和过滤器。</font><font id="267">子模版需要添加自己的&nbsp;<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">humanize</span> <span class="pre">%}</span></tt>。</font></p>
<p><font id="193">这个特性是可维护性和逻辑性的缘故。</font></p>
<div class="admonition seealso">
<p class="first admonition-title"><font id="194">另见</font></p>
<dl class="last docutils">
<dt><a class="reference internal" href="index.html"><em>The Templates Reference</em></a></dt>
<dd>Covers built-in tags, built-in filters, using an alternative template,
language, and more.</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="yui-b" id="sidebar">
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h3><font id="212">目录</font></h3>
<ul>
<li><a class="reference internal" href="language.html#"><font id="240">Django 模板语言</font></a><ul>
<li><a class="reference internal" href="language.html#templates"><font id="241">模板</font></a></li>
<li><a class="reference internal" href="language.html#variables"><font id="242">变量</font></a></li>
<li><a class="reference internal" href="language.html#filters"><font id="243">过滤器</font></a></li>
<li><a class="reference internal" href="language.html#tags"><font id="244">标签</font></a></li>
<li><a class="reference internal" href="language.html#comments"><font id="245">注释</font></a></li>
<li><a class="reference internal" href="language.html#template-inheritance"><font id="246">模板继承</font></a></li>
<li><a class="reference internal" href="language.html#automatic-html-escaping"><font id="247">HTML自动转义</font></a><ul>
<li><a class="reference internal" href="language.html#how-to-turn-it-off"><font id="248">怎样关掉它</font></a><ul>
<li><a class="reference internal" href="language.html#for-individual-variables"><font id="249">对于单个变量</font></a></li>
<li><a class="reference internal" href="language.html#for-template-blocks"><font id="250">对于模板块</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="language.html#notes"><font id="251">注意</font></a></li>
<li><a class="reference internal" href="language.html#string-literals-and-automatic-escaping"><font id="252">字符串面值和自动转义
</font></a></li>
</ul>
</li>
<li><a class="reference internal" href="language.html#accessing-method-calls"><font id="253">方法调用</font></a></li>
<li><a class="reference internal" href="language.html#custom-tag-and-filter-libraries"><font id="254">自定义标签和过滤器</font></a><ul>
<li><a class="reference internal" href="language.html#custom-libraries-and-template-inheritance"><font id="255">自定义库和模板继承</font></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><font id="213">Browse</font></h3>
<ul>
<li><font id="256">Prev: <a href="index.html">Templates</a></font></li>
<li><font id="257">Next: <a href="builtins.html">Built-in template tags and filters</a></font></li>
</ul>
<h3><font id="214">你在这里：</font></h3>
<ul>
<li>
<a href="../../index.html"><font id="258">Django 1.8.2 文档</font></a>
<ul><li><a href="../index.html"><font id="259">API索引</font></a>
<ul><li><a href="index.html"><font id="260">模板</font></a>
<ul><li><font id="261">Django 模板语言</font></li></ul>
</li></ul></li></ul>
</li>
</ul>
<h3><font id="215">This Page</font></h3>
<ul class="this-page-menu">
<li><a href="http://python.usyiyi.cn/django/_sources/ref/templates/language.txt" rel="nofollow"><font id="262">显示源码</font></a></li>
</ul>
<div id="searchbox" style="display: none">
<h3><font id="216">Quick search</font></h3>
<form action="http://python.usyiyi.cn/django/search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%"><font id="195"> Enter search terms or a module, class or function name. </font></p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<h3><font id="217">最后更新：</font></h3>
<p class="topless"><font id="196">May 13, 2015</font></p>
</div>
</div>
<div id="ft">
<div class="nav">
    « <a href="index.html" title="Templates">previous</a>
     |
    <a accesskey="U" href="../index.html" title="API Reference">up</a>
   |
    <a href="builtins.html" title="Built-in template tags and filters">next</a> »</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div id="disqus_thread"></div><br>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'djangocn'; // required: replace example with your forum shortname
    var disqus_identifier = '/django/ref/templates/language.html';
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="dsq-brlink" href="http://disqus.com">comments powered by <span class="logo-disqus">Disqus</span></a>
<link href="http://python.usyiyi.cn/django/_static/ms_translator.css" rel="stylesheet" type="text/css"/>
<script src="http://python.usyiyi.cn/django/_static/ms_translator.js" type="text/javascript"></script>
<script src="http://python.usyiyi.cn/django/_static/jquery-ui-1.9.2.custom.min.js" type="text/javascript"></script>
<div id="MicrosoftTranslator" style="display:none; position: absolute; z-index: 2147483647; margin: 0px; border: 2px solid rgb(210, 210, 210); padding: 0px; color: rgb(0, 0, 0); background-color: rgb(230, 230, 230); font-family: Arial,Helvetica,Sans-Serif; font-style: normal; font-variant: normal; font-weight: normal; font-size: 12px; line-height: normal; direction: ltr; text-align: left; left: 274px; top: 2048.03px; min-width: 400px;">
    <div id="MSTCClose" style="float: right;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/tooltip_close.gif">
      </a>
    </div>
    
    <div id="MSTCPopDown" style="float: right;" style="display: none;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/popdown.gif">
      </a>
    </div>
    <div id="MSTCPopUP" style="float: right;">
      <a style="display: inline-block; cursor: pointer; text-decoration: none; vertical-align: top; border: 0px none; padding: 4px;">
        <img src="http://python.usyiyi.cn/django/_static/popup.gif">
      </a>
    </div>
    
    <div id="MSTCTitle" style="margin: 4px 4px 8px; font-weight: bold;">原文
    </div>
    
    <div style="direction: ltr; text-align: left;">
      <span id="MSTCOrigion" style="display: inline-block; margin: 0px 4px 4px;"> </span>
    </div>
    
    <div id="MicrosoftTranslatorCommunity" class="MSTCltr">
      <div id="MSTCContent">
        <a id="MSTCExpandLink">
          <span id="MSTCImprove">改进翻译</span>
          <span id="MSTCSuggest">最小化</span>
          <img src="http://python.usyiyi.cn/django/_static/ctftoggledown.gif" id="MSTCToggleDown">
          <img src="http://python.usyiyi.cn/django/_static/ctftoggleup.gif" id="MSTCToggleUp">
        </a>
        <div id="MSTCRootPanel">
          <span id="MSTCLoading" style="display: none;">正在加载...</span>
          <div style="display: none;" id="MSTCTransPanelError">
            <div class="MSTCTableRow">
              <div class="MSTCTransPanelExc MSTCTableCell">
                <img style="border-width:0px;" src="http://python.usyiyi.cn/django/_static/error_exclamation.gif" id="ExclamationImage">
              </div>
              <div class="MSTCTableCell">
                <span id="MSTCTransPanelErrorMsg"></span>
              </div>
            </div>
            <div class="MSTCTableRow">
              <div class="MSTCTableCell"></div>
              <div class="MSTCTableCell MSTCFlipHoriz">
                <input type="image" style="border-width:0px;" src="http://python.usyiyi.cn/django/_static/error_OK.gif" class="MSTCErrorButtons" id="MSTCOKImgBtn" name="MSTCOKImgBtn">
              </div>
            </div>
          </div>
          
          <div id="MSTCTransPanel">
          </div>
          
          <div id="MSTCPrevNextPanel">
            <a id="MSTCPrevLink" style='border-right-width: 1px;border-right-style: solid;padding-right: 5px;'>
              <span>上一页</span>
            </a>
            <a style='color: black; border-right-width: 1px;border-right-style: solid;padding-right: 5px;'>
              <span>第</span>
              <span id="MSTCPage"></span>
              <span>页</span>
            </a>
            <a id="MSTCNextLink" style='padding-left: 5px;'>
              <span>下一页</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

</body>
</html>