

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>oscar.apps.catalogue.abstract_models &mdash; django-oscar 1.2 documentation</title>
  

  
  

  

  
  
    

  

  
  

  
    <link rel="stylesheet" href="https://cdnmedia.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://cdnmedia.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  

  
    <link rel="top" title="django-oscar 1.2 documentation" href="../../../../index.html"/>
        <link rel="up" title="Module code" href="../../../index.html"/>
 
<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="abstract_models.html" />

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "django-oscar",
    version: "latest",
    language: "en",
    page: "_modules/oscar/apps/catalogue/abstract_models",
    builder: "sphinx",
    theme: "sphinx_rtd_theme",
    docroot: "/docs/source/",
    source_suffix: ".rst",
    api_host: "https://readthedocs.org/",
    commit: "35b09fc05d799181be9046c7447986cc5193d2ff"
  }
  // Old variables
  var doc_version = "latest";
  var doc_slug = "django-oscar";
  var page_name = "_modules/oscar/apps/catalogue/abstract_models";
  var html_theme = "sphinx_rtd_theme";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  // User Analytics Code
  _gaq.push(['user._setAccount', 'UA-45363517-1']);
  _gaq.push(['user._trackPageview']);
  // End User Analytics Code


  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->
<!-- end RTD <extrahead> -->


  
  <script src="http://django-oscar.readthedocs.org/en/latest/_modules/oscar/apps/catalogue/_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../../../index.html" class="icon icon-home"> django-oscar
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="http://django-oscar.readthedocs.org/en/latest/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../internals/sandbox.html">Sample Oscar projects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/sandbox.html#the-sandbox-site">The sandbox site</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/sandbox.html#browse-the-external-sandbox-site">Browse the external sandbox site</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/sandbox.html#run-the-sandbox-locally">Run the sandbox locally</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/sandbox.html#the-us-site">The US site</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/sandbox.html#the-demo-site">The demo site</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/sandbox.html#browse-the-external-demo-site">Browse the external demo site</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/sandbox.html#run-the-demo-site-locally">Run the demo site locally</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../internals/getting_started.html">Building your own shop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#install-oscar-and-its-dependencies">Install Oscar and its dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#django-settings">Django settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#urls">URLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#search-backend">Search backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#database">Database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/getting_started.html#create-database">Create database</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#initial-data">Initial data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#creating-product-classes-and-fulfillment-partners">Creating product classes and fulfillment partners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#defining-the-order-pipeline">Defining the order pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/getting_started.html#next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/key_questions.html">Building an e-commerce site: the key questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/key_questions.html#catalogue">Catalogue</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#what-are-your-product-types">What are your product types?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#how-is-your-catalogue-organised">How is your catalogue organised?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#how-are-products-managed">How are products managed?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/key_questions.html#pricing-stock-and-availability">Pricing, stock and availability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#how-is-tax-calculated">How is tax calculated?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#what-availability-messages-are-shown-to-customers">What availability messages are shown to customers?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#do-you-allow-pre-and-back-orders">Do you allow pre- and back-orders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/key_questions.html#shipping">Shipping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#how-are-shipping-charges-calculated">How are shipping charges calculated?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#which-shipping-methods-are-available">Which shipping methods are available?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/key_questions.html#payment">Payment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#how-are-customers-going-to-pay-for-orders">How are customers going to pay for orders?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#when-will-payment-be-taken">When will payment be taken?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/key_questions.html#order-processing">Order processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/key_questions.html#how-will-orders-be-processed">How will orders be processed?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/modelling_your_catalogue.html">Modelling your catalogue</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/modelling_your_catalogue.html#product-classes">Product classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/modelling_your_catalogue.html#product-attributes">Product attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/modelling_your_catalogue.html#parent-and-child-products">Parent and child products</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/modelling_your_catalogue.html#going-further">Going further</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../internals/getting_help.html">Getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ref/glossary.html">Glossary</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/customisation.html">Customising Oscar</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/customisation.html#fork-the-oscar-app">Fork the Oscar app</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/customisation.html#replace-oscar-s-app-with-your-own-in-installed-apps">Replace Oscar&#8217;s app with your own in <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/customisation.html#start-customising">Start customising!</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/class_loading_explained.html">Dynamic class loading explained</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/class_loading_explained.html#why">Why?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/class_loading_explained.html#how-it-works">How it works</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/class_loading_explained.html#in-practice">In practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/class_loading_explained.html#using-get-class-in-your-own-code">Using <tt class="docutils literal"><span class="pre">get_class</span></tt> in your own code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/class_loading_explained.html#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/prices_and_availability.html">Prices and availability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#the-strategy-class">The strategy class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/prices_and_availability.html#this-seems-quite-complicated">This seems quite complicated...</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/prices_and_availability.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#loading-a-strategy">Loading a strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#pricing-policies">Pricing policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#availability-policies">Availability policies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#strategy-mixins">Strategy mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#default-strategy">Default strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/prices_and_availability.html#how-to-use">How to use</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/prices_and_availability.html#example-1-uk-vat">Example 1: UK VAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/prices_and_availability.html#example-2-us-sales-tax">Example 2: US sales tax</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/deploying.html">Deploying Oscar</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/deploying.html#performance">Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/deploying.html#security">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/deploying.html#search-engine-optimisation">Search Engine Optimisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/translation.html">Translation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/translation.html#translating-oscar-within-your-project">Translating Oscar within your project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/upgrading.html">Upgrading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/upgrading.html#migrations">Migrations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/upgrading.html#migrating-uncustomised-apps">Migrating uncustomised apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/upgrading.html#migrating-customised-apps-models-unchanged">Migrating customised apps (models unchanged)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../topics/upgrading.html#migrating-customised-apps-models-changed">Migrating customised apps (models changed)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../topics/fork_app.html">Forking an app</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/fork_app.html#create-python-module-with-same-label">Create Python module with same label</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/fork_app.html#reference-oscar-s-models">Reference Oscar&#8217;s models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/fork_app.html#get-the-django-admin-working">Get the Django admin working</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../topics/fork_app.html#django-1-7-use-supplied-app-config">Django 1.7+: Use supplied app config</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../ref/core.html">Core functionality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/core.html#dynamic-class-loading">Dynamic class loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/core.html#url-patterns-and-views">URL patterns and views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/core.html#prices">Prices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/core.html#custom-model-fields">Custom model fields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ref/apps/index.html">Oscar&#8217;s apps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/address.html">Address</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/address.html#module-oscar.apps.address.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/address.html#views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/analytics.html">Analytics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/analytics.html#module-oscar.apps.analytics.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/analytics.html#views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/basket.html">Basket</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/basket.html#module-oscar.apps.basket.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/basket.html#module-oscar.apps.basket.views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/catalogue.html">Catalogue</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/catalogue.html#module-oscar.apps.catalogue.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/catalogue.html#module-oscar.apps.catalogue.views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/checkout.html">Checkout</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/checkout.html#flow">Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/checkout.html#abstract-models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/checkout.html#module-oscar.apps.checkout.views">Views and mixins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/checkout.html#module-oscar.apps.checkout.forms">Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/checkout.html#module-oscar.apps.checkout.calculators">Utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/customer.html">Customer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/customer.html#module-oscar.apps.customer.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/customer.html#module-oscar.apps.customer.forms">Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/customer.html#module-oscar.apps.customer.views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/dashboard.html">Dashboard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/dashboard.html#permission-based-dashboard">Permission-based dashboard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/dashboard.html#abstract-models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/dashboard.html#module-oscar.apps.dashboard.views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/offer.html">Offers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#availability">Availability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#conditions">Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#benefits">Benefits</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#module-oscar.apps.offer.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#module-oscar.apps.offer.models">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/offer.html#module-oscar.apps.offer.views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/order.html">Order</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/order.html#abstract-models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/order.html#module-oscar.apps.order.processing">Order processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/order.html#module-oscar.apps.order.utils">Utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/partner.html">Partner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/partner.html#module-oscar.apps.partner.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/partner.html#module-oscar.apps.partner.strategy">Strategy classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/partner.html#module-oscar.apps.partner.prices">Pricing policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/partner.html#module-oscar.apps.partner.availability">Availability policies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/payment.html">Payment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/payment.html#module-oscar.apps.payment.abstract_models">Abstract models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/promotions.html">Promotions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/promotions.html#module-oscar.apps.promotions.models">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/promotions.html#module-oscar.apps.promotions.views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/search.html">Search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/search.html#module-oscar.apps.search.views">Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/search.html#module-oscar.apps.search.forms">Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/search.html#module-oscar.apps.search.facets">Utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/shipping.html">Shipping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/shipping.html#module-oscar.apps.shipping.methods">Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/shipping.html#module-oscar.apps.shipping.models">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/shipping.html#module-oscar.apps.shipping.repository">Repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/voucher.html">Voucher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/voucher.html#module-oscar.apps.voucher.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/voucher.html#views">Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/apps/wishlists.html">Wishlists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/wishlists.html#module-oscar.apps.wishlists.abstract_models">Abstract models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/apps/wishlists.html#module-oscar.apps.customer.wishlists.views">Views</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../howto/index.html">Recipes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#customisation">Customisation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_customise_models.html">How to customise models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_models.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_models.html#customising-products">Customising Products</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_models.html#model-customisations-are-not-picked-up">Model customisations are not picked up</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_customise_templates.html">How to customise templates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_templates.html#method-1-forking">Method 1 - Forking</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_templates.html#method-2-subclass-parent-but-use-same-template-path">Method 2 - Subclass parent but use same template path</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_templates.html#overriding-individual-products-partials">Overriding individual products partials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_templates.html#example-changing-the-analytics-package">Example: Changing the analytics package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_disable_an_app.html">How to disable an app&#8217;s URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_change_a_url.html">How to add views or change URLs or permissions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_change_a_url.html#the-application-class">The application class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_change_a_url.html#the-application-tree">The application tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_change_a_url.html#changing-sub-app">Changing sub app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_change_a_url.html#changing-the-root-app">Changing the root app</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_customise_a_view.html">How to customise an existing view</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_a_view.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_configure_the_dashboard_navigation.html">How to configure the dashboard navigation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_configure_the_dashboard_navigation.html#add-your-own-dashboard-menu-item">Add your own dashboard menu item</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_configure_the_dashboard_navigation.html#add-an-icon-to-your-dashboard-menu">Add an icon to your dashboard menu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_configure_the_dashboard_navigation.html#controlling-visibility-per-user">Controlling visibility per user</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_customise_oscar_communications.html">Customising Oscar&#8217;s communications</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_oscar_communications.html#communications-api">Communications API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_oscar_communications.html#customising-through-code">Customising through code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_customise_oscar_communications.html#customising-through-the-database">Customising through the database</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#customers">Customers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/use_a_custom_user_model.html">How to use a custom user model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/use_a_custom_user_model.html#restrictions">Restrictions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/use_a_custom_user_model.html#migrations">Migrations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/use_a_custom_user_model.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#catalogue">Catalogue</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_create_categories.html">How to create categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/importing_a_catalogue.html">Importing a catalogue</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/importing_a_catalogue.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#pricing-stock-and-availability">Pricing, stock and availability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/enforcing_stock_rules.html">How to enforce stock rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_configure_stock_messaging.html">How to configure stock messaging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#payment">Payment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_integrate_payment.html">How to integrate payment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_integrate_payment.html#models">Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_integrate_payment.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_integrate_payment.html#integration-into-checkout">Integration into checkout</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_handle_us_taxes.html">How to handle US taxes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_handle_us_taxes.html#ensure-your-site-strategy-returns-prices-without-taxes-applied">Ensure your site strategy returns prices without taxes applied</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_handle_us_taxes.html#adjust-checkout-views-to-apply-taxes-once-they-are-known">Adjust checkout views to apply taxes once they are known</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#shipping">Shipping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_configure_shipping.html">How to configure shipping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_configure_shipping.html#shipping-in-oscar">Shipping in Oscar</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_configure_shipping.html#core-shipping-methods">Core shipping methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#order-processing">Order processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_set_up_order_processing.html">How to set up order processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_set_up_order_processing.html#structure">Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_set_up_order_processing.html#modelling">Modelling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_set_up_order_processing.html#event-handling">Event handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_set_up_order_processing.html#customisation">Customisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_set_up_order_processing.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#offers">Offers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_range.html">How to create a custom range</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_range.html#custom-range-interface">Custom range interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_range.html#create-range-instance">Create range instance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_range.html#deploying-custom-ranges">Deploying custom ranges</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_condition.html">How to create a custom offer condition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_condition.html#custom-condition-interface">Custom condition interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_condition.html#create-condition-instance">Create condition instance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_condition.html#deploying-custom-conditions">Deploying custom conditions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_benefit.html">How to create a custom benefit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_create_a_custom_benefit.html#custom-benefits">Custom benefits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#appearance">Appearance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_handle_statics.html">How to change Oscar&#8217;s appearance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_handle_statics.html#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_handle_statics.html#customisation">Customisation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../howto/index.html#deployment-and-setup">Deployment and setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../howto/how_to_setup_solr.html">How to setup Solr with Oscar</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_setup_solr.html#starting-solr">Starting Solr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../howto/how_to_setup_solr.html#integrating-with-haystack">Integrating with Haystack</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ref/settings.html">Oscar settings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#display-settings">Display settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-shop-name"><tt class="docutils literal"><span class="pre">OSCAR_SHOP_NAME</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-shop-tagline"><tt class="docutils literal"><span class="pre">OSCAR_SHOP_TAGLINE</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-homepage"><tt class="docutils literal"><span class="pre">OSCAR_HOMEPAGE</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-accounts-redirect-url"><tt class="docutils literal"><span class="pre">OSCAR_ACCOUNTS_REDIRECT_URL</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-recently-viewed-products"><tt class="docutils literal"><span class="pre">OSCAR_RECENTLY_VIEWED_PRODUCTS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-recently-viewed-cookie-lifetime"><tt class="docutils literal"><span class="pre">OSCAR_RECENTLY_VIEWED_COOKIE_LIFETIME</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-recently-viewed-cookie-name"><tt class="docutils literal"><span class="pre">OSCAR_RECENTLY_VIEWED_COOKIE_NAME</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#pagination">Pagination</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-search-facets"><tt class="docutils literal"><span class="pre">OSCAR_SEARCH_FACETS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-product-search-handler"><tt class="docutils literal"><span class="pre">OSCAR_PRODUCT_SEARCH_HANDLER</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-promotion-positions"><tt class="docutils literal"><span class="pre">OSCAR_PROMOTION_POSITIONS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-promotion-merchandising-block-types"><tt class="docutils literal"><span class="pre">OSCAR_PROMOTION_MERCHANDISING_BLOCK_TYPES</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-dashboard-navigation"><tt class="docutils literal"><span class="pre">OSCAR_DASHBOARD_NAVIGATION</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-dashboard-default-access-function"><tt class="docutils literal"><span class="pre">OSCAR_DASHBOARD_DEFAULT_ACCESS_FUNCTION</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#order-settings">Order settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-initial-order-status"><tt class="docutils literal"><span class="pre">OSCAR_INITIAL_ORDER_STATUS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-initial-line-status"><tt class="docutils literal"><span class="pre">OSCAR_INITIAL_LINE_STATUS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-order-status-pipeline"><tt class="docutils literal"><span class="pre">OSCAR_ORDER_STATUS_PIPELINE</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-order-status-cascade"><tt class="docutils literal"><span class="pre">OSCAR_ORDER_STATUS_CASCADE</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-line-status-pipeline"><tt class="docutils literal"><span class="pre">OSCAR_LINE_STATUS_PIPELINE</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#checkout-settings">Checkout settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-allow-anon-checkout"><tt class="docutils literal"><span class="pre">OSCAR_ALLOW_ANON_CHECKOUT</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-required-address-fields"><tt class="docutils literal"><span class="pre">OSCAR_REQUIRED_ADDRESS_FIELDS</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#review-settings">Review settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-allow-anon-reviews"><tt class="docutils literal"><span class="pre">OSCAR_ALLOW_ANON_REVIEWS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-moderate-reviews"><tt class="docutils literal"><span class="pre">OSCAR_MODERATE_REVIEWS</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#communication-settings">Communication settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-eager-alerts"><tt class="docutils literal"><span class="pre">OSCAR_EAGER_ALERTS</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-send-registration-email"><tt class="docutils literal"><span class="pre">OSCAR_SEND_REGISTRATION_EMAIL</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-from-email"><tt class="docutils literal"><span class="pre">OSCAR_FROM_EMAIL</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-static-base-url"><tt class="docutils literal"><span class="pre">OSCAR_STATIC_BASE_URL</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#offer-settings">Offer settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-offer-rounding-function"><tt class="docutils literal"><span class="pre">OSCAR_OFFER_ROUNDING_FUNCTION</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#basket-settings">Basket settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-basket-cookie-lifetime"><tt class="docutils literal"><span class="pre">OSCAR_BASKET_COOKIE_LIFETIME</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-max-basket-quantity-threshold"><tt class="docutils literal"><span class="pre">OSCAR_MAX_BASKET_QUANTITY_THRESHOLD</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-basket-cookie-open"><tt class="docutils literal"><span class="pre">OSCAR_BASKET_COOKIE_OPEN</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#currency-settings">Currency settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-default-currency"><tt class="docutils literal"><span class="pre">OSCAR_DEFAULT_CURRENCY</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-currency-format"><tt class="docutils literal"><span class="pre">OSCAR_CURRENCY_FORMAT</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#upload-media-settings">Upload/media settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-image-folder"><tt class="docutils literal"><span class="pre">OSCAR_IMAGE_FOLDER</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-delete-image-files"><tt class="docutils literal"><span class="pre">OSCAR_DELETE_IMAGE_FILES</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-promotion-folder"><tt class="docutils literal"><span class="pre">OSCAR_PROMOTION_FOLDER</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-missing-image-url"><tt class="docutils literal"><span class="pre">OSCAR_MISSING_IMAGE_URL</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-upload-root"><tt class="docutils literal"><span class="pre">OSCAR_UPLOAD_ROOT</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#slug-settings">Slug settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-slug-map"><tt class="docutils literal"><span class="pre">OSCAR_SLUG_MAP</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-slug-function"><tt class="docutils literal"><span class="pre">OSCAR_SLUG_FUNCTION</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-slug-blacklist"><tt class="docutils literal"><span class="pre">OSCAR_SLUG_BLACKLIST</span></tt></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/settings.html#misc-settings">Misc settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/settings.html#oscar-cookies-delete-on-logout"><tt class="docutils literal"><span class="pre">OSCAR_COOKIES_DELETE_ON_LOGOUT</span></tt></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ref/signals.html">Signals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#product-viewed"><tt class="docutils literal"><span class="pre">product_viewed</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#product-search"><tt class="docutils literal"><span class="pre">product_search</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#user-registered"><tt class="docutils literal"><span class="pre">user_registered</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#basket-addition"><tt class="docutils literal"><span class="pre">basket_addition</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#voucher-addition"><tt class="docutils literal"><span class="pre">voucher_addition</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#start-checkout"><tt class="docutils literal"><span class="pre">start_checkout</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#pre-payment"><tt class="docutils literal"><span class="pre">pre_payment</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#post-payment"><tt class="docutils literal"><span class="pre">post_payment</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#order-placed"><tt class="docutils literal"><span class="pre">order_placed</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#post-checkout"><tt class="docutils literal"><span class="pre">post_checkout</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/signals.html#review-created"><tt class="docutils literal"><span class="pre">review_created</span></tt></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../ref/templatetags.html">Template tags</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../ref/templatetags.html#shipping-tags">Shipping tags</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/templatetags.html#shipping-charge"><tt class="docutils literal"><span class="pre">shipping_charge</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/templatetags.html#shipping-charge-discount"><tt class="docutils literal"><span class="pre">shipping_charge_discount</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../ref/templatetags.html#shipping-charge-excl-discount"><tt class="docutils literal"><span class="pre">shipping_charge_excl_discount</span></tt></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../internals/design-decisions.html">Oscar design decisions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/design-decisions.html#core-models-are-abstract">Core models are abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/design-decisions.html#classes-are-loaded-dynamically">Classes are loaded dynamically</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/design-decisions.html#urls-and-permissions-for-apps-are-handled-by-application-instances">URLs and permissions for apps are handled by Application instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/design-decisions.html#templates-can-be-overridden">Templates can be overridden</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../releases/index.html">Release notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.5.html">Oscar 0.5 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.5.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.5.html#what-s-new-in-oscar-0-5">What&#8217;s new in Oscar 0.5?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.5.html#offers">Offers++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.5.html#new-dashboard-skin">New dashboard skin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.5.html#internationalisation">Internationalisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.5.html#minor-features">Minor features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.5.html#minor-improvements">Minor improvements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.5.html#upgrading">Upgrading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.5.html#migrations">Migrations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.5.1.html">Oscar 0.5.1 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.5.2.html">Oscar 0.5.2 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.5.2.html#insecure-use-of-secret-key-in-basket-cookie">Insecure use of <tt class="docutils literal"><span class="pre">SECRET_KEY</span></tt> in basket cookie</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.5.3.html">Oscar 0.5.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.6.html">Oscar 0.6 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.html#what-s-new-in-oscar-0-6">What&#8217;s new in Oscar 0.6?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#multiple-stockrecords-per-product">Multiple stockrecords per product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#pricing-and-availability">Pricing and availability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#permission-based-dashboard">Permission-based dashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#payment-models-have-abstract-versions">Payment models have abstract versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#wishlists">Wishlists</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#partner-dashboard-addresses">Partner dashboard &amp; addresses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#checkout">Checkout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#demo-site">Demo site</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#django-1-5-1-6-and-custom-user-model-support">Django 1.5, 1.6 and custom user model support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#accounts">Accounts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#bootstrap-wysihtml5-replaced-by-tinymce">Bootstrap-WYSIHTML5 replaced by TinyMCE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#improved-address-fields">Improved address fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#better-bankcard-handling">Better bankcard handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#customer-facing-range-pages">Customer-facing range pages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#reworked-search-app">Reworked search app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#order-processing-changes">Order processing changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#tracking-oscar-sites">Tracking Oscar sites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#minor-changes">Minor changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.html#backwards-incompatible-changes-in-0-6">Backwards incompatible changes in 0.6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#additional-apps">Additional apps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#checkout-app">Checkout app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#shipping-app-changes">Shipping app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#address-model-changes">Address model changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#basket-app-changes">Basket app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#catalogue-app-changes">Catalogue app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#customer-app-changes">Customer app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#offer-app-changes">Offer app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#payment-app-changes">Payment app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#reviews-app-changes">Reviews app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#search-app-changes">Search app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#loading-baskets">Loading baskets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#renamed-templates">Renamed templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#template-block-changes">Template block changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#changes-to-partner-permissions">Changes to Partner permissions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#migrations">Migrations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.html#features-deprecated-in-0-6">Features deprecated in 0.6</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#accessing-a-product-s-stockrecords">Accessing a product&#8217;s stockrecords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#checkout-session-manager">Checkout session manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#checkout-order-placement-mixin">Checkout order placement mixin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#bankcard-model">Bankcard model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#partner-wrappers">&#8220;Partner wrappers&#8221;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.html#test-support-extension-brought-back-into-core">Test support extension brought back into core</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.6.1.html">Oscar 0.6.1 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.1.html#possible-data-loss-from-deleted-users">Possible data loss from deleted users</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.1.html#missing-translations">Missing translations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.6.2.html">Oscar 0.6.2 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.2.html#overriding-models">Overriding models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.6.2.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.6.3.html">Oscar 0.6.3 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.3.html#known-issues">Known issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.3.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.6.4.html">Oscar 0.6.4 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.4.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.6.5.html">Oscar 0.6.5 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.6.5.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.7.html">Oscar 0.7 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.7.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.7.html#compatibility">Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.7.html#what-s-new-in-oscar-0-7">What&#8217;s new in Oscar 0.7?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#search-improvements">Search improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#extended-signals">Extended signals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#checkout-reorganisation">Checkout reorganisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#minor-changes">Minor changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#bugfixes">Bugfixes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.7.html#backwards-incompatible-changes-in-0-7">Backwards incompatible changes in 0.7</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#removal-of-features-deprecated-in-0-6">Removal of features deprecated in 0.6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v0.7.html#migrations">Migrations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.7.1.html">Oscar 0.7.1 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.7.1.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.7.2.html">Oscar 0.7.2 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v0.7.2.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v0.7.3.html">Oscar 0.7.3 release notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v1.0.html">Oscar 1.0 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.0.html#compatibility">Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.0.html#what-s-new-in-oscar-1-0">What&#8217;s new in Oscar 1.0?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#explicit-differentiation-of-child-parent-and-stand-alone-products">Explicit differentiation of child, parent and stand-alone products</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#better-handling-of-child-products-in-product-dashboard">Better handling of child products in product dashboard</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#customisation-just-got-easier">Customisation just got easier!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#django-1-7-support">Django 1.7 support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#billing-addresses-explicitly-passed-around-checkout">Billing addresses explicitly passed around checkout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#dashboard-for-weight-based-shipping-methods">Dashboard for weight-based shipping methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#us-demo-site">US demo site</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#faceting-for-category-browsing">Faceting for category browsing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#reworked-shipping-app">Reworked shipping app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#basket-additions-clean-up">Basket additions clean-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#checkout-improvements">Checkout improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#out-with-the-old-in-with-the-new">Out with the old, in with the new</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#minor-changes">Minor changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.0.html#backwards-incompatible-changes-in-1-0">Backwards incompatible changes in 1.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#product-structure">Product structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#product-editing">Product editing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#shipping">Shipping</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#email-address-handling">Email address handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#id1">Django 1.7 support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#basket-line-stockrecords">Basket line stockrecords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#basket-app-changes">Basket app changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#misc">Misc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#migrations">Migrations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#deprecated-features">Deprecated features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.0.html#removal-of-deprecated-features">Removal of deprecated features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.0.html#known-issues">Known issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v1.0.1.html">Oscar 1.0.1 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.0.1.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v1.0.2.html">Oscar 1.0.2 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.0.2.html#bug-fixes">Bug fixes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../releases/v1.1.html">Oscar 1.1 release notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.1.html#compatibility">Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.1.html#what-s-new-in-oscar-1-1">What&#8217;s new in Oscar 1.1?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.1.html#minor-changes">Minor changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.1.html#backwards-incompatible-changes-in-1-1">Backwards incompatible changes in 1.1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.1.html#categories-refactor">Categories refactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.1.html#misc">Misc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.1.html#migrations">Migrations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../releases/v1.1.html#dependency-changes">Dependency changes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.1.html#deprecated-features">Deprecated features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../releases/v1.1.html#removal-of-deprecated-features">Removal of deprecated features</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../internals/contributing/index.html">Contributing to Oscar</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../internals/contributing/index.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/contributing/development-environment.html">Setting up the development environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/development-environment.html#jpeg-support">JPEG Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/development-environment.html#creating-migrations">Creating migrations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/development-environment.html#writing-less-css">Writing LESS/CSS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/development-environment.html#testing-migrations-against-mysql-and-postgres">Testing migrations against MySQL and Postgres</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/contributing/bugs-and-features.html">Reporting bugs and requesting features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/bugs-and-features.html#reporting-security-issues">Reporting security issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/bugs-and-features.html#reporting-bugs">Reporting bugs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/bugs-and-features.html#reporting-user-interface-bugs-and-features">Reporting user interface bugs and features</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/bugs-and-features.html#requesting-features">Requesting features</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/contributing/coding-style.html">Coding Style</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/coding-style.html#general">General</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/coding-style.html#urls">URLs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/coding-style.html#view-class-names">View class names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/coding-style.html#referencing-managers">Referencing managers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/coding-style.html#html">HTML</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/contributing/submitting-pull-requests.html">Submitting pull requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/contributing/running-tests.html">Test suite</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/running-tests.html#running-tests">Running tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/running-tests.html#testing-against-different-setups">Testing against different setups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/running-tests.html#kinds-of-tests">Kinds of tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/running-tests.html#naming-tests">Naming tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../internals/contributing/writing-documentation.html">Writing documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/writing-documentation.html#directory-structure">Directory Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../internals/contributing/writing-documentation.html#style-guides">Style guides</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">django-oscar</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
      
    <li>oscar.apps.catalogue.abstract_models</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/django-oscar/django-oscar/blob/master/docs/source/_modules/oscar/apps/catalogue/abstract_models.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for oscar.apps.catalogue.abstract_models</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">django.utils</span> <span class="kn">import</span> <span class="n">six</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">django.utils.html</span> <span class="kn">import</span> <span class="n">strip_tags</span>
<span class="kn">from</span> <span class="nn">django.utils.safestring</span> <span class="kn">import</span> <span class="n">mark_safe</span>
<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.contrib.staticfiles.finders</span> <span class="kn">import</span> <span class="n">find</span>
<span class="kn">from</span> <span class="nn">django.core.cache</span> <span class="kn">import</span> <span class="n">cache</span>
<span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">ImproperlyConfigured</span>
<span class="kn">from</span> <span class="nn">django.core.files.base</span> <span class="kn">import</span> <span class="n">File</span>
<span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">django.core.validators</span> <span class="kn">import</span> <span class="n">RegexValidator</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">Sum</span><span class="p">,</span> <span class="n">Count</span>
<span class="kn">from</span> <span class="nn">django.utils.encoding</span> <span class="kn">import</span> <span class="n">python_2_unicode_compatible</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span><span class="p">,</span> <span class="n">pgettext_lazy</span>
<span class="kn">from</span> <span class="nn">django.utils.functional</span> <span class="kn">import</span> <span class="n">cached_property</span>
<span class="kn">from</span> <span class="nn">django.contrib.contenttypes.generic</span> <span class="kn">import</span> <span class="n">GenericForeignKey</span>
<span class="kn">from</span> <span class="nn">django.contrib.contenttypes.models</span> <span class="kn">import</span> <span class="n">ContentType</span>

<span class="kn">from</span> <span class="nn">treebeard.mp_tree</span> <span class="kn">import</span> <span class="n">MP_Node</span>

<span class="kn">from</span> <span class="nn">oscar.core.decorators</span> <span class="kn">import</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">oscar.core.utils</span> <span class="kn">import</span> <span class="n">slugify</span>
<span class="kn">from</span> <span class="nn">oscar.core.validators</span> <span class="kn">import</span> <span class="n">non_python_keyword</span>
<span class="kn">from</span> <span class="nn">oscar.core.loading</span> <span class="kn">import</span> <span class="n">get_classes</span><span class="p">,</span> <span class="n">get_model</span><span class="p">,</span> <span class="n">get_class</span>
<span class="kn">from</span> <span class="nn">oscar.models.fields</span> <span class="kn">import</span> <span class="n">NullCharField</span><span class="p">,</span> <span class="n">AutoSlugField</span>

<span class="n">ProductManager</span><span class="p">,</span> <span class="n">BrowsableProductManager</span> <span class="o">=</span> <span class="n">get_classes</span><span class="p">(</span>
    <span class="s">&#39;catalogue.managers&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;ProductManager&#39;</span><span class="p">,</span> <span class="s">&#39;BrowsableProductManager&#39;</span><span class="p">])</span>

<span class="n">Selector</span> <span class="o">=</span> <span class="n">get_class</span><span class="p">(</span><span class="s">&#39;partner.strategy&#39;</span><span class="p">,</span> <span class="s">&#39;Selector&#39;</span><span class="p">)</span>


<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractProductClass"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductClass">[docs]</a><span class="k">class</span> <span class="nc">AbstractProductClass</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used for defining options and attributes for a subset of products.</span>
<span class="sd">    E.g. Books, DVDs and Toys. A product can only belong to one product class.</span>

<span class="sd">    At least one product class must be created when setting up a new</span>
<span class="sd">    Oscar deployment.</span>

<span class="sd">    Not necessarily equivalent to top-level categories but usually will be.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Name&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">AutoSlugField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Slug&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                         <span class="n">populate_from</span><span class="o">=</span><span class="s">&#39;name&#39;</span><span class="p">)</span>

    <span class="c">#: Some product type don&#39;t require shipping (eg digital products) - we use</span>
    <span class="c">#: this field to take some shortcuts in the checkout.</span>
    <span class="n">requires_shipping</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Requires shipping?&quot;</span><span class="p">),</span>
                                            <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c">#: Digital products generally don&#39;t require their stock levels to be</span>
    <span class="c">#: tracked.</span>
    <span class="n">track_stock</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Track stock levels?&quot;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c">#: These are the options (set by the user when they add to basket) for this</span>
    <span class="c">#: item class.  For instance, a product class of &quot;SMS message&quot; would always</span>
    <span class="c">#: require a message to be specified before it could be bought.</span>
    <span class="c">#: Note that you can also set options on a per-product level.</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Option&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Options&quot;</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Product class&quot;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Product classes&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">has_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractCategory"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory">[docs]</a><span class="k">class</span> <span class="nc">AbstractCategory</span><span class="p">(</span><span class="n">MP_Node</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A product category. Merely used for navigational purposes; has no</span>
<span class="sd">    effects on business logic.</span>

<span class="sd">    Uses django-treebeard.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Name&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Description&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Image&#39;</span><span class="p">),</span> <span class="n">upload_to</span><span class="o">=</span><span class="s">&#39;categories&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                              <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Slug&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">_slug_separator</span> <span class="o">=</span> <span class="s">&#39;/&#39;</span>
    <span class="n">_full_name_separator</span> <span class="o">=</span> <span class="s">&#39; &gt; &#39;</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_name</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractCategory.full_name"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.full_name">[docs]</a>    <span class="k">def</span> <span class="nf">full_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of the category and it&#39;s ancestors,</span>
<span class="sd">        e.g. &#39;Books &gt; Non-fiction &gt; Essential programming&#39;.</span>

<span class="sd">        It&#39;s rarely used in Oscar&#39;s codebase, but used to be stored as a</span>
<span class="sd">        CharField and is hence kept for backwards compatibility. It&#39;s also</span>
<span class="sd">        sufficiently useful to keep around.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">category</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ancestors_and_self</span><span class="p">()]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_name_separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractCategory.full_slug"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.full_slug">[docs]</a>    <span class="k">def</span> <span class="nf">full_slug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string of this category&#39;s slug concatenated with the slugs</span>
<span class="sd">        of it&#39;s ancestors, e.g. &#39;books/non-fiction/essential-programming&#39;.</span>

<span class="sd">        Oscar used to store this as in the &#39;slug&#39; model field, but this field</span>
<span class="sd">        has been re-purposed to only store this category&#39;s slug and to not</span>
<span class="sd">        include it&#39;s ancestors&#39; slugs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">slugs</span> <span class="o">=</span> <span class="p">[</span><span class="n">category</span><span class="o">.</span><span class="n">slug</span> <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ancestors_and_self</span><span class="p">()]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slug_separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">slugs</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AbstractCategory.generate_slug"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.generate_slug">[docs]</a>    <span class="k">def</span> <span class="nf">generate_slug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a slug for a category. This makes no attempt at generating</span>
<span class="sd">        a unique slug.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">slugify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="AbstractCategory.ensure_slug_uniqueness"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.ensure_slug_uniqueness">[docs]</a>    <span class="k">def</span> <span class="nf">ensure_slug_uniqueness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensures that the category&#39;s slug is unique amongst it&#39;s siblings.</span>
<span class="sd">        This is inefficient and probably not thread-safe.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unique_slug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slug</span>
        <span class="n">siblings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_siblings</span><span class="p">()</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">)</span>
        <span class="n">next_num</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span> <span class="n">siblings</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">slug</span><span class="o">=</span><span class="n">unique_slug</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">unique_slug</span> <span class="o">=</span> <span class="s">&#39;{slug}_{end}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">next_num</span><span class="p">)</span>
            <span class="n">next_num</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">unique_slug</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">unique_slug</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AbstractCategory.save"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Oscar traditionally auto-generated slugs from names. As that is</span>
<span class="sd">        often convenient, we still do so if a slug is not supplied through</span>
<span class="sd">        other means. If you want to control slug creation, just create</span>
<span class="sd">        instances with a slug already set, or expose a field on the</span>
<span class="sd">        appropriate forms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">:</span>
            <span class="c"># Slug was supplied. Hands off!</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">AbstractCategory</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_slug</span><span class="p">()</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">AbstractCategory</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c"># We auto-generated a slug, so we need to make sure that it&#39;s</span>
            <span class="c"># unique. As we need to be able to inspect the category&#39;s siblings</span>
            <span class="c"># for that, we need to wait until the instance is saved. We</span>
            <span class="c"># update the slug and save again if necessary.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ensure_slug_uniqueness</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AbstractCategory.get_ancestors_and_self"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.get_ancestors_and_self">[docs]</a>    <span class="k">def</span> <span class="nf">get_ancestors_and_self</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets ancestors and includes itself. Use treebeard&#39;s get_ancestors</span>
<span class="sd">        if you don&#39;t want to include the category itself. It&#39;s a separate</span>
<span class="sd">        function as it&#39;s commonly used in templates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ancestors</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="AbstractCategory.get_descendants_and_self"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.get_descendants_and_self">[docs]</a>    <span class="k">def</span> <span class="nf">get_descendants_and_self</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets descendants and includes itself. Use treebeard&#39;s get_descendants</span>
<span class="sd">        if you don&#39;t want to include the category itself. It&#39;s a separate</span>
<span class="sd">        function as it&#39;s commonly used in templates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_descendants</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="AbstractCategory.get_absolute_url"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractCategory.get_absolute_url">[docs]</a>    <span class="k">def</span> <span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Our URL scheme means we have to look up the category&#39;s ancestors. As</span>
<span class="sd">        that is a bit more expensive, we cache the generated URL. That is</span>
<span class="sd">        safe even for a stale cache, as the default implementation of</span>
<span class="sd">        ProductCategoryView does the lookup via primary key anyway. But if</span>
<span class="sd">        you change that logic, you&#39;ll have to reconsider the caching</span>
<span class="sd">        approach.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="s">&#39;CATEGORY_URL_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cache_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span>
                <span class="s">&#39;catalogue:category&#39;</span><span class="p">,</span>
                <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;category_slug&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_slug</span><span class="p">,</span> <span class="s">&#39;pk&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">})</span>
            <span class="n">cache</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">url</span>
</div>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;path&#39;</span><span class="p">]</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Category&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Categories&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_children</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">get_num_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractProductCategory"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductCategory">[docs]</a><span class="k">class</span> <span class="nc">AbstractProductCategory</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Joining model between products and categories. Exists to allow customising.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">product</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;catalogue.Product&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Product&quot;</span><span class="p">))</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;catalogue.Category&#39;</span><span class="p">,</span>
                                 <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Category&quot;</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;product&#39;</span><span class="p">,</span> <span class="s">&#39;category&#39;</span><span class="p">]</span>
        <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;product&#39;</span><span class="p">,</span> <span class="s">&#39;category&#39;</span><span class="p">)</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product category&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product categories&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&quot;&lt;productcategory for product &#39;</span><span class="si">%s</span><span class="s">&#39;&gt;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractProduct"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct">[docs]</a><span class="k">class</span> <span class="nc">AbstractProduct</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The base product object</span>

<span class="sd">    There&#39;s three kinds of products; they&#39;re distinguished by the structure</span>
<span class="sd">    field.</span>

<span class="sd">    - A stand alone product. Regular product that lives by itself.</span>
<span class="sd">    - A child product. All child products have a parent product. They&#39;re a</span>
<span class="sd">      specific version of the parent.</span>
<span class="sd">    - A parent product. It essentially represents a set of products.</span>

<span class="sd">    An example could be a yoga course, which is a parent product. The different</span>
<span class="sd">    times/locations of the courses would be associated with the child products.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">STANDALONE</span><span class="p">,</span> <span class="n">PARENT</span><span class="p">,</span> <span class="n">CHILD</span> <span class="o">=</span> <span class="s">&#39;standalone&#39;</span><span class="p">,</span> <span class="s">&#39;parent&#39;</span><span class="p">,</span> <span class="s">&#39;child&#39;</span>
    <span class="n">STRUCTURE_CHOICES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">STANDALONE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Stand-alone product&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">PARENT</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Parent product&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">CHILD</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Child product&#39;</span><span class="p">))</span>
    <span class="p">)</span>
    <span class="n">structure</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&quot;Product structure&quot;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">STRUCTURE_CHOICES</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">STANDALONE</span><span class="p">)</span>

    <span class="n">upc</span> <span class="o">=</span> <span class="n">NullCharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&quot;UPC&quot;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Universal Product Code (UPC) is an identifier for &quot;</span>
                    <span class="s">&quot;a product which is not specific to a particular &quot;</span>
                    <span class="s">&quot; supplier. Eg an ISBN for a book.&quot;</span><span class="p">))</span>

    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;self&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;children&#39;</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Parent product&quot;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Only choose a parent product if you&#39;re creating a child &quot;</span>
                    <span class="s">&quot;product.  For example if this is a size &quot;</span>
                    <span class="s">&quot;4 of a particular t-shirt.  Leave blank if this is a &quot;</span>
                    <span class="s">&quot;stand-alone product (i.e. there is only one version of&quot;</span>
                    <span class="s">&quot; this product).&quot;</span><span class="p">))</span>

    <span class="c"># Title is mandatory for canonical products but optional for child products</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">pgettext_lazy</span><span class="p">(</span><span class="s">u&#39;Product title&#39;</span><span class="p">,</span> <span class="s">u&#39;Title&#39;</span><span class="p">),</span>
                             <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">slug</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Slug&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Description&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c">#: &quot;Kind&quot; of product, e.g. T-Shirt, Book, etc.</span>
    <span class="c">#: None for child products, they inherit their parent&#39;s product class</span>
    <span class="n">product_class</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.ProductClass&#39;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Product type&#39;</span><span class="p">),</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&quot;products&quot;</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Choose what type of product this is&quot;</span><span class="p">))</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="s">&#39;catalogue.ProductAttribute&#39;</span><span class="p">,</span>
        <span class="n">through</span><span class="o">=</span><span class="s">&#39;ProductAttributeValue&#39;</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Attributes&quot;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;A product attribute is something that this product may &quot;</span>
                    <span class="s">&quot;have, such as a size, as specified by its class&quot;</span><span class="p">))</span>
    <span class="c">#: It&#39;s possible to have options product class-wide, and per product.</span>
    <span class="n">product_options</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Option&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Product options&quot;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Options are values that can be associated with a item &quot;</span>
                    <span class="s">&quot;when it is added to a customer&#39;s basket.  This could be &quot;</span>
                    <span class="s">&quot;something like a personalised message to be printed on &quot;</span>
                    <span class="s">&quot;a T-shirt.&quot;</span><span class="p">))</span>

    <span class="n">recommended_products</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Product&#39;</span><span class="p">,</span> <span class="n">through</span><span class="o">=</span><span class="s">&#39;ProductRecommendation&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Recommended products&quot;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;These are products that are recommended to accompany the &quot;</span>
                    <span class="s">&quot;main product.&quot;</span><span class="p">))</span>

    <span class="c"># Denormalised product rating - used by reviews app.</span>
    <span class="c"># Product has no ratings if rating is None</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Rating&#39;</span><span class="p">),</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Date created&quot;</span><span class="p">),</span> <span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c"># This field is used by Haystack to reindex search</span>
    <span class="n">date_updated</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&quot;Date updated&quot;</span><span class="p">),</span> <span class="n">auto_now</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">db_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">categories</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Category&#39;</span><span class="p">,</span> <span class="n">through</span><span class="o">=</span><span class="s">&#39;ProductCategory&#39;</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Categories&quot;</span><span class="p">))</span>

    <span class="c">#: Determines if a product may be used in an offer. It is illegal to</span>
    <span class="c">#: discount some types of product (e.g. ebooks) and this field helps</span>
    <span class="c">#: merchants from avoiding discounting such products</span>
    <span class="c">#: Note that this flag is ignored for child products; they inherit from</span>
    <span class="c">#: the parent product.</span>
    <span class="n">is_discountable</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&quot;Is discountable?&quot;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span>
            <span class="s">&quot;This flag indicates if this product can be used in an offer &quot;</span>
            <span class="s">&quot;or not&quot;</span><span class="p">))</span>

    <span class="n">objects</span> <span class="o">=</span> <span class="n">ProductManager</span><span class="p">()</span>
    <span class="n">browsable</span> <span class="o">=</span> <span class="n">BrowsableProductManager</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-date_created&#39;</span><span class="p">]</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Products&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AbstractProduct</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr</span> <span class="o">=</span> <span class="n">ProductAttributesContainer</span><span class="p">(</span><span class="n">product</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_summary</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&quot;</span><span class="si">%s</span><span class="s"> (</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_summary</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_title</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractProduct.get_absolute_url"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.get_absolute_url">[docs]</a>    <span class="k">def</span> <span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a product&#39;s absolute url</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s">&#39;catalogue:detail&#39;</span><span class="p">,</span>
                       <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;product_slug&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">,</span> <span class="s">&#39;pk&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>
</div>
<div class="viewcode-block" id="AbstractProduct.clean"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.clean">[docs]</a>    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate a product. Those are the rules:</span>

<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        |               | stand alone | parent       | child        |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | title         | required    | required     | optional     |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | product class | required    | required     | must be None |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | parent        | forbidden   | forbidden    | required     |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | stockrecords  | 0 or more   | forbidden    | 0 or more    |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | categories    | 1 or more   | 1 or more    | forbidden    |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | attributes    | optional    | optional     | optional     |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | rec. products | optional    | optional     | unsupported  |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>
<span class="sd">        | options       | optional    | optional     | forbidden    |</span>
<span class="sd">        +---------------+-------------+--------------+--------------+</span>

<span class="sd">        Because the validation logic is quite complex, validation is delegated</span>
<span class="sd">        to the sub method appropriate for the product&#39;s structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;_clean_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span><span class="p">)()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">validate_attributes</span><span class="p">()</span>
</div>
    <span class="k">def</span> <span class="nf">_clean_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates a stand-alone product</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Your product must have a title.&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_class</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Your product must have a product class.&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Only child products can have a parent.&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_clean_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates a child product</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_id</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;A child product needs a parent.&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_id</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">is_parent</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;You can only assign child products to parent products.&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_class</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;A child product can&#39;t have a product class.&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;A child product can&#39;t have a category assigned.&quot;</span><span class="p">))</span>
        <span class="c"># Note that we only forbid options on product level</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_options</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;A child product can&#39;t have options.&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_clean_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates a parent product.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clean_standalone</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stockrecords</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;A parent product can&#39;t have stockrecords.&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">slug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slug</span> <span class="o">=</span> <span class="n">slugify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_title</span><span class="p">())</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AbstractProduct</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="c"># Properties</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">STANDALONE</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">PARENT</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_child</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">CHILD</span>

<div class="viewcode-block" id="AbstractProduct.can_be_parent"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.can_be_parent">[docs]</a>    <span class="k">def</span> <span class="nf">can_be_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">give_reason</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helps decide if a the product can be turned into a parent product.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_child</span><span class="p">:</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;The specified parent product is a child product.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_stockrecords</span><span class="p">:</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span>
                <span class="s">&quot;One can&#39;t add a child product to a product with stock&quot;</span>
                <span class="s">&quot; records.&quot;</span><span class="p">)</span>
        <span class="n">is_valid</span> <span class="o">=</span> <span class="n">reason</span> <span class="ow">is</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">give_reason</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">is_valid</span><span class="p">,</span> <span class="n">reason</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">is_valid</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractProduct.options"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.options">[docs]</a>    <span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a set of all valid options for this product.</span>
<span class="sd">        It&#39;s possible to have options product class-wide, and per product.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pclass_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_product_class</span><span class="p">()</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">pclass_options</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">product_options</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_shipping_required</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_product_class</span><span class="p">()</span><span class="o">.</span><span class="n">requires_shipping</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractProduct.has_stockrecords"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.has_stockrecords">[docs]</a>    <span class="k">def</span> <span class="nf">has_stockrecords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test if this product has any stockrecords</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stockrecords</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">num_stockrecords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stockrecords</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractProduct.attribute_summary"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.attribute_summary">[docs]</a>    <span class="k">def</span> <span class="nf">attribute_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a string of all of a product&#39;s attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute_values</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="p">[</span><span class="n">attribute</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span> <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="p">]</span>
        <span class="k">return</span> <span class="s">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>

    <span class="c"># The two properties below are deprecated because determining minimum</span>
    <span class="c"># price is not as trivial as it sounds considering multiple stockrecords,</span>
    <span class="c"># currencies, tax, etc.</span>
    <span class="c"># The current implementation is very naive and only works for a limited</span>
    <span class="c"># set of use cases.</span>
    <span class="c"># At the very least, we should pass in the request and</span>
    <span class="c"># user. Hence, it&#39;s best done as an extension to a Strategy class.</span>
    <span class="c"># Once that is accomplished, these properties should be removed.</span>
</div>
    <span class="nd">@property</span>
    <span class="nd">@deprecated</span>
    <span class="k">def</span> <span class="nf">min_child_price_incl_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return minimum child product price including tax.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_child_price</span><span class="p">(</span><span class="s">&#39;incl_tax&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="nd">@deprecated</span>
    <span class="k">def</span> <span class="nf">min_child_price_excl_tax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return minimum child product price excluding tax.</span>

<span class="sd">        This is a very naive approach; see the deprecation notice above. And</span>
<span class="sd">        only use it for display purposes (e.g. &quot;new Oscar shirt, prices</span>
<span class="sd">        starting from $9.50&quot;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_child_price</span><span class="p">(</span><span class="s">&#39;excl_tax&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_min_child_price</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return minimum child product price.</span>

<span class="sd">        This is for visual purposes only. It ignores currencies, most of the</span>
<span class="sd">        Strategy logic for selecting stockrecords, knows nothing about the</span>
<span class="sd">        current user or request, etc. It&#39;s only here to ensure</span>
<span class="sd">        backwards-compatibility; the previous implementation wasn&#39;t any</span>
<span class="sd">        better.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">strategy</span> <span class="o">=</span> <span class="n">Selector</span><span class="p">()</span><span class="o">.</span><span class="n">strategy</span><span class="p">()</span>

        <span class="n">children_stock</span> <span class="o">=</span> <span class="n">strategy</span><span class="o">.</span><span class="n">select_children_stockrecords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">prices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">strategy</span><span class="o">.</span><span class="n">pricing_policy</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">stockrecord</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">child</span><span class="p">,</span> <span class="n">stockrecord</span> <span class="ow">in</span> <span class="n">children_stock</span><span class="p">]</span>
        <span class="n">raw_prices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span> <span class="k">for</span> <span class="n">price</span> <span class="ow">in</span> <span class="n">prices</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">raw_prices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">raw_prices</span> <span class="k">else</span> <span class="bp">None</span>

    <span class="c"># Wrappers for child products</span>

<div class="viewcode-block" id="AbstractProduct.get_title"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.get_title">[docs]</a>    <span class="k">def</span> <span class="nf">get_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a product&#39;s title or it&#39;s parent&#39;s title if it has no title</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent_id</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">title</span>
        <span class="k">return</span> <span class="n">title</span></div>
    <span class="n">get_title</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="n">pgettext_lazy</span><span class="p">(</span><span class="s">u&quot;Product title&quot;</span><span class="p">,</span> <span class="s">u&quot;Title&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractProduct.get_product_class"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.get_product_class">[docs]</a>    <span class="k">def</span> <span class="nf">get_product_class</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a product&#39;s item class. Child products inherit their parent&#39;s.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_child</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">product_class</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">product_class</span></div>
    <span class="n">get_product_class</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Product class&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractProduct.get_is_discountable"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.get_is_discountable">[docs]</a>    <span class="k">def</span> <span class="nf">get_is_discountable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        At the moment, is_discountable can&#39;t be set individually for child</span>
<span class="sd">        products; they inherit it from their parent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_child</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">is_discountable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_discountable</span>
</div>
<div class="viewcode-block" id="AbstractProduct.get_categories"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.get_categories">[docs]</a>    <span class="k">def</span> <span class="nf">get_categories</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a product&#39;s categories or parent&#39;s if there is a parent product.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_child</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">categories</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">categories</span></div>
    <span class="n">get_categories</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Categories&quot;</span><span class="p">)</span>

    <span class="c"># Images</span>

<div class="viewcode-block" id="AbstractProduct.get_missing_image"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.get_missing_image">[docs]</a>    <span class="k">def</span> <span class="nf">get_missing_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a missing image object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># This class should have a &#39;name&#39; property so it mimics the Django file</span>
        <span class="c"># field.</span>
        <span class="k">return</span> <span class="n">MissingProductImage</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="AbstractProduct.primary_image"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.primary_image">[docs]</a>    <span class="k">def</span> <span class="nf">primary_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the primary image for a product. Usually used when one can</span>
<span class="sd">        only display one product image, e.g. in a list of products.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">images</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">ordering</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ordering</span> <span class="ow">or</span> <span class="n">ordering</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;display_order&#39;</span><span class="p">:</span>
            <span class="c"># Only apply order_by() if a custom model doesn&#39;t use default</span>
            <span class="c"># ordering. Applying order_by() busts the prefetch cache of</span>
            <span class="c"># the ProductManager</span>
            <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;display_order&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="c"># We return a dict with fields that mirror the key properties of</span>
            <span class="c"># the ProductImage class so this missing image can be used</span>
            <span class="c"># interchangeably in templates.  Strategy pattern ftw!</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;original&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_missing_image</span><span class="p">(),</span>
                <span class="s">&#39;caption&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                <span class="s">&#39;is_missing&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

    <span class="c"># Updating methods</span>
</div>
<div class="viewcode-block" id="AbstractProduct.update_rating"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.update_rating">[docs]</a>    <span class="k">def</span> <span class="nf">update_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recalculate rating field</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rating</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_rating</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>
    <span class="n">update_rating</span><span class="o">.</span><span class="n">alters_data</span> <span class="o">=</span> <span class="bp">True</span>

<div class="viewcode-block" id="AbstractProduct.calculate_rating"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.calculate_rating">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_rating</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate rating value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reviews</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">status</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reviews</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">APPROVED</span>
        <span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
            <span class="nb">sum</span><span class="o">=</span><span class="n">Sum</span><span class="p">(</span><span class="s">&#39;score&#39;</span><span class="p">),</span> <span class="n">count</span><span class="o">=</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">))</span>
        <span class="n">reviews_sum</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;sum&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">reviews_count</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;count&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">rating</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">reviews_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rating</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">reviews_sum</span><span class="p">)</span> <span class="o">/</span> <span class="n">reviews_count</span>
        <span class="k">return</span> <span class="n">rating</span>
</div>
    <span class="k">def</span> <span class="nf">has_review_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">is_anonymous</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reviews</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractProduct.is_review_permitted"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProduct.is_review_permitted">[docs]</a>    <span class="k">def</span> <span class="nf">is_review_permitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines whether a user may add a review on this product.</span>

<span class="sd">        Default implementation respects OSCAR_ALLOW_ANON_REVIEWS and only</span>
<span class="sd">        allows leaving one review per user and product.</span>

<span class="sd">        Override this if you want to alter the default behaviour; e.g. enforce</span>
<span class="sd">        that a user purchased the product to be allowed to leave a review.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">user</span><span class="o">.</span><span class="n">is_authenticated</span><span class="p">()</span> <span class="ow">or</span> <span class="n">settings</span><span class="o">.</span><span class="n">OSCAR_ALLOW_ANON_REVIEWS</span><span class="p">:</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_review_by</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
</div>
    <span class="nd">@cached_property</span>
    <span class="k">def</span> <span class="nf">num_approved_reviews</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reviews</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">status</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reviews</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">APPROVED</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="AbstractProductRecommendation"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductRecommendation">[docs]</a><span class="k">class</span> <span class="nc">AbstractProductRecommendation</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &#39;Through&#39; model for product recommendations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">primary</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Product&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;primary_recommendations&#39;</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Primary product&quot;</span><span class="p">))</span>
    <span class="n">recommendation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Product&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Recommended product&quot;</span><span class="p">))</span>
    <span class="n">ranking</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveSmallIntegerField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&#39;Ranking&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Determines order of the products. A product with a higher&#39;</span>
                    <span class="s">&#39; value will appear before one with a lower ranking.&#39;</span><span class="p">))</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;primary&#39;</span><span class="p">,</span> <span class="s">&#39;-ranking&#39;</span><span class="p">]</span>
        <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;primary&#39;</span><span class="p">,</span> <span class="s">&#39;recommendation&#39;</span><span class="p">)</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product recommendation&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product recomendations&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ProductAttributesContainer"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.ProductAttributesContainer">[docs]</a><span class="k">class</span> <span class="nc">ProductAttributesContainer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stolen liberally from django-eav, but simplified to be product-specific</span>

<span class="sd">    To set attributes on a product, use the `attr` attribute:</span>

<span class="sd">        product.attr.weight = 125</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">product</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">product</span> <span class="o">=</span> <span class="n">product</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span><span class="o">.</span><span class="n">select_related</span><span class="p">(</span><span class="s">&#39;attribute&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialised</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="n">_</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(obj)s</span><span class="s"> has no attribute named &#39;</span><span class="si">%(attr)s</span><span class="s">&#39;&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">{</span>
                <span class="s">&#39;obj&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">get_product_class</span><span class="p">(),</span> <span class="s">&#39;attr&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">validate_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_attributes</span><span class="p">():</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">attribute</span><span class="o">.</span><span class="n">required</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                        <span class="n">_</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(attr)s</span><span class="s"> attribute cannot be blank&quot;</span><span class="p">)</span> <span class="o">%</span>
                        <span class="p">{</span><span class="s">&#39;attr&#39;</span><span class="p">:</span> <span class="n">attribute</span><span class="o">.</span><span class="n">code</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">attribute</span><span class="o">.</span><span class="n">validate_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                        <span class="n">_</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(attr)s</span><span class="s"> attribute </span><span class="si">%(err)s</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">%</span>
                        <span class="p">{</span><span class="s">&#39;attr&#39;</span><span class="p">:</span> <span class="n">attribute</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="s">&#39;err&#39;</span><span class="p">:</span> <span class="n">e</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">get_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">attribute_values</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_value_by_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="o">=</span><span class="n">attribute</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_all_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">get_product_class</span><span class="p">()</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_attribute_by_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_attributes</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_attributes</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="o">.</span><span class="n">code</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
                <span class="n">attribute</span><span class="o">.</span><span class="n">save_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractProductAttribute"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductAttribute">[docs]</a><span class="k">class</span> <span class="nc">AbstractProductAttribute</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines an attribute for a product class. (For example, number_of_pages for</span>
<span class="sd">    a &#39;book&#39; class)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">product_class</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.ProductClass&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;attributes&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Product type&quot;</span><span class="p">))</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Name&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">SlugField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&#39;Code&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span>
            <span class="n">RegexValidator</span><span class="p">(</span>
                <span class="n">regex</span><span class="o">=</span><span class="s">r&#39;^[a-zA-Z_][0-9a-zA-Z_]*$&#39;</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="n">_</span><span class="p">(</span>
                    <span class="s">&quot;Code can only contain the letters a-z, A-Z, digits, &quot;</span>
                    <span class="s">&quot;and underscores, and can&#39;t start with a digit&quot;</span><span class="p">)),</span>
            <span class="n">non_python_keyword</span>
        <span class="p">])</span>

    <span class="c"># Attribute types</span>
    <span class="n">TEXT</span> <span class="o">=</span> <span class="s">&quot;text&quot;</span>
    <span class="n">INTEGER</span> <span class="o">=</span> <span class="s">&quot;integer&quot;</span>
    <span class="n">BOOLEAN</span> <span class="o">=</span> <span class="s">&quot;boolean&quot;</span>
    <span class="n">FLOAT</span> <span class="o">=</span> <span class="s">&quot;float&quot;</span>
    <span class="n">RICHTEXT</span> <span class="o">=</span> <span class="s">&quot;richtext&quot;</span>
    <span class="n">DATE</span> <span class="o">=</span> <span class="s">&quot;date&quot;</span>
    <span class="n">OPTION</span> <span class="o">=</span> <span class="s">&quot;option&quot;</span>
    <span class="n">ENTITY</span> <span class="o">=</span> <span class="s">&quot;entity&quot;</span>
    <span class="n">FILE</span> <span class="o">=</span> <span class="s">&quot;file&quot;</span>
    <span class="n">IMAGE</span> <span class="o">=</span> <span class="s">&quot;image&quot;</span>
    <span class="n">TYPE_CHOICES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Text&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">INTEGER</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Integer&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">BOOLEAN</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;True / False&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">FLOAT</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Float&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">RICHTEXT</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Rich Text&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">DATE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Date&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">OPTION</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Option&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">ENTITY</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Entity&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;File&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">IMAGE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Image&quot;</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">TYPE_CHOICES</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">TYPE_CHOICES</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Type&quot;</span><span class="p">))</span>

    <span class="n">option_group</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.AttributeOptionGroup&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Option Group&quot;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Select an option group if using type &quot;Option&quot;&#39;</span><span class="p">))</span>
    <span class="n">required</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Required&#39;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;code&#39;</span><span class="p">]</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product attribute&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product attributes&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">OPTION</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FILE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">IMAGE</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">save_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">ProductAttributeValue</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="s">&#39;catalogue&#39;</span><span class="p">,</span> <span class="s">&#39;ProductAttributeValue&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">value_obj</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">attribute_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ProductAttributeValue</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="c"># FileField uses False for announcing deletion of the file</span>
            <span class="c"># not creating a new value</span>
            <span class="n">delete_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_file</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&#39;&#39;</span> <span class="ow">or</span> <span class="n">delete_file</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="n">value_obj</span> <span class="o">=</span> <span class="n">ProductAttributeValue</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
                <span class="n">product</span><span class="o">=</span><span class="n">product</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_file</span><span class="p">:</span>
            <span class="c"># File fields in Django are treated differently, see</span>
            <span class="c"># django.db.models.fields.FileField and method save_form_data</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c"># No change</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="c"># Delete file</span>
                <span class="n">value_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># New uploaded file</span>
                <span class="n">value_obj</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">value_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                <span class="n">value_obj</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">value_obj</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">value_obj</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
                <span class="n">value_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">validate_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">validator</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;_validate_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">validator</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="c"># Validators</span>

    <span class="k">def</span> <span class="nf">_validate_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be str or unicode&quot;</span><span class="p">))</span>
    <span class="n">_validate_richtext</span> <span class="o">=</span> <span class="n">_validate_text</span>

    <span class="k">def</span> <span class="nf">_validate_float</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be a float&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_integer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be an integer&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">date</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be a date or datetime&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_boolean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be a boolean&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be a model instance&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_validate_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">get_model</span><span class="p">(</span><span class="s">&#39;catalogue&#39;</span><span class="p">,</span> <span class="s">&#39;AttributeOption&#39;</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be an AttributeOption model object instance&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;AttributeOption has not been saved yet&quot;</span><span class="p">))</span>
        <span class="n">valid_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option_group</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">values_list</span><span class="p">(</span>
            <span class="s">&#39;option&#39;</span><span class="p">,</span> <span class="n">flat</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">option</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_values</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(enum)s</span><span class="s"> is not a valid choice for </span><span class="si">%(attr)s</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">%</span>
                <span class="p">{</span><span class="s">&#39;enum&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s">&#39;attr&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="p">})</span>

    <span class="k">def</span> <span class="nf">_validate_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">File</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Must be a file field&quot;</span><span class="p">))</span>
    <span class="n">_validate_image</span> <span class="o">=</span> <span class="n">_validate_file</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractProductAttributeValue"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductAttributeValue">[docs]</a><span class="k">class</span> <span class="nc">AbstractProductAttributeValue</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The &quot;through&quot; model for the m2m relationship between catalogue.Product and</span>
<span class="sd">    catalogue.ProductAttribute.  This specifies the value of the attribute for</span>
<span class="sd">    a particular product</span>

<span class="sd">    For example: number_of_pages = 295</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attribute</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.ProductAttribute&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Attribute&quot;</span><span class="p">))</span>
    <span class="n">product</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Product&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;attribute_values&#39;</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Product&quot;</span><span class="p">))</span>

    <span class="n">value_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Text&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_integer</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Integer&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_boolean</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">NullBooleanField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Boolean&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_float</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FloatField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Float&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_richtext</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Richtext&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Date&#39;</span><span class="p">),</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_option</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.AttributeOption&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Value option&quot;</span><span class="p">))</span>
    <span class="n">value_file</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span>
        <span class="n">upload_to</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">OSCAR_IMAGE_FOLDER</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_image</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span>
        <span class="n">upload_to</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">OSCAR_IMAGE_FOLDER</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">value_entity</span> <span class="o">=</span> <span class="n">GenericForeignKey</span><span class="p">(</span>
        <span class="s">&#39;entity_content_type&#39;</span><span class="p">,</span> <span class="s">&#39;entity_object_id&#39;</span><span class="p">)</span>

    <span class="n">entity_content_type</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">ContentType</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">entity_object_id</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span>
        <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">editable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;value_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">is_option</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_value</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="c"># Need to look up instance of AttributeOption</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">option_group</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">option</span><span class="o">=</span><span class="n">new_value</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;value_</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">new_value</span><span class="p">)</span>

    <span class="n">value</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_value</span><span class="p">,</span> <span class="n">_set_value</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;attribute&#39;</span><span class="p">,</span> <span class="s">&#39;product&#39;</span><span class="p">)</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product attribute value&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product attribute values&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

<div class="viewcode-block" id="AbstractProductAttributeValue.summary"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductAttributeValue.summary">[docs]</a>    <span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets a string representation of both the attribute and it&#39;s value,</span>
<span class="sd">        used e.g in product summaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s">u&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_as_text</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractProductAttributeValue.value_as_text"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductAttributeValue.value_as_text">[docs]</a>    <span class="k">def</span> <span class="nf">value_as_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of the attribute&#39;s value. To customise</span>
<span class="sd">        e.g. image attribute values, declare a _image_as_text property and</span>
<span class="sd">        return something appropriate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">property_name</span> <span class="o">=</span> <span class="s">&#39;_</span><span class="si">%s</span><span class="s">_as_text&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">type</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_richtext_as_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">strip_tags</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_entity_as_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the unicode representation of the related model. You likely</span>
<span class="sd">        want to customise this (and maybe _entity_as_html) if you use entities.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">six</span><span class="o">.</span><span class="n">text_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="AbstractProductAttributeValue.value_as_html"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductAttributeValue.value_as_html">[docs]</a>    <span class="k">def</span> <span class="nf">value_as_html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a HTML representation of the attribute&#39;s value. To customise</span>
<span class="sd">        e.g. image attribute values, declare a _image_as_html property and</span>
<span class="sd">        return e.g. an &lt;img&gt; tag.  Defaults to the _as_text representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">property_name</span> <span class="o">=</span> <span class="s">&#39;_</span><span class="si">%s</span><span class="s">_as_html&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">attribute</span><span class="o">.</span><span class="n">type</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_as_text</span><span class="p">)</span>
</div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_richtext_as_html</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mark_safe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractAttributeOptionGroup"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractAttributeOptionGroup">[docs]</a><span class="k">class</span> <span class="nc">AbstractAttributeOptionGroup</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines a group of options that collectively may be used as an</span>
<span class="sd">    attribute type</span>

<span class="sd">    For example, Language</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Name&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Attribute option group&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Attribute option groups&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">option_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span><span class="o">.</span><span class="n">option</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">all</span><span class="p">()]</span>
        <span class="k">return</span> <span class="s">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractAttributeOption"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractAttributeOption">[docs]</a><span class="k">class</span> <span class="nc">AbstractAttributeOption</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides an option within an option group for an attribute type</span>
<span class="sd">    Examples: In a Language group, English, Greek, French</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">group</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.AttributeOptionGroup&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;options&#39;</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Group&quot;</span><span class="p">))</span>
    <span class="n">option</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&#39;Option&#39;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Attribute option&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Attribute options&#39;</span><span class="p">)</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractOption"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractOption">[docs]</a><span class="k">class</span> <span class="nc">AbstractOption</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An option that can be selected for a particular item when the product</span>
<span class="sd">    is added to the basket.</span>

<span class="sd">    For example,  a list ID for an SMS message send, or a personalised message</span>
<span class="sd">    to print on a T-shirt.</span>

<span class="sd">    This is not the same as an &#39;attribute&#39; as options do not have a fixed value</span>
<span class="sd">    for a particular item.  Instead, option need to be specified by a customer</span>
<span class="sd">    when they add the item to their basket.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">AutoSlugField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Code&quot;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                         <span class="n">populate_from</span><span class="o">=</span><span class="s">&#39;name&#39;</span><span class="p">)</span>

    <span class="n">REQUIRED</span><span class="p">,</span> <span class="n">OPTIONAL</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;Required&#39;</span><span class="p">,</span> <span class="s">&#39;Optional&#39;</span><span class="p">)</span>
    <span class="n">TYPE_CHOICES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">REQUIRED</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Required - a value for this option must be specified&quot;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">OPTIONAL</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Optional - a value for this option can be omitted&quot;</span><span class="p">)),</span>
    <span class="p">)</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Status&quot;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">REQUIRED</span><span class="p">,</span>
                            <span class="n">choices</span><span class="o">=</span><span class="n">TYPE_CHOICES</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Option&quot;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Options&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_required</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">REQUIRED</span>

</div>
<div class="viewcode-block" id="MissingProductImage"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.MissingProductImage">[docs]</a><span class="k">class</span> <span class="nc">MissingProductImage</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mimics a Django file field by having a name property.</span>

<span class="sd">    sorl-thumbnail requires all it&#39;s images to be in MEDIA_ROOT. This class</span>
<span class="sd">    tries symlinking the default &quot;missing image&quot; image in STATIC_ROOT</span>
<span class="sd">    into MEDIA_ROOT for convenience, as that is necessary every time an Oscar</span>
<span class="sd">    project is setup. This avoids the less helpful NotFound IOError that would</span>
<span class="sd">    be raised when sorl-thumbnail tries to access it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">settings</span><span class="o">.</span><span class="n">OSCAR_MISSING_IMAGE_URL</span>
        <span class="n">media_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="c"># don&#39;t try to symlink if MEDIA_ROOT is not set (e.g. running tests)</span>
        <span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">media_file_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symlink_missing_image</span><span class="p">(</span><span class="n">media_file_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">symlink_missing_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">media_file_path</span><span class="p">):</span>
        <span class="n">static_file_path</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="s">&#39;oscar/img/</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">static_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">static_file_path</span><span class="p">,</span> <span class="n">media_file_path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ImproperlyConfigured</span><span class="p">((</span>
                    <span class="s">&quot;Please copy/symlink the &quot;</span>
                    <span class="s">&quot;&#39;missing image&#39; image at </span><span class="si">%s</span><span class="s"> into your MEDIA_ROOT at </span><span class="si">%s</span><span class="s">. &quot;</span>
                    <span class="s">&quot;This exception was raised because Oscar was unable to &quot;</span>
                    <span class="s">&quot;symlink it for you.&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">media_file_path</span><span class="p">,</span>
                                              <span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">((</span>
                    <span class="s">&quot;Symlinked the &#39;missing image&#39; image at </span><span class="si">%s</span><span class="s"> into your &quot;</span>
                    <span class="s">&quot;MEDIA_ROOT at </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">media_file_path</span><span class="p">,</span>
                                           <span class="n">settings</span><span class="o">.</span><span class="n">MEDIA_ROOT</span><span class="p">))</span>

</div>
<span class="nd">@python_2_unicode_compatible</span>
<div class="viewcode-block" id="AbstractProductImage"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductImage">[docs]</a><span class="k">class</span> <span class="nc">AbstractProductImage</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An image of a product</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">product</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s">&#39;catalogue.Product&#39;</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s">&#39;images&#39;</span><span class="p">,</span> <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Product&quot;</span><span class="p">))</span>
    <span class="n">original</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ImageField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&quot;Original&quot;</span><span class="p">),</span> <span class="n">upload_to</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">OSCAR_IMAGE_FOLDER</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">caption</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Caption&quot;</span><span class="p">),</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c">#: Use display_order to determine which is the &quot;primary&quot; image</span>
    <span class="n">display_order</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s">&quot;Display order&quot;</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;An image with a display order of zero will be the primary&quot;</span>
                    <span class="s">&quot; image for a product&quot;</span><span class="p">))</span>
    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;Date created&quot;</span><span class="p">),</span> <span class="n">auto_now_add</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">app_label</span> <span class="o">=</span> <span class="s">&#39;catalogue&#39;</span>
        <span class="c"># Any custom models should ensure that this ordering is unchanged, or</span>
        <span class="c"># your query count will explode. See AbstractProduct.primary_image.</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;display_order&quot;</span><span class="p">]</span>
        <span class="n">unique_together</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;product&quot;</span><span class="p">,</span> <span class="s">&quot;display_order&quot;</span><span class="p">)</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product image&#39;</span><span class="p">)</span>
        <span class="n">verbose_name_plural</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;Product images&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">u&quot;Image of &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span>

<div class="viewcode-block" id="AbstractProductImage.is_primary"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductImage.is_primary">[docs]</a>    <span class="k">def</span> <span class="nf">is_primary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return bool if image display order is 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_order</span> <span class="o">==</span> <span class="mi">0</span>
</div>
<div class="viewcode-block" id="AbstractProductImage.delete"><a class="viewcode-back" href="../../../../ref/apps/catalogue.html#oscar.apps.catalogue.abstract_models.AbstractProductImage.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Always keep the display_order as consecutive integers. This avoids</span>
<span class="sd">        issue #855.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">AbstractProductImage</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">image</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">all</span><span class="p">()):</span>
            <span class="n">image</span><span class="o">.</span><span class="n">display_order</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/latest/">latest</a></dd>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/stable/">stable</a></dd>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/releases-1.1/">releases-1.1</a></dd>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/releases-1.0/">releases-1.0</a></dd>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/releases-0.7/">releases-0.7</a></dd>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/releases-0.6/">releases-0.6</a></dd>
        
          <dd><a href="http://django-oscar.readthedocs.org/en/releases-0.5/">releases-0.5</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="http://readthedocs.org/projects/django-oscar/downloads/pdf/latest/">pdf</a></dd>
        
          <dd><a href="http://readthedocs.org/projects/django-oscar/downloads/htmlzip/latest/">htmlzip</a></dd>
        
          <dd><a href="http://readthedocs.org/projects/django-oscar/downloads/epub/latest/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="http://https://readthedocs.org/projects/django-oscar/?fromdocs=django-oscar">Project Home</a>
          </dd>
          <dd>
            <a href="http://https://readthedocs.org/builds/django-oscar/?fromdocs=django-oscar">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/underscore.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/doctools.js"></script>
      <script type="text/javascript" src="https://cdnmedia.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>